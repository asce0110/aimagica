# AI Sketch Platform - 草图驱动的AI绘图平台

> **🚨 重要提示：** 如果您遇到"点击Google登录没有跳转"的问题，请先查看 [`QUICK_SETUP.md`](./QUICK_SETUP.md) 完成Google OAuth配置。

## 🔐 登录系统特性

### Google账号登录
- **纯Google OAuth认证** - 安全、快速、便捷的登录方式
- **多账号选择支持** - 每次登录都显示Google账号选择界面，支持切换不同Google账号
- **自动账号管理** - 无需传统注册流程，Google账号信息自动同步
- **管理员权限** - 支持指定邮箱的管理员权限管理
- **完整英文界面** - 登录页面完全英文化，符合国际化要求

### 登录流程优化
1. 点击"Sign in with Google"按钮
2. 弹出Google账号选择界面，可选择已登录的Google账号或添加新账号
3. 确认授权后自动跳转并完成登录
4. 用户信息自动同步到数据库，支持离线访问
5. 界面语言保持英文，适合欧美用户使用习惯

### 权限管理
- **数据库驱动**: 管理员权限通过 `admin_config` 表动态管理，不再硬编码
- **当前管理员**: `asce3801@gmail.com` （可通过数据库修改）
- **权限检查**: 使用专门的API路由 `/api/admin/check` 检查权限
- **灵活配置**: 可通过数据库增删管理员，无需修改代码
- **Google头像获取**: 已配置profile权限，自动获取Google账号头像
- **数据库同步**: 即使同步失败，也不影响登录和头像显示

### Dashboard数据说明
- **✅ 数据已清除**: 已移除所有模拟数据，Dashboard现在完全基于数据库真实数据
- **✅ 实时更新**: 每30秒自动刷新统计数据，确保信息准确性
- **✅ 权限区分**: 管理员看到全局统计，普通用户看到个人统计
- **✅ 数据填充**: 已通过 `scripts/simple-seed.js` 创建了6个示例用户用于测试

### 管理员权限管理

通过数据库或代码灵活管理管理员权限，详见 [管理员权限设置指南](./ADMIN_SETUP_GUIDE.md)。

## 🗄️ 数据库配置（Supabase）

项目已完全集成 Supabase 数据库系统，提供企业级的数据管理和安全保障。

### 📊 数据库架构

- **6 个核心表**：
  - `users` - 用户基础信息和订阅状态
  - `generated_images` - AI 生成图片记录和元数据
  - `user_subscriptions` - 用户订阅计划和付费记录
  - `image_likes` - 图片点赞和社区互动
  - `user_stats` - 用户使用统计和行为分析
  - `login_logs` - 登录日志和安全审计

- **安全特性**：
  - 完整的行级安全策略（RLS）
  - 用户数据完全隔离
  - 管理员权限分级管理
  - 自动化数据加密

- **性能优化**：
  - 智能索引设计
  - 自动化触发器
  - 实时数据同步
  - 高效查询优化

### 🚀 数据库初始化

#### 1. 执行初始化脚本

在 Supabase 项目的 SQL Editor 中执行：

```sql
-- 执行完整的数据库初始化脚本
-- 文件位置: lib/database/migrations/001_database_init.sql
-- 这个脚本将创建所有表、索引、触发器和安全策略
```

#### 2. 配置环境变量

在项目根目录创建 `.env.local` 文件（参考 `env.template`）：

```bash
# Supabase 配置 (从 https://supabase.com 项目设置获取)
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# NextAuth 配置
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your_nextauth_secret

# Google OAuth 配置 (从 Google Console 获取)
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
```

**获取密钥步骤：**
1. **Supabase**: 登录 [Supabase Dashboard](https://supabase.com) → 项目设置 → API
2. **Google OAuth**: 登录 [Google Console](https://console.cloud.google.com) → APIs & Services → Credentials

#### 3. 验证配置

```bash
# 验证环境变量和数据库连接
node scripts/test-admin-config.js

# 启动项目
pnpm dev
```

启动成功后访问 http://localhost:3000

## 一、项目概述与目标

**背景**
当下 AI 绘图产品层出不穷，诸如 Ghiblio.art 等平台已证明"风格化一键体验"对用户吸引力极强。然而，这些产品多以「照片→风格化」为主，缺乏「用户先画草图→AI补全细节→一站式编辑」的创作链条。结合用户对"自主创作参与感"和"便捷化成品输出"的双重诉求，本项目旨在打造一个"草图驱动、一站式编辑"的 AI 绘图平台，为用户提供从草图绘制、上色、AI 渲染、局部重绘到后期编辑的完整闭环体验。

**项目目标**

1. **差异化定位**：推广"草图输入+AI渲染+一体化编辑"模式，让用户在"参与创作"与"省时省力"之间获得平衡。
2. **用户体验完备**：简化上手门槛，提供详尽的交互提示及实时反馈，减少用户因流程繁琐而流失。
3. **商业可持续性**：通过分级付费、增值服务（局部重绘付费、会员加速包、素材/模板商店等），逐步实现变现和规模化增长。
4. **迭代可控**：分阶段发布 MVP、优化版本和拓展版本，确保在各环节及时抓取用户反馈并快速调整。

---

## 二、目标用户与用户画像

### 1. 核心目标人群

1. **草图/插画初学者**
   * 年龄：18–30 岁
   * 特征：希望通过简易草图获得完整插画成品，缺乏专业美术基础，对工具学习成本敏感。
   * 痛点：不会使用复杂绘画软件，放弃创作动力；对 AI 一键上色或风格化有好奇心，但"需要先学会画草图"存在执行难度。

2. **设计师/插画师（专业或半专业）**
   * 年龄：20–40 岁
   * 特征：有手绘基础，常需快速出草稿；希望借助 AI 提升效率，将草稿快速转为半成品，然后进行二次加工。
   * 痛点：现有 AI 工具对草图理解能力有限、可控度不足；多次重新绘制成本高，且缺少「局部重绘」功能；后期还需跳转到其他编辑软件完成润色。

3. **社交分享类用户**
   * 年龄：16–35 岁
   * 特征：钟情于分享个性化图片，喜欢"简单直接、一键出片"；对"草图 → 成品"过程若能做到 3 步以内，对于社交平台分享有极强意愿。
   * 痛点：一键风格化工具能满足"快出片"？但无法满足"我想画一下草图→就能快速出彩的成品"需求；如果流程过于繁琐，可能选择更简单的平台。

### 2. 用户旅程与核心需求

| 阶段            | 用户行为                                | 核心需求与痛点                                          |
| ------------- | ----------------------------------- | ------------------------------------------------ |
| 1. 发现与了解      | 通过搜索、社交平台或朋友推荐进入产品；浏览首页示例           | "这个平台能让我把我画的草图变成精美插画？""有没有简单易懂的使用指引？"            |
| 2. 草图输入       | 在画板手绘或上传已有线稿、选择风格                   | "我画的草图 AI 能识别吗？""如果线稿不标准会不会失败？"                  |
| 3. 风格选择 & 上色  | 选择想要的渲染风格（卡通、写实、手绘风等）；可选一键上色        | "我想先给黑白线稿上个底色""上色风格能否选择写实/艺术？"                   |
| 4. AI 渲染与进度反馈 | 点击生成，等待系统渲染；查看进度条与趣味提示              | "生成大概多久？""能不能看到当前渲染到哪个阶段？""不要让我无所事事地等"           |
| 5. 预览 & 局部重绘  | 渲染完成后预览全图；若对某一区域不满意，可使用 Mask 工具局部重绘 | "我只想把人物脸的阴影重绘一下，不要整个图都重来""怎样才能快速圈选要重绘的地方？"       |
| 6. 一站式后期编辑    | 可对整图进行滤镜、圆角裁剪、文字添加等操作               | "我想加个文案、调一下滤镜，一气呵成，不想再去 Photoshop"；"如果参数太多会不会卡？" |
| 7. 下载 & 分享    | 保存 PNG/JPG、高分打包下载；一键分享到社交平台         | "我要分享朋友圈""能不能生成社交封面图尺寸？"                         |
| 8. 社区互动 & 收藏  | 浏览他人优秀示例、点赞/收藏，关注创作者；上传自己的成品到社区     | "我想看看别人都怎么用 prompt 或草图做创意""能不能把我的作品放到社区里展示？"     |

---

## 三、产品功能需求

### 1. 核心功能概览

1. **草图输入与识别**
   * 支持「画板手绘」与「上传本地线稿」两种模式。
   * 提供"示例草图"和"失败示例"对比提示，引导用户绘制可被 AI 识别的线稿。
   * 基于线稿风格检测模型，对草图进行预处理（自动裁剪、线条提纯、去噪）并给出"线稿质量反馈"。
   * 支持多种线稿输入风格（铅笔、水墨、马克笔、数位板等），并通过数据增强提高模型鲁棒性。

2. **一键上色**
   * 在黑白线稿基础上，一键生成两种初级上色风格：
     1. 写实风格：尽量贴近真实色彩；
     2. 艺术风格：高饱和或特殊配色方案。
   * 提供实时调色工具（色相、饱和度、明度滑块），用户可在预览过程中微调。
   * 支持"区域智能选取"：用户点击某一区域即可快速选中，AI 填充大致色块。

3. **AI 渲染核心**
   * 基于现有 Image2Image / Sketch2Image 模型（例如 pix2pix、Stable Diffusion-Latent2Latent），定制训练"草图+Prompt→成品"流水线。
   * 后端将渲染流程拆分为若干阶段（骨架提取→风格迁移→细节优化→后处理），前端进度条实时同步各阶段状态。
   * 可选多种渲染风格库（卡通、手绘、动漫、写实、水彩、油画等），用户可在渲染前自由选择。

4. **趣味进度反馈**
   * 设计一个分阶段动态进度条：
     1. "识别线稿骨架（0–25%）"
     2. "渲染填色（25–60%）"
     3. "风格融合（60–85%）"
     4. "后期处理（85–100%）"
   * 每个阶段下方显示**趣味小贴士**或**简短文案**，例如："正在让你的涂鸦变得栩栩如生""别眨眼，艺术家正在加最后一笔"。
   * 对于对 AI 技术有兴趣的用户，可额外勾选"模型详情"模式，显示当前使用的模型版本、调用次数等信息。

5. **社区示例与推荐**
   * 渲染页面下方嵌入"社区热榜"模块，自动展示与当前用户草图/风格相似的 Top 3–5 条示例：
     * 每条示例包含**缩略预览图**、**Prompt/风格标签**、**点赞数**、**生成次数**等信息。
     * 支持切换"按风格""按主题""按热门程度"三种筛选维度。
   * 用户可直接点击"复制 Prompt"或"保存到草稿箱"进行二次编辑。
   * 渲染完成后，弹出"分享至社区"提示，鼓励用户将成品上传并附上简要文字介绍。

6. **局部重绘（Mask 编辑）**
   * 在生成结果页面提供"局部重绘"按钮，进入重绘模式：
     * 用户可在画布上用"红色遮罩笔"标记希望重绘的区域；
     * 系统实时生成该区域的 Mask 图层，并在后端仅针对 Mask 区域执行单帧重渲染。
   * 局部重绘功能需满足：
     1. **精度控制**：限制最大 Mask 区域大小（例如 256×256 px），超出需自动拆分；
     2. **多次重绘叠加**：允许用户多次重绘不同区域，每次提交都会生成新的版本，并保留历史记录；
     3. **渲染速度与排队机制**：当同时有多位用户使用时，通过"预估剩余时间（秒级）"+"用户排队提示"降低并发压力，并给高级会员优先级。

7. **一站式后期编辑**
   * 在渲染完成后，内置编辑面板支持：
     1. **滤镜套装**：三大预设包
        * 社交活力包（高饱和、强对比、小颗粒）
        * 温暖文艺包（低饱和、中对比、褐调）
        * 怀旧电影包（胶片颗粒、暗角、暖黄色调）
     2. **调色工具**：色相、饱和度、亮度滑块，鼠标实时预览；
     3. **圆角裁剪**：可输入圆角半径，实时在预览窗查看结果；
     4. **文字/贴纸添加**：
        * 文字支持多种中文/英文字体；可调字体大小、字距、线高；
        * 文字样式支持"阴影""描边""浮雕"三种常见 Neumorphism 风格效果；
        * 贴纸库内置若干常用图形（表情、装饰线条、几何图形），支持拖拽放置；
     5. **撤销/重做与历史记录**：所有操作均记录在"编辑历史"面板，可随时回退。
   * 编辑后端实施方案：
     * 前端利用 Canvas 2D 或 WebGL 实现实时预览；
     * 用户确认导出时，将最终合成命令发至后端高清渲染，保证输出 2K+ 分辨率时质量。

8. **下载与分享**
   * 支持**一键下载**：PNG/JPG（含/不含烘焙水印）两种基础选项；
   * 高分辨率下载需付费购买：可选择 2K、4K、8K 三档输出。
   * **社交分享**：提供一键分享到微博、微信朋友圈、QQ 空间、豆瓣等常见社交平台的跳转链接，并自动生成**最佳尺寸封面**供预览。
   * **作品收藏与导出记录**：用户可在"个人中心→作品集"中查看所有生成/编辑/下载记录，并支持"一键重新编辑"。

9. **用户体系与权限管理**
   * **访客/免费用户**：
     * 每日免费渲染次数：3 次；每日免费局部重绘次数：3 次；
     * 下载标清水印版；社区互动仅能点赞/收藏。
   * **会员（VIP）用户**：
     * 月度/年度订阅制，订阅会员可享：
       1. 免费渲染次数：每日 20 次；
       2. 免费局部重绘次数：每日 10 次；
       3. 下载免水印高分辨率一次（限定尺寸）；
       4. 优先排队加速权（重绘/渲染速度获 2× 加速）；
       5. 额外赠送"渲染币"（用于额外下载或局部重绘）。
   * **付费单次渲染/下载**：非会员用户可购买"渲染币"包（50 币、200 币、500 币等），每次渲染/重绘/高分辨率下载消耗固定币值。

10. **管理后台 & 数据统计**
    * **内容管理**：社区示例的审核、举报处理、推荐位管理。
    * **用户管理**：用户列表、会员状态、消费记录、封禁/解封操作。
    * **数据监控**：
      1. 草图上传成功率、线稿识别失败率、渲染失败率；
      2. 日活 DAU/周活 WAU/月活 MAU；
      3. 免费 vs 付费用户渲染次数对比；
      4. 付费转化漏斗：进入下载页→点击购买→支付完成；
      5. 重绘功能使用率、编辑功能使用率；
      6. 社区互动：作品上传量、点赞量、评论量。
    * **运营活动模块**：可发布"每日任务""渲染挑战赛""主题创作大赛"等活动，带动用户留存。

---

## 四、非功能需求

1. **性能与可用性**
   * **响应时延**：
     * 草图上传后 2 秒内给出"线稿质量反馈"；
     * 渲染平均时长控制在 12–15 秒以内，重绘平均时长 8–10 秒；
     * 编辑操作实时预览响应 < 200ms；
     * 页面首屏加载时间 < 2 秒。
   * **高并发支持**：
     * 前端使用 CDN 加速静态资源；后端接入弹性伸缩容器（Kubernetes + GPU 节点）确保高峰期可自动扩容；
     * 渲染调用采用消息队列（RabbitMQ/Kafka），前端通过 WebSocket 接收渲染进度更新；重绘和渲染请求做分级限流与优先级队列。

2. **跨平台兼容性**
   * **Web 端**：兼容现代主流浏览器（Chrome、Firefox、Safari、Edge）最新两版；
   * **移动适配**：PC/Mobile 双端响应式布局，移动端涂鸦板块支持触摸手势（双指缩放、单指绘制、双指撤销/恢复）；
   * **未来原生 App**：预留 API 接口及鉴权方案，与后续 iOS/Android 原生项目兼容。

3. **安全与隐私**
   * **用户隐私保护**：
     * 上传图像仅用于本次渲染，默认保留 30 天，用户可随时手动删除；
     * 不用于训练模型，除非用户同意将作品匿名贡献用于模型改进；
     * 严格执行 HTTPS 全链路加密；所有图像传输与存储需加密保存。
   * **访问控制**：
     * API 鉴权采用 Token + 签名，防止恶意刷接口；
     * 管理后台设置多级权限（普通管理员、超级管理员、运营人员各自可见/可操作模块不同）。
   * **防滥用与监控**：
     * 对上传图像做内容审查，禁止暴力、色情、侵权等违规内容；
     * 渲染频次做风控：若短时间内多次失败或大量提交，需人工审核或限制访问；
     * 运营后台实时监控异常流量与用户行为，结合日志系统（ELK）进行告警。

4. **可维护性与扩展性**
   * **微服务架构**：将"用户服务""渲染服务""编辑服务""社区服务""支付服务"解耦，独立部署、水平扩展；
   * **模块化前端**：采用 React 或 Vue 组件化开发，公共组件库（画板、进度条、Mask 编辑器）可复用，并支持动态按需加载（Code Splitting）；
   * **模型可替换**：渲染服务对接多个 AI 模型（如自研 Sketch2Image、第三方 API），后端使用统一接口层，便于后续更换/升级模型。
   * **流水线 CI/CD**：使用 GitLab CI 或 GitHub Actions 完成自动化构建、测试、部署；模型更新需走"验证→灰度→全量"流程。

---

## 五、技术架构与实现

### 🗄️ 数据库集成 - Supabase

项目已完全集成 Supabase 数据库，提供：

- **用户管理系统** - 完整的用户注册、登录、权限管理
- **图片生成记录** - 追踪所有 AI 图片生成过程和结果
- **订阅管理** - 支持多层级订阅计划和使用限制
- **社区功能** - 图片分享、点赞、评论系统
- **实时统计** - 管理后台数据分析和监控
- **安全保障** - 行级安全策略和数据加密

#### 快速开始

1. **设置 Supabase 项目**
   ```bash
   # 访问 https://supabase.com 创建新项目
   # 获取项目 URL 和 API 密钥
   ```

2. **配置环境变量**
   ```bash
   # 在 .env.local 中添加
   NEXT_PUBLIC_SUPABASE_URL=your_project_url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
   ```

3. **初始化数据库**
   ```bash
   # 在 Supabase SQL Editor 中执行
   # lib/database/migrations/001_initial_schema.sql
   ```

4. **启动项目**
   ```bash
   pnpm dev
   ```

详细设置指南：
- 👑 [管理员权限设置指南](./ADMIN_SETUP_GUIDE.md)

### 1. 系统架构总体设计

```
┌───────────────────────────────────────────────────────────────────────────────┐
│                                前端（Web）                                     │
│                                                                               │
│  ┌──────────────┐    ┌──────────┐    ┌──────────┐    ┌──────────────┐         │
│  │  草图画板页    │    │ 渲染进度页 │    │ 重绘编辑页 │    │ 后期编辑页    │         │
│  └──────────────┘    └──────────┘    └──────────┘    └──────────────┘         │
│       │                   │                  │                   │             │
│       │                   │                  │                   │             │
│  WebSocket             WebSocket/HTTP       WebSocket/HTTP      WebSocket/HTTP │
│       │                   │                  │                   │             │
└───────┼───────────────────┼──────────────────┼───────────────────┼─────────────┘
        │                   │                  │                   │
        ▼                   ▼                  ▼                   ▼
┌───────────────────────────────────────────────────────────────────────────────┐
│                                后端微服务                                      │
│                                                                               │
│  ┌──────────┐  ┌──────────────┐  ┌───────────────┐  ┌──────────────┐          │
│  │ 用户服务  │  │ 渲染服务（GPU）│  │ 编辑服务（WebGL）│  │ 社区服务      │          │
│  │  (Auth,   │  │  + 模型加载   │  │ + Canvas 合成  │  │ (示例库、评论) │          │
│  │ Profile) │  └──────────────┘  └───────────────┘  └──────────────┘          │
│  └──────────┘       │                  │                   │                │
│        │            │                  │                   │                │
│        │            │                  │                   │                │
│        │            ▼                  ▼                   ▼                │
│  ┌───────────────────────────────────────────────────────────────────────┐   │
│  │                              模型与存储层                               │   │
│  │                                                                       │   │
│  │  ┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────────┐        │   │
│  │  │ 草图预处理 │   │ Sketch2Image │   │ Mask 服务  │   │ 对象存储       │        │   │
│  │  │ 模型     │   │ 渲染模型    │   │ (局部重绘)  │   │ (OSS/S3)     │        │   │
│  │  └──────────┘   └──────────┘   └──────────┘   └──────────────┘        │   │
│  └───────────────────────────────────────────────────────────────────────┘   │
│                                                                               │
│  ┌───────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ 日志 & 监控    │  │ 数据库 (MySQL) │  │ 缓存 (Redis) │  │ 消息队列      │       │
│  │ (ELK/Prom)   │  └──────────────┘  └──────────────┘  └──────────────┘       │
│  └───────────────┘                                                           │
└───────────────────────────────────────────────────────────────────────────────┘
```

### 2. 技术选型

| 模块       | 技术/工具                                                        | 说明                                                |
| -------- | ------------------------------------------------------------ | ------------------------------------------------- |
| 前端框架     | React 或 Vue                                                  | 组件化开发，利用 TailwindCSS 进行样式统一。                      |
| 画板与 Mask | HTML5 Canvas + Fabric.js / Konva.js                          | 实现手绘涂鸦和遮罩标注；Fabric/Konva 可简化 Canvas 操作。           |
| 后端语言     | Node.js + NestJS 或 Python + FastAPI                          | Node/NestJS 便于前端统一栈，Python-FastAPI 在 AI 服务调用上更灵活。 |
| 渲染推理     | PyTorch / TensorFlow                                         | 训练与部署 Sketch2Image、Stable Diffusion 等模型。          |
| GPU 调度   | Kubernetes + NVIDIA GPU Operator                             | 扩容灵活；支持多副本部署与自动弹性伸缩。                              |
| 模型服务     | Triton Inference Server / TorchServe                         | 专业的推理服务，可接入多种模型，自动批量推理与动态拆分。                      |
| 数据库      | MySQL / PostgreSQL                                           | 存储用户信息、作品记录、社区数据等关系型信息。                           |
| 缓存       | Redis                                                        | 缓存用户会话、渲染状态、社区热门 Prompt 等高频读取数据。                  |
| 消息队列     | RabbitMQ / Kafka                                             | 渲染、重绘请求异步分发与状态通知，保证用户体验流畅。                        |
| 对象存储     | AWS S3 / 阿里 OSS                                              | 存储草图、渲染中间结果、最终生成文件。                               |
| 日志与监控    | ELK (Elasticsearch, Logstash, Kibana) + Prometheus + Grafana | 日志聚合与指标监控，实时告警、分析报表。                              |
| CI/CD    | GitHub Actions / GitLab CI                                   | 自动化构建、测试、部署，保证线上服务稳定。                             |

---

## 六、产品迭代计划与里程碑

| 阶段  | 时间预估    | 主要内容与目标                                                                                                                                                                                                                                                                                    |
| --- | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MVP | 1–2 个月  | • **草图输入与识别**：实现画板手绘/线稿上传、线稿质量检测提示<br>• **基础渲染**：部署 Sketch2Image 模型，提供一键黑白线稿→成品生成功能（含两种预设风格）。<br>• **进度条 & 社区示例**：实现分阶段进度条+底部手动维护示例内容。<br>• **下载与社交分享**：支持标清下载与一键分享到微博/微信。<br>• **基础用户体系**：访客/免费用户。                                                                                        |
| 优化版 | 3–4 个月  | • **自动上色**：在线稿基础上实现一键上色+基础调色滑块（色相/饱和/明度）。<br>• **Mask 局部重绘**：实现遮罩标注→局部渲染→预览对比，并优化渲染队列机制与会员加速策略。<br>• **一站式后期编辑**：集成滤镜预设、圆角裁剪、基础文字/贴纸添加、撤销/重做功能。<br>• **会员体系完善**：上线月卡/年卡，渲染币包购买，设定会员特权与免费重绘额度。<br>• **数据埋点与监控**：上线首页→渲染→重绘→下载→分享全链路埋点，Dashboards 初步搭建。                                      |
| 拓展版 | 5–8 个月  | • **移动端适配/小程序**：基本移动端涂鸦+一键渲染→分享功能；可做微信小程序版本，降低用户使用门槛。<br>• **高级编辑功能**：增加贴纸库扩充、自定义字体包、更多滤镜（预览缩略图模式）；前端统一切换到 WebGL 提升渲染效率。<br>• **混合输入**：支持"文字 + 草图"输入模式，利用 CLIP/LDM 结合草图和文字提示进行多模态渲染。<br>• **社区深度互动**：上线"作品排行""每日榜单""关注/粉丝/私信"功能；运营团队定期跑"主题挑战赛""草图赛"。<br>• **模板商店**：支持创作者上传并售卖"草图→成品"预设流程包。 |
| 生态化 | 9–12 个月 | • **开放 API**：为第三方网站/App 提供"Sketch2Image"接口。<br>• **原生 App（iOS/Android）**：上架 App Store/各大应用商店，结合本地画板与在线渲染；支持离线画图 + 在线渲染合并体验。<br>• **商业化与变现**：与教育机构、设计工作室合作，推出"企业定制风格包"；举办"AI 绘画线上大赛"，吸引品牌赞助。                                                                                                |

---

## 七、关键指标（KPI）与数据监控

1. **用户活跃度**
   * DAU/WAU/MAU：每日/周/月活跃用户数。
   * 草图上传量：每日上传草图次数。
   * 渲染量：每日渲染请求次数（区分免费 vs 付费）。
   * 重绘使用率：日活中使用过局部重绘功能的比例。
   * 编辑使用率：日活中使用过后期编辑功能的比例。

2. **用户留存与转化**
   * 新用户 1/7/30 天留存率。
   * 免费用户→付费用户的转化率：
     1. 进入下载页→点击购买→支付完成各环节转化漏斗；
     2. 免费用户在 7 天内付费率。
   * 付费用户平均"渲染次数/重绘次数"对比免费用户。

3. **渲染与技术指标**
   * 草图识别成功率：线稿上传后，被判定为"可渲染"的比例。低于 90% 时需紧急优化。
   * 渲染失败率：调用模型失败或上传资源丢失导致失败的比例。
   * 平均渲染时长（秒级）：目标 < 15s；重绘平均时长 < 10s。
   * 前端编辑响应时延：< 200ms。

4. **社区与社交指标**
   * 作品上传量：每日新增社区作品数。
   * 点赞/收藏/评论量：衡量互动活跃度。
   * 社交分享转化：通过社交分享点击进入平台的访客数。

5. **商业与营收**
   * 渲染币包销售额、会员订阅收入占比。
   * 高分辨率下载付费率：支付下载高分输出人数 / 总下载人数。
   * 平均客单价（ARPU）：分免费与付费用户分别计算。

---

## 八、商业模式与定价策略

1. **免费+会员制+增值服务**
   * **免费用户**：每日可享 3 次基础渲染、3 次局部重绘、标清水印下载；
   * **会员（VIP）**：分月度/年度订阅
     * 月卡：￥30/月，可享每日 20 次渲染、10 次重绘、2 次免费高分下载、优先排队；
     * 年卡：￥300/年（约￥25/月折扣价），享与月卡相同权益；
     * 会员额外获赠渲染币（如月卡赠送 100 币、年卡赠送 500 币）；
   * **渲染币**：非会员或超额使用时购买
     * 50 币 ￥10、200 币 ￥35、500 币 ￥80；
     * 每次高分下载扣除 20 币；每次局部重绘扣除 5 币；每次超额渲染扣除 3 币。
   * **模板商店**：创作者可上架"草图→成品"预设包，售价自定（最低￥5/套），平台抽取 30% 分成。

2. **增值服务与合作**
   * **定制风格包**：面向企业用户（游戏/影视/广告公司）提供专属风格包定制，按项目报价。
   * **教育培训**：与美术培训机构合作，支持"线下课堂→线上 AI 辅助"模式，按用户数定向授权。
   * **API 出口**：向开发者开放 Sketch2Image 接口，按调用次数计费（首 500 次免费、500-5000 次 0.01 USD/次，5000 次以上 0.008 USD/次）。

---

## 九、风险评估与应对措施

1. **草图识别失效率高**
   * 风险：用户上传各式各样的线稿（铅笔、随手涂鸦、手机拍摄模糊线稿等），导致模型识别失败。
   * 应对：
     1. 加强数据标注与增强，收集多种线稿样本，定期训练新模型；
     2. 前端提前给出"质量反馈"，避免用户盲目提交；
     3. 提供"模板画板"，在用户自绘基础上进行简单示范。

2. **服务器算力成本过高**
   * 风险：大量免费用户或恶意刷渲染、重绘，导致 GPU 成本激增。
   * 应对：
     1. 严格限定免费使用次数，引入实名认证/人机验证减少刷量；
     2. 动态调控队列策略，空闲时段做"免费渲染"，高峰时段优先会员付费；
     3. 持续优化模型推理效率（模型蒸馏、量化、流水线并行），降低单次渲染时长。

3. **编辑功能在低端设备上卡顿**
   * 风险：用户若在低配手机浏览器上使用 WebGL 版实时预览，会出现卡顿或崩溃。
   * 应对：
     1. 自动检测客户端性能，若低于阈值则降级到"小图预览+过渡帧展示"模式；
     2. 针对移动端画板，提供"基础画笔 + 自动补全"功能，降低渲染需求；
     3. 分离编辑与导出逻辑：前端仅做低分辨率预览，必须导出时再上传到后端渲染高清。

4. **社区内容质量参差不齐**
   * 风险：低质量作品与商业广告充斥社区，影响新用户信任与留存。
   * 应对：
     1. 设置社区作品审核机制：机器审核 + 人工审核双重保障；
     2. 差评反馈系统：用户可举报"侵权/低质量"等作品，并设定最低"点赞数"才能出现在热门推荐；
     3. 定期举办"主题创作挑战"，精选优秀作品置顶，规范社区氛围。

---

## 快速开始

### 环境要求

- Node.js 18.0 或更高版本
- pnpm 包管理器
- 现代浏览器（Chrome、Firefox、Safari、Edge）

### 安装依赖

```bash
pnpm install
```

### 开发模式

```bash
pnpm dev
```

项目将在 `http://localhost:3000` 启动。

### 构建生产版本

```bash
pnpm build
```

### 启动生产服务器

```bash
pnpm start
```

---

## 项目结构

```
ai-sketch-platform/
├── app/                    # Next.js App Router 页面
├── components/             # 可复用组件
├── hooks/                  # 自定义 React Hooks
├── lib/                    # 工具函数和配置
├── public/                 # 静态资源
├── styles/                 # 样式文件
├── components.json         # shadcn/ui 组件配置
├── next.config.mjs         # Next.js 配置
├── package.json           # 项目依赖
├── tailwind.config.ts     # Tailwind CSS 配置
└── tsconfig.json          # TypeScript 配置
```

---

## 技术栈

- **框架**: Next.js 15.2.4
- **语言**: TypeScript
- **样式**: Tailwind CSS
- **UI 组件**: Radix UI
- **状态管理**: React Hooks
- **包管理器**: pnpm
- **部署**: Vercel (推荐)

---

## 贡献指南

1. Fork 本仓库
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

---

## 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

---

## 联系我们

- 项目主页: [https://github.com/yourusername/ai-sketch-platform](https://github.com/yourusername/ai-sketch-platform)
- 问题反馈: [https://github.com/yourusername/ai-sketch-platform/issues](https://github.com/yourusername/ai-sketch-platform/issues)

---

**注意**: 本项目目前处于开发阶段，部分功能可能尚未完全实现。我们正在积极开发中，敬请期待！ 