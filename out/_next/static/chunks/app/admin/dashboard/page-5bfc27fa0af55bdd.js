(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{68628:function(e,a,s){Promise.resolve().then(s.bind(s,83581))},83581:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ep}});var t=s(18376),l=s(57894),r=s(65354),i=s(95801),n=s(92392),o=s(46859),d=s(24698),c=s(27346),m=s(34200),x=s(13249),u=s(55859),h=s(287),f=s(39371),p=s(41595),g=s(37316),b=s(64238),y=s(71883),j=s(43782),v=s(25418),N=s(96823),w=s(66660),k=s(618),_=s(46047),F=s(27847),D=s(52609),A=s(50909),C=s(77456),O=s(84349),S=s(19892),B=s(4738),I=s(95908),P=s(36288),E=s(84207),z=s(42857),Z=s(37929),U=s(96433),R=s(16270),T=s(95520),L=s(79170),M=s(38049),J=s(98468),q=s(74010),V=s(12513),Y=s(11948),G=s(9978),Q=s(22469),K=s(54685),W=s(65538),H=s(16860),$=s(31554),X=s(41775),ee=s(82878),ea=s(44911),es=s(53922),et=s(79914),el=s(6479),er=s(87824);function ei(e){let{config:a,onSave:s,onCancel:n,isLoading:o}=e,d=a?"api-config-edit-".concat(a.id):"api-config-new",c=(0,l.useRef)(!1),[m,x]=(0,l.useState)(()=>{{let e=localStorage.getItem(d);if(e)try{let a=JSON.parse(e);return console.log("\uD83D\uDCE5 恢复已保存的编辑数据:",a.timestamp),c.current=!0,a.formData}catch(e){console.warn("❌ 无法解析保存的数据，使用默认值")}}return{name:(null==a?void 0:a.name)||"",type:(null==a?void 0:a.type)||"image_generation",provider:(null==a?void 0:a.provider)||"",base_url:(null==a?void 0:a.base_url)||"",api_key:(null==a?void 0:a.api_key)||"",model:(null==a?void 0:a.model)||"",endpoint:(null==a?void 0:a.endpoint)||"",priority:(null==a?void 0:a.priority)||0,is_default:(null==a?void 0:a.is_default)||!1,is_active:(null==a?void 0:a.is_active)!==!1,max_retries:(null==a?void 0:a.max_retries)||3,timeout_seconds:(null==a?void 0:a.timeout_seconds)||60,rate_limit_per_minute:(null==a?void 0:a.rate_limit_per_minute)||60,config_data:(null==a?void 0:a.config_data)||{}}}),[u,h]=(0,l.useState)(!1),[f,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(null),[y,j]=(0,l.useState)(()=>{{let e=localStorage.getItem(d);if(e)try{return JSON.parse(e).configDataText||JSON.stringify((null==a?void 0:a.config_data)||{},null,2)}catch(e){console.warn("❌ 无法解析保存的配置数据文本")}}return JSON.stringify((null==a?void 0:a.config_data)||{},null,2)}),v=()=>{try{{let e={formData:m,configDataText:y,timestamp:new Date().toISOString()};localStorage.setItem(d,JSON.stringify(e)),c.current=!0,p(!0),console.log("\uD83D\uDCBE 自动保存编辑数据")}}catch(e){console.error("自动保存失败:",e)}},N=()=>{try{localStorage.removeItem(d),c.current=!1,p(!1),console.log("\uD83D\uDDD1️ 清除保存的编辑数据")}catch(e){console.error("清除保存数据失败:",e)}};(0,l.useEffect)(()=>{let e=setTimeout(()=>{try{v()}catch(e){console.error("定时自动保存失败:",e)}},1e3);return()=>clearTimeout(e)},[m,y]),(0,l.useEffect)(()=>{let e=e=>{if(c.current)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?","You have unsaved changes. Are you sure you want to leave?"},a=()=>{try{"hidden"===document.visibilityState&&c.current&&(v(),console.log("\uD83D\uDCE4 页面隐藏时自动保存"))}catch(e){console.error("页面隐藏时自动保存失败:",e)}};return window.addEventListener("beforeunload",e),document.addEventListener("visibilitychange",a),()=>{window.removeEventListener("beforeunload",e),document.removeEventListener("visibilitychange",a)}},[]),(0,l.useEffect)(()=>{c.current&&(p(!0),console.log("✨ 检测到未保存的编辑数据已自动恢复")),F(y)},[]);let w=async e=>{e.preventDefault();try{let e={};if(y.trim())try{e=JSON.parse(y)}catch(a){console.error("JSON解析错误:",a),console.error("待解析的文本:",y);let e=a instanceof Error?a.message:"Unknown JSON error";alert("❌ JSON格式错误!\n\n错误详情: ".concat(e,"\n\n请检查配置数据的JSON格式是否正确。\n\n提示:\n- 确保所有引号都是英文引号\n- 确保没有多余的逗号\n- 确保大括号和方括号配对正确"));return}await s({...m,config_data:e}),N()}catch(e){console.error("保存配置错误:",e),alert("❌ 保存失败!\n\n错误详情: ".concat(e instanceof Error?e.message:"Unknown error"))}},k=()=>{if(c.current){if(!confirm("You have unsaved changes. Are you sure you want to discard them?"))return;N()}n()},_={OpenAI:{base_url:"https://api.openai.com/v1",endpoint:"/images/generations",model:"dall-e-3",config_data:{quality:"standard",size:"1024x1024",style:"vivid"}},"Stability AI":{base_url:"https://api.stability.ai/v1",endpoint:"/generation/stable-diffusion-xl-1024-v1-0/text-to-image",model:"stable-diffusion-xl-1024-v1-0",config_data:{samples:1,steps:30,cfg_scale:7}},Replicate:{base_url:"https://api.replicate.com/v1",endpoint:"/predictions",model:"stability-ai/sdxl",config_data:{width:1024,height:1024,num_outputs:1}},Runway:{base_url:"https://api.runwayml.com/v1",endpoint:"/generate",model:"gen2",config_data:{duration:4,seed:0,upscale:!1}},"Kie.ai Pro":{base_url:"https://api.kie.ai",endpoint:"/api/v1/flux/kontext/generate",model:"flux-kontext-pro",config_data:{aspectRatios:{"21:9":"21:9","16:9":"16:9","4:3":"4:3","1:1":"1:1","3:4":"3:4","9:16":"9:16","16:21":"16:21"},supportedModes:["text_to_image","image_edit"],promptLanguage:"en",description:"Standard Flux Kontext model for most use cases"}},"Kie.ai Max":{base_url:"https://api.kie.ai",endpoint:"/api/v1/flux/kontext/generate",model:"flux-kontext-max",config_data:{aspectRatios:{"21:9":"21:9","16:9":"16:9","4:3":"4:3","1:1":"1:1","3:4":"3:4","9:16":"9:16","16:21":"16:21"},supportedModes:["text_to_image","image_edit"],promptLanguage:"en",description:"Enhanced Flux Kontext model for complex scenarios"}}},F=e=>{if(!e.trim())return b(null),!0;try{return JSON.parse(e),b(null),!0}catch(e){return b(e instanceof Error?e.message:"Invalid JSON"),!1}},D=e=>{j(e),F(e)};return(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Z.Z,{className:"w-6 h-6 mr-2"}),a?"Edit API Configuration \uD83D\uDD27":"Add New API Configuration ⚡"]}),(0,t.jsx)(i.SZ,{className:"text-[#8b7355] font-bold",children:"Configure AI generation APIs with automatic failover support"})]}),(0,t.jsx)(r.z,{onClick:k,variant:"ghost",className:"text-[#8b7355] hover:text-[#2d3e2d]",children:(0,t.jsx)(et.Z,{className:"w-4 h-4"})})]})}),(0,t.jsx)(i.aY,{children:(0,t.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"name",className:"text-[#2d3e2d] font-bold",children:"Configuration Name *"}),(0,t.jsx)($.I,{id:"name",value:m.name,onChange:e=>x(a=>({...a,name:e.target.value})),placeholder:"e.g., OpenAI DALL-E 3 Primary Config",required:!0,className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"type",className:"text-[#2d3e2d] font-bold",children:"API Type *"}),(0,t.jsxs)(ee.Ph,{value:m.type,onValueChange:e=>x(a=>({...a,type:e})),children:[(0,t.jsx)(ee.i4,{className:"border-2 border-[#8b7355] rounded-xl",children:(0,t.jsx)(ee.ki,{})}),(0,t.jsxs)(ee.Bw,{children:[(0,t.jsx)(ee.Ql,{value:"image_generation",children:"Image Generation \uD83C\uDFA8"}),(0,t.jsx)(ee.Ql,{value:"video_generation",children:"Video Generation \uD83C\uDFAC"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"provider",className:"text-[#2d3e2d] font-bold",children:"Provider *"}),(0,t.jsxs)(ee.Ph,{value:m.provider,onValueChange:e=>{x(a=>({...a,provider:e}));let a=_[e];if(a){x(e=>({...e,base_url:a.base_url,endpoint:a.endpoint,model:a.model}));let e=JSON.stringify(a.config_data,null,2);j(e),F(e)}},children:[(0,t.jsx)(ee.i4,{className:"border-2 border-[#8b7355] rounded-xl",children:(0,t.jsx)(ee.ki,{placeholder:"Select a provider"})}),(0,t.jsxs)(ee.Bw,{children:[(0,t.jsx)(ee.Ql,{value:"OpenAI",children:"OpenAI"}),(0,t.jsx)(ee.Ql,{value:"Stability AI",children:"Stability AI"}),(0,t.jsx)(ee.Ql,{value:"Replicate",children:"Replicate"}),(0,t.jsx)(ee.Ql,{value:"Runway",children:"Runway"}),(0,t.jsx)(ee.Ql,{value:"Kie.ai Pro",children:"Kie.ai Flux Kontext Pro"}),(0,t.jsx)(ee.Ql,{value:"Kie.ai Max",children:"Kie.ai Flux Kontext Max"}),(0,t.jsx)(ee.Ql,{value:"Pika",children:"Pika Labs"}),(0,t.jsx)(ee.Ql,{value:"Custom",children:"Custom Provider"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"priority",className:"text-[#2d3e2d] font-bold",children:"Priority (Lower = Higher Priority)"}),(0,t.jsx)($.I,{id:"priority",type:"number",value:m.priority,onChange:e=>x(a=>({...a,priority:parseInt(e.target.value)||0})),min:"0",className:"border-2 border-[#8b7355] rounded-xl"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"base_url",className:"text-[#2d3e2d] font-bold",children:"Base URL *"}),(0,t.jsx)($.I,{id:"base_url",value:m.base_url,onChange:e=>x(a=>({...a,base_url:e.target.value})),placeholder:"https://api.openai.com/v1",required:!0,className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"endpoint",className:"text-[#2d3e2d] font-bold",children:"Endpoint Path"}),(0,t.jsx)($.I,{id:"endpoint",value:m.endpoint,onChange:e=>x(a=>({...a,endpoint:e.target.value})),placeholder:"/images/generations",className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"api_key",className:"text-[#2d3e2d] font-bold",children:"API Key *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)($.I,{id:"api_key",type:u?"text":"password",value:m.api_key,onChange:e=>x(a=>({...a,api_key:e.target.value})),placeholder:"Enter your API key here",required:!0,className:"border-2 border-[#8b7355] rounded-xl pr-10"}),(0,t.jsx)(r.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2",onClick:()=>h(!u),children:u?(0,t.jsx)(el.Z,{className:"w-4 h-4"}):(0,t.jsx)(U.Z,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"model",className:"text-[#2d3e2d] font-bold",children:"Model Name"}),(0,t.jsx)($.I,{id:"model",value:m.model,onChange:e=>x(a=>({...a,model:e.target.value})),placeholder:"dall-e-3",className:"border-2 border-[#8b7355] rounded-xl"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"max_retries",className:"text-[#2d3e2d] font-bold",children:"Max Retries"}),(0,t.jsx)($.I,{id:"max_retries",type:"number",value:m.max_retries,onChange:e=>x(a=>({...a,max_retries:parseInt(e.target.value)||3})),min:"0",max:"10",className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"timeout_seconds",className:"text-[#2d3e2d] font-bold",children:"Timeout (seconds)"}),(0,t.jsx)($.I,{id:"timeout_seconds",type:"number",value:m.timeout_seconds,onChange:e=>x(a=>({...a,timeout_seconds:parseInt(e.target.value)||60})),min:"10",max:"300",className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(X._,{htmlFor:"rate_limit",className:"text-[#2d3e2d] font-bold",children:"Rate Limit (per minute)"}),(0,t.jsx)($.I,{id:"rate_limit",type:"number",value:m.rate_limit_per_minute,onChange:e=>x(a=>({...a,rate_limit_per_minute:parseInt(e.target.value)||60})),min:"1",className:"border-2 border-[#8b7355] rounded-xl"})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ea.r,{checked:m.is_active,onCheckedChange:e=>x(a=>({...a,is_active:e}))}),(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold",children:"Active"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ea.r,{checked:m.is_default,onCheckedChange:e=>x(a=>({...a,is_default:e}))}),(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold",children:"Set as Default"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(X._,{htmlFor:"config_data",className:"text-[#2d3e2d] font-bold",children:["Additional Configuration (JSON)",g&&(0,t.jsx)("span",{className:"text-red-500 ml-2 text-sm",children:"❌ Invalid JSON"})]}),(0,t.jsx)(r.z,{type:"button",onClick:e=>{e.preventDefault();try{let e=JSON.parse(y),a=JSON.stringify(e,null,2);j(a),F(a)}catch(e){console.error("格式化JSON失败:",e),alert("无法格式化JSON，请先修复语法错误")}},variant:"outline",size:"sm",className:"text-xs px-2 py-1 h-6",disabled:!!g,children:"Format JSON"})]}),(0,t.jsx)(es.g,{id:"config_data",value:y,onChange:e=>D(e.target.value),placeholder:'{"quality": "standard", "size": "1024x1024"}',rows:8,className:"border-2 rounded-xl font-mono text-sm ".concat(g?"border-red-500 bg-red-50":"border-[#8b7355]")}),g&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("span",{className:"text-red-500 text-lg",children:"❌"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-red-700 font-bold text-sm",children:"JSON格式错误"}),(0,t.jsx)("p",{className:"text-red-600 text-xs mt-1",children:g}),(0,t.jsxs)("div",{className:"text-red-600 text-xs mt-2",children:[(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"常见问题："})}),(0,t.jsx)("p",{children:'• 确保使用英文引号 " 而不是中文引号 " "'}),(0,t.jsx)("p",{children:"• 检查是否有多余的逗号"}),(0,t.jsxs)("p",{children:["• 确保大括号 "," 配对正确"]})]})]})]})}),(0,t.jsxs)("div",{className:"text-xs text-[#8b7355] space-y-1",children:[(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"Common image sizes:"})}),(0,t.jsx)("p",{children:'• 1:1 → "1024x1024" (Square)'}),(0,t.jsx)("p",{children:'• 2:3 → "1024x1536" (Portrait)'}),(0,t.jsx)("p",{children:'• 3:2 → "1536x1024" (Landscape)'}),(0,t.jsx)("p",{children:'• 16:9 → "1792x1024" (Widescreen)'}),(0,t.jsx)("p",{children:'Note: KIE.AI uses ratios like "1:1", others use pixels'})]})]}),f&&(0,t.jsxs)("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"text-yellow-700 font-bold text-sm",children:"\uD83D\uDCDD Unsaved draft detected and automatically restored"})]}),(0,t.jsx)(r.z,{type:"button",onClick:()=>{confirm("Are you sure you want to clear the draft data? This will restore to the original state.")&&(N(),window.location.reload())},variant:"ghost",size:"sm",className:"text-yellow-600 hover:text-yellow-800 text-xs",children:"Clear Draft"})]}),(0,t.jsx)("p",{className:"text-yellow-600 text-xs mt-1",children:"Your edits are automatically saved, even when switching tabs ✨"})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,t.jsx)(r.z,{type:"button",onClick:k,variant:"outline",className:"border-2 border-[#8b7355] text-[#8b7355] hover:bg-[#8b7355] hover:text-white rounded-xl",children:"Cancel"}),(0,t.jsxs)(r.z,{type:"submit",disabled:o||!!g,className:"bg-[#4a5a4a] hover:bg-[#5a6a5a] text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)(er.Z,{className:"w-4 h-4 mr-2"}),o?"Saving...":a?"Update Configuration":"Create Configuration",g&&" (Fix JSON first)"]})]})]})})]})}var en=s(25556),eo=s(77305);s(24806);var ed=s(36419),ec=s(99517),em=s(4036);function ex(e){let{onCropComplete:a,onCancel:s,maxWidth:n=512,maxHeight:o=512,aspectRatio:d=1,className:c,styleName:m}=e,[x,u]=(0,l.useState)(""),[h,f]=(0,l.useState)({unit:"%",width:80,height:80,x:10,y:10}),[p,g]=(0,l.useState)(),[b,y]=(0,l.useState)([100]),[j,v]=(0,l.useState)(0),N=(0,l.useRef)(null),w=(0,l.useRef)(null),k=(0,l.useRef)(null),_=(0,l.useRef)(""),F=(0,l.useCallback)(e=>{d&&f({unit:"%",width:80,height:80,x:10,y:10})},[d]),D=(0,l.useCallback)(async(e,a,s,t)=>{let l=w.current;if(!l||!a||0===a.width||0===a.height)return;l.width=200,l.height=200;let r=l.getContext("2d");if(!r)return;r.clearRect(0,0,200,200),r.imageSmoothingQuality="high";let i=e.naturalWidth/e.width,n=e.naturalHeight/e.height,o=a.x*i,d=a.y*n,c=a.width*i,m=a.height*n;0!==t&&(r.save(),r.translate(100,100),r.rotate(t*Math.PI/180),r.translate(-100,-100)),r.drawImage(e,o,d,c,m,0,0,200,200),0!==t&&r.restore();try{l.toBlob(e=>{e&&(_.current&&URL.revokeObjectURL(_.current),_.current=URL.createObjectURL(e))},"image/jpeg",.95)}catch(e){console.error("生成预览失败:",e)}},[]),A=(0,l.useCallback)(e=>{g(e),N.current&&e.width&&e.height&&D(N.current,e,b[0],j)},[D,b,j]),[C,O]=(0,l.useState)(!1),S=async()=>{if(_.current)try{O(!0);let e=w.current;if(!e)throw Error("无法获取裁剪后的图片数据");let s=e.toDataURL("image/png");console.log("\uD83D\uDCF8 准备上传裁剪后的图片到R2，样式名称：".concat(m));let t=await fetch("/api/admin/upload-cropped-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:s,styleName:m||"unknown_style"})});if(!t.ok){let e=await t.json();throw Error(e.error||"上传失败")}let l=await t.json();console.log("✅ 图片上传到R2成功：".concat(l.data.r2Url)),a(l.data.r2Url)}catch(e){console.error("❌ 上传裁剪图片失败:",e),alert("上传失败: ".concat(e instanceof Error?e.message:"未知错误"))}finally{O(!1)}};return(0,t.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 ".concat(c),children:[(0,t.jsxs)(i.Zb,{className:"w-full max-w-5xl mx-4 bg-white border-4 border-[#d4a574] rounded-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(i.Ol,{className:"bg-[#d4a574] border-b-4 border-[#8b7355]",children:(0,t.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center justify-between",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(en.Z,{className:"w-6 h-6"}),"图片裁剪器 ✂️"]}),(0,t.jsx)(r.z,{onClick:s,variant:"destructive",size:"sm",className:"rounded-full",children:(0,t.jsx)(et.Z,{className:"w-4 h-4"})})]})}),(0,t.jsx)(i.aY,{className:"p-6 space-y-6",children:x?(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"裁剪和编辑图片"}),(0,t.jsx)("div",{className:"border-2 border-[#8b7355] rounded-xl overflow-hidden bg-gray-100",children:(0,t.jsx)(eo.ZP,{crop:h,onChange:(e,a)=>f(a),onComplete:A,aspect:d,className:"max-h-96",children:(0,t.jsx)("img",{ref:N,src:x,style:{transform:"scale(".concat(b[0]/100,") rotate(").concat(j,"deg)"),maxHeight:"400px",maxWidth:"100%"},onLoad:F,alt:"Crop preview"})})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(X._,{className:"text-[#2d3e2d] font-bold text-sm mb-2 block",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(ec.Z,{className:"w-4 h-4 inline mr-1"}),"缩放: ",b[0],"%"]}),(0,t.jsx)(ed.i,{value:b,onValueChange:e=>{y(e),N.current&&p&&D(N.current,p,e[0],j)},min:50,max:200,step:10,className:"w-full"})]}),(0,t.jsx)("div",{className:"flex flex-col justify-end",children:(0,t.jsxs)(r.z,{type:"button",onClick:()=>{let e=(j+90)%360;v(e),N.current&&p&&D(N.current,p,b[0],e)},className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white font-bold rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(em.Z,{className:"w-4 h-4 mr-1"}),"旋转90\xb0"]})})]}),(0,t.jsx)(r.z,{type:"button",onClick:()=>{f({unit:"%",width:80,height:80,x:10,y:10}),y([100]),v(0)},variant:"outline",className:"w-full border-2 border-[#8b7355] text-[#8b7355] hover:bg-[#f5f1e8] font-bold rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"重置裁剪"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"预览效果"}),(0,t.jsxs)("div",{className:"border-2 border-[#8b7355] rounded-xl p-4 bg-white text-center",children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("p",{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"在首页中的显示效果："})}),p?(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"border-2 border-[#8b7355] bg-white rounded-lg shadow-md overflow-hidden",style:{width:"120px",height:"140px"},children:(0,t.jsxs)("div",{className:"p-2 text-center",children:[(0,t.jsx)("div",{className:"w-full aspect-square mb-1 rounded-lg overflow-hidden border-2 border-[#8b7355]/30",children:(0,t.jsx)("canvas",{ref:w,className:"w-full h-full object-cover scale-110",style:{imageRendering:"crisp-edges",filter:"contrast(1.1) brightness(1.05) saturate(1.1)"}})}),(0,t.jsx)("div",{className:"text-sm",children:"\uD83C\uDFA8"}),(0,t.jsx)("h4",{className:"text-[#2d3e2d] font-black text-xs leading-tight",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"YOUR STYLE"})]})}),(0,t.jsx)("p",{className:"text-[#8b7355] text-xs",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"裁剪框中的内容就是最终显示的效果"})]}):(0,t.jsx)("div",{className:"h-64 flex items-center justify-center text-[#8b7355]",children:(0,t.jsx)("p",{style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"调整裁剪区域查看预览"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,t.jsx)(r.z,{type:"button",onClick:S,disabled:!p||C,className:"bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"上传中..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er.Z,{className:"w-4 h-4 mr-1"}),"保存到云端"]})}),(0,t.jsxs)(r.z,{type:"button",onClick:s,variant:"outline",className:"border-2 border-red-500 text-red-500 hover:bg-red-50 font-bold rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(et.Z,{className:"w-4 h-4 mr-1"}),"取消"]})]})]})]}):(0,t.jsxs)("div",{className:"border-2 border-dashed border-[#8b7355] rounded-xl p-8 text-center bg-[#f5f1e8]",children:[(0,t.jsx)(L.Z,{className:"w-12 h-12 text-[#8b7355] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-lg mb-2",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"选择图片进行裁剪 \uD83D\uDCF8"}),(0,t.jsx)("p",{className:"text-[#8b7355] text-sm mb-4",children:"支持 JPEG、PNG、WebP（最大 10MB）"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!s)return;if(!s.type.startsWith("image/")){alert("请选择图片文件");return}if(s.size>10485760){alert("图片大小不能超过 10MB");return}let t=new FileReader;t.onload=()=>{u(t.result)},t.readAsDataURL(s)},className:"hidden",id:"image-upload"}),(0,t.jsx)("label",{htmlFor:"image-upload",children:(0,t.jsx)(r.z,{type:"button",className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white font-bold rounded-xl cursor-pointer",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},asChild:!0,children:(0,t.jsx)("span",{children:"选择图片"})})})]})})]}),(0,t.jsx)("a",{ref:k,download:!0,style:{position:"absolute",top:"-200vh",visibility:"hidden"},children:"Hidden download"})]})}function eu(e){var a;let{style:s,onSave:n,onCancel:d,isLoading:c}=e,[m,x]=(0,l.useState)({name:"",description:"",emoji:"\uD83C\uDFA8",image_url:"",prompt_template:"",default_prompt:"",type:"image",category:"photographic-realism",is_premium:!1,is_active:!0,sort_order:0,requires_image_upload:!1,requires_prompt_description:!1,prohibits_image_upload:!1,min_prompt_length:0,max_prompt_length:1e3,allowed_image_formats:["jpg","jpeg","png","webp"],requirements_description:""}),[u,h]=(0,l.useState)(""),[f,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1),[y,j]=(0,l.useState)(!0),v="admin_style_form_draft";(0,l.useEffect)(()=>{let e=()=>{j(!document.hidden),document.hidden||console.log("页面重新可见，保持当前状态")};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),(0,l.useEffect)(()=>{if(s)x({name:s.name,description:s.description,emoji:s.emoji,image_url:s.image_url,prompt_template:s.prompt_template,default_prompt:s.default_prompt||"",type:s.type,category:s.category,is_premium:s.is_premium,is_active:s.is_active,sort_order:s.sort_order,requires_image_upload:s.requires_image_upload||!1,requires_prompt_description:s.requires_prompt_description||!1,prohibits_image_upload:s.prohibits_image_upload||!1,min_prompt_length:s.min_prompt_length||0,max_prompt_length:s.max_prompt_length||1e3,allowed_image_formats:s.allowed_image_formats||["jpg","jpeg","png","webp"],requirements_description:s.requirements_description||""}),h(s.image_url);else try{let e=localStorage.getItem(v);if(e){let a=JSON.parse(e);a.formData&&(x(a.formData),h(a.previewImage||""),console.log("已恢复表单草稿"))}}catch(e){console.log("加载表单草稿失败:",e)}},[]),(0,l.useEffect)(()=>{s&&(x({name:s.name,description:s.description,emoji:s.emoji,image_url:s.image_url,prompt_template:s.prompt_template,default_prompt:s.default_prompt||"",type:s.type,category:s.category,is_premium:s.is_premium,is_active:s.is_active,sort_order:s.sort_order,requires_image_upload:s.requires_image_upload||!1,requires_prompt_description:s.requires_prompt_description||!1,prohibits_image_upload:s.prohibits_image_upload||!1,min_prompt_length:s.min_prompt_length||0,max_prompt_length:s.max_prompt_length||1e3,allowed_image_formats:s.allowed_image_formats||["jpg","jpeg","png","webp"],requirements_description:s.requirements_description||""}),h(s.image_url))},[null==s?void 0:s.id]),(0,l.useEffect)(()=>{if(!s&&(m.name||m.description||m.prompt_template||u)){let e=setTimeout(()=>{try{let e={formData:m,previewImage:u,selectedFile:null,timestamp:Date.now(),version:"1.0"};localStorage.setItem(v,JSON.stringify(e)),console.log("✅ 已自动保存草稿 (包含图片)")}catch(e){console.log("❌ 保存表单草稿失败:",e)}},300);return()=>clearTimeout(e)}},[m,u,s]),(0,l.useEffect)(()=>{let e=()=>{if(!s&&(m.name||m.description||m.prompt_template||u))try{let e={formData:m,previewImage:u,timestamp:Date.now(),version:"1.0"};localStorage.setItem(v,JSON.stringify(e)),console.log("\uD83D\uDD04 页面卸载前保存草稿")}catch(e){console.log("❌ 页面卸载前保存失败:",e)}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[m,u,s]);let N=(e,a)=>{x(s=>({...s,[e]:a}))},w=async e=>{if(e.preventDefault(),!m.name.trim()||!m.description.trim()||!m.prompt_template.trim()){alert("请填写所有必填字段");return}if(!m.prompt_template.includes("{prompt}")){alert("⚠️ 提示词模板必须包含 {prompt} 占位符以接收用户输入");return}try{await n(m),s||localStorage.removeItem(v)}catch(e){console.error("保存样式失败:",e)}},k=[{value:"photographic-realism",label:"Photographic Realism"},{value:"illustration-digital-painting",label:"Illustration & Digital Painting"},{value:"anime-comics",label:"Anime & Comics"},{value:"concept-art",label:"Concept Art"},{value:"3d-render",label:"3D Render"},{value:"abstract",label:"Abstract"},{value:"fine-art-movements",label:"Fine-Art Movements"},{value:"technical-scientific",label:"Technical & Scientific"},{value:"architecture-interior",label:"Architecture & Interior"},{value:"design-commercial",label:"Design & Commercial"},{value:"genre-driven",label:"Genre-Driven"},{value:"vintage-retro",label:"Vintage & Retro"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Zb,{className:"w-full max-w-4xl mx-auto border-4 border-[#8b7355] bg-[#f5f1e8]",children:[(0,t.jsx)(i.Ol,{className:"bg-[#d4a574] border-b-4 border-[#8b7355]",children:(0,t.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center gap-2",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(C.Z,{className:"w-6 h-6"}),s?"编辑样式":"创建新样式"," ✨"]})}),(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(X._,{htmlFor:"name",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["样式名称 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)($.I,{id:"name",value:m.name,onChange:e=>N("name",e.target.value),placeholder:"例如：动漫风格",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"emoji",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"表情符号"}),(0,t.jsx)($.I,{id:"emoji",value:m.emoji,onChange:e=>N("emoji",e.target.value),placeholder:"\uD83C\uDFA8",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",maxLength:2})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"type",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"类型"}),(0,t.jsxs)(ee.Ph,{value:m.type,onValueChange:e=>N("type",e),children:[(0,t.jsx)(ee.i4,{className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",children:(0,t.jsx)(ee.ki,{})}),(0,t.jsxs)(ee.Bw,{children:[(0,t.jsx)(ee.Ql,{value:"image",children:"图片生成"}),(0,t.jsx)(ee.Ql,{value:"video",children:"视频生成"}),(0,t.jsx)(ee.Ql,{value:"both",children:"两者皆可"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"category",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"分类"}),(0,t.jsxs)(ee.Ph,{value:m.category,onValueChange:e=>N("category",e),children:[(0,t.jsx)(ee.i4,{className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",children:(0,t.jsx)(ee.ki,{})}),(0,t.jsx)(ee.Bw,{children:k.map(e=>(0,t.jsx)(ee.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"样式预览图片"}),(0,t.jsx)("div",{className:"border-2 border-dashed border-[#8b7355] rounded-xl p-4 text-center bg-white relative",children:u?(0,t.jsx)("div",{className:"relative flex justify-center",children:(0,t.jsxs)("div",{className:"w-48 h-48 relative rounded-lg overflow-hidden border-2 border-[#8b7355]",children:[(0,t.jsx)("img",{src:u,alt:"Style preview",className:"w-full h-full object-cover"}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2",children:[(0,t.jsx)(r.z,{type:"button",variant:"outline",size:"sm",className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white transform transition-all duration-200 hover:scale-110 active:scale-95 shadow-md hover:shadow-lg",onClick:()=>b(!0),children:(0,t.jsx)(en.Z,{className:"w-4 h-4 transition-transform duration-200 hover:rotate-12"})}),(0,t.jsx)(r.z,{type:"button",variant:"destructive",size:"sm",className:"transform transition-all duration-200 hover:scale-110 active:scale-95 shadow-md hover:shadow-lg",onClick:()=>{h(""),N("image_url","")},children:(0,t.jsx)(et.Z,{className:"w-4 h-4 transition-transform duration-200 hover:rotate-90"})})]})]})}):(0,t.jsx)("div",{className:"py-8",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,t.jsx)(L.Z,{className:"w-8 h-8 text-[#8b7355]"}),(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"点击上传并裁剪图片 ✂️"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"支持 PNG、JPG，最大 10MB • 自动裁剪和缩放"}),(0,t.jsxs)(r.z,{type:"button",className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 shadow-lg hover:shadow-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},onClick:()=>b(!0),children:[(0,t.jsx)(en.Z,{className:"w-4 h-4 mr-2 transition-transform duration-200 group-active:rotate-12"}),"选择并裁剪图片"]})]})})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(X._,{htmlFor:"description",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["描述 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(es.g,{id:"description",value:m.description,onChange:e=>N("description",e.target.value),placeholder:"描述样式的特点和特色...",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl min-h-[80px]",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(X._,{htmlFor:"prompt_template",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["提示词模板 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(es.g,{id:"prompt_template",value:m.prompt_template,onChange:e=>N("prompt_template",e.target.value),placeholder:"例如：{prompt}, anime style, vibrant colors, detailed artwork",className:"border-2 ".concat(m.prompt_template.includes("{prompt}")?"border-[#8b7355]":"border-red-500"," focus:border-[#d4a574] rounded-xl min-h-[100px]"),required:!0}),(0,t.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["使用 ","{prompt}"," 作为用户输入的占位符"]}),!m.prompt_template.includes("{prompt}")&&m.prompt_template&&(0,t.jsxs)("p",{className:"text-xs text-red-500 font-bold flex items-center",children:[(0,t.jsx)("span",{className:"mr-1",children:"⚠️"}),"警告：模板必须包含 ","{prompt}"," 占位符以接收用户输入"]}),m.prompt_template.includes("{prompt}")&&m.prompt_template&&(0,t.jsxs)("p",{className:"text-xs text-green-600 font-bold flex items-center",children:[(0,t.jsx)("span",{className:"mr-1",children:"✅"}),"模板有效 - 包含 ","{prompt}"," 占位符"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(X._,{htmlFor:"default_prompt",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["默认提示词 ",(0,t.jsx)("span",{className:"text-blue-500",children:"(可选)"})]}),(0,t.jsx)(es.g,{id:"default_prompt",value:m.default_prompt,onChange:e=>N("default_prompt",e.target.value),placeholder:"例如：Sun Wukong causing havoc in heaven, traditional Chinese mythology, epic battle scene",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl min-h-[80px]"}),(0,t.jsxs)("div",{className:"mt-1",children:[(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"当用户不输入提示词时使用的默认英文提示词。如果用户输入了提示词，则使用用户的提示词。"}),m.default_prompt&&(0,t.jsxs)("p",{className:"text-xs text-green-600 font-bold flex items-center mt-1",children:[(0,t.jsx)("span",{className:"mr-1",children:"✅"}),"已设置默认提示词：用户无输入时将使用此提示词"]})]})]}),(0,t.jsxs)("div",{className:"p-6 bg-gradient-to-r from-[#f5f1e8] to-[#d4a574]/20 rounded-xl border-2 border-[#8b7355]/30",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)("span",{className:"text-xl",children:"⚙️"}),(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"使用限制条件"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-[#8b7355]/30",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDCF8 必须上传图片"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"用户必须上传参考图片才能使用此风格"})]}),(0,t.jsx)(ea.r,{checked:m.requires_image_upload,onCheckedChange:e=>N("requires_image_upload",e),disabled:m.prohibits_image_upload})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-[#8b7355]/30",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"✍️ 必须输入描述"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"用户必须输入提示词描述"})]}),(0,t.jsx)(ea.r,{checked:m.requires_prompt_description,onCheckedChange:e=>N("requires_prompt_description",e)})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 mb-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-xl border border-red-300",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{className:"text-red-700 font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDEAB 禁止图片上传"}),(0,t.jsx)("p",{className:"text-xs text-red-600",children:"此风格仅支持文本生成，不允许上传图片（如CHIBI DIORAMA等风格）"})]}),(0,t.jsx)(ea.r,{checked:m.prohibits_image_upload,onCheckedChange:e=>{N("prohibits_image_upload",e),e&&N("requires_image_upload",!1)}})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"min_prompt_length",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDCDD 最小描述长度"}),(0,t.jsx)($.I,{id:"min_prompt_length",type:"number",value:m.min_prompt_length,onChange:e=>N("min_prompt_length",parseInt(e.target.value)||0),className:"border border-[#8b7355]/30 focus:border-[#d4a574] rounded-lg",min:"0",max:"500",placeholder:"0"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"设置为0表示无限制"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"max_prompt_length",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDCCF 最大描述长度"}),(0,t.jsx)($.I,{id:"max_prompt_length",type:"number",value:m.max_prompt_length,onChange:e=>N("max_prompt_length",parseInt(e.target.value)||1e3),className:"border border-[#8b7355]/30 focus:border-[#d4a574] rounded-lg",min:"10",max:"2000",placeholder:"1000"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"建议设置为1000以内"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)(X._,{htmlFor:"allowed_image_formats",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDDBC️ 允许的图片格式"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:["jpg","jpeg","png","webp","gif","bmp"].map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-1 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:m.allowed_image_formats.includes(e),onChange:a=>{let s=m.allowed_image_formats;a.target.checked?N("allowed_image_formats",[...s,e]):N("allowed_image_formats",s.filter(a=>a!==e))},className:"rounded border-[#8b7355]"}),(0,t.jsx)("span",{className:"text-sm font-bold text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e.toUpperCase()})]},e))}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"选择此风格支持的图片格式"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"requirements_description",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDCCB 使用要求说明"}),(0,t.jsx)(es.g,{id:"requirements_description",value:m.requirements_description,onChange:e=>N("requirements_description",e.target.value),placeholder:"例如：此风格需要上传参考图片，AI将基于您的图片创造玩具摄影风格的作品。请确保图片清晰，主体明确。",className:"border border-[#8b7355]/30 focus:border-[#d4a574] rounded-lg min-h-[80px] mt-1"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"向用户说明使用此风格的具体要求和注意事项"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-xl border-2 border-[#8b7355]",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"高级样式"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"需要订阅"})]}),(0,t.jsx)(ea.r,{checked:m.is_premium,onCheckedChange:e=>N("is_premium",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-xl border-2 border-[#8b7355]",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"启用"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"用户可见"})]}),(0,t.jsx)(ea.r,{checked:m.is_active,onCheckedChange:e=>N("is_active",e)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(X._,{htmlFor:"sort_order",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"排序顺序"}),(0,t.jsx)($.I,{id:"sort_order",type:"number",value:m.sort_order,onChange:e=>N("sort_order",parseInt(e.target.value)||0),className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",min:"0"})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-white rounded-xl border-2 border-[#8b7355]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(U.Z,{className:"w-5 h-5 text-[#8b7355]"}),(0,t.jsx)(X._,{className:"text-[#2d3e2d] font-bold",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"样式预览"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:m.emoji}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-bold text-[#2d3e2d] text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:m.name||"样式名称"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:m.description||"样式描述"}),(0,t.jsxs)("div",{className:"flex gap-1 mt-1",children:[(0,t.jsx)(o.C,{variant:"outline",className:"text-xs",children:"image"===m.type?"图片":"video"===m.type?"视频":"两者"}),(0,t.jsx)(o.C,{variant:"outline",className:"text-xs",children:null===(a=k.find(e=>e.value===m.category))||void 0===a?void 0:a.label}),m.is_premium&&(0,t.jsx)(o.C,{className:"text-xs bg-[#d4a574] text-[#2d3e2d]",children:"高级"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 justify-between",children:[(0,t.jsx)("div",{children:!s&&(m.name||m.description||m.prompt_template||u)&&(0,t.jsx)(r.z,{type:"button",variant:"outline",onClick:()=>{try{let e={formData:m,previewImage:u,timestamp:Date.now(),version:"1.0"};localStorage.setItem(v,JSON.stringify(e)),alert("✅ 草稿已手动保存！"),console.log("\uD83D\uDD04 手动保存草稿成功")}catch(e){alert("❌ 保存草稿失败"),console.log("❌ 手动保存草稿失败:",e)}},className:"border-2 border-blue-500 text-blue-500 hover:bg-blue-50 font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 shadow-md hover:shadow-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"\uD83D\uDCBE 保存草稿"})}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(r.z,{type:"button",variant:"outline",onClick:d,className:"border-2 border-[#8b7355] text-[#2d3e2d] hover:bg-[#8b7355] hover:text-white font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 shadow-md hover:shadow-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"取消"}),(0,t.jsx)(r.z,{type:"submit",disabled:c||f,className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 active:bg-[#b8935a] shadow-lg hover:shadow-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#2d3e2d] mr-2"}),"保存中..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er.Z,{className:"w-4 h-4 mr-2 transition-transform duration-200 group-active:rotate-12"}),s?"更新样式":"创建样式"]})})]})]})]})})]}),g&&(0,t.jsx)(ex,{onCropComplete:e=>{h(e),N("image_url",e),b(!1)},onCancel:()=>{b(!1)},aspectRatio:1,maxWidth:512,maxHeight:512,styleName:m.name})]})}function eh(){let{data:e,status:a,update:s}=(0,d.VF)(),[t,r]=(0,l.useState)(!1);return null}function ef(){var e,a,s,$,X,ee,ea,es;let[et,el]=(0,l.useState)("overview"),[er,en]=(0,l.useState)("user"),[eo,ed]=(0,l.useState)(!1),[ec,em]=(0,l.useState)(!1),[ex,ef]=(0,l.useState)({totalUsers:0,activeUsers:0,newUsers:0,premiumUsers:0,totalImages:0,imagesThisMonth:0,revenue:0,revenueGrowth:0,userImages:0,userViews:0,userLikes:0,userFollowers:0}),[ep,eg]=(0,l.useState)([]),[eb,ey]=(0,l.useState)([]),[ej,ev]=(0,l.useState)([]),[eN,ew]=(0,l.useState)("image_generation"),[ek,e_]=(0,l.useState)(!1),[eF,eD]=(0,l.useState)(null),[eA,eC]=(0,l.useState)([]),[eO,eS]=(0,l.useState)([]),[eB,eI]=(0,l.useState)(!0),[eP,eE]=(0,l.useState)(!1),[ez,eZ]=(0,l.useState)([]),[eU,eR]=(0,l.useState)(!1),[eT,eL]=(0,l.useState)(!1),[eM,eJ]=(0,l.useState)(!1),[eq,eV]=(0,l.useState)(null),[eY,eG]=(0,l.useState)([]),[eQ,eK]=(0,l.useState)(!1),[eW,eH]=(0,l.useState)(!1),[e$,eX]=(0,l.useState)(!1),[e0,e2]=(0,l.useState)(""),[e5,e3]=(0,l.useState)("all"),[e1,e4]=(0,l.useState)(0),[e8,e7]=(0,l.useState)(!1),[e6,e9]=(0,l.useState)(!1),[ae,aa]=(0,l.useState)(new Set),[as,at]=(0,l.useState)({file:null,title:"",prompt:"",style:"Admin",isPublic:!1}),[al,ar]=(0,l.useState)(null),[ai,an]=(0,l.useState)(!1),[ao,ad]=(0,l.useState)({prompt:"",style:"",is_public:!1,status:"completed"}),[ac,am]=(0,l.useState)(!1),ax=(0,W.useRouter)(),au=(0,W.useSearchParams)(),{data:ah,status:af}=(0,d.VF)();(0,l.useEffect)(()=>{var e;if(em(!0),"unauthenticated"===af){ax.push("/admin/login");return}if("user"===au.get("role")){en("user"),ed(!0);return}(null==ah?void 0:null===(e=ah.user)||void 0===e?void 0:e.email)&&(console.log("\uD83D\uDD0D 检查用户session权限:",{email:ah.user.email,isAdmin:ah.user.isAdmin}),ah.user.isAdmin?(console.log("✅ Session中确认为管理员，设置userRole为admin"),en("admin")):(console.log("❌ Session中确认为普通用户，设置userRole为user"),en("user")),ed(!0))},[au,ah,af,ax]),(0,l.useEffect)(()=>{"true"===au.get("admin")&&(console.log("\uD83D\uDD27 临时管理员覆盖激活"),en("admin"),ed(!0))},[au]),(0,l.useEffect)(()=>{var e;"styles"===et&&"admin"===er&&(null==ah?void 0:null===(e=ah.user)||void 0===e?void 0:e.email)&&(console.log("\uD83C\uDFAF 切换到styles标签页"),eT&&0!==ez.length?console.log("✅ Styles数据已存在，跳过重复加载"):(console.log("\uD83D\uDD04 首次加载或数据为空，开始加载styles数据"),ag()))},[et,er,ah,eT,ez.length]),(0,l.useEffect)(()=>{var e;"api-configs"===et&&"admin"===er&&(null==ah?void 0:null===(e=ah.user)||void 0===e?void 0:e.email)&&(console.log("\uD83C\uDFAF 切换到api-configs标签页"),0!==ej.length||eP?console.log("✅ API配置数据已存在，跳过重复加载"):(console.log("\uD83D\uDD04 首次加载或数据为空，开始加载API配置数据"),ap()))},[et,er,ah,ej.length,eP]);let ap=async()=>{try{eE(!0),console.log("\uD83D\uDD04 Loading API configurations...");let a=await fetch("/api/admin/api-configs");if(a.ok){var e;let s=await a.json();ev(s.configs||[]),console.log("✅ API configurations loaded:",(null===(e=s.configs)||void 0===e?void 0:e.length)||0)}else console.error("❌ Failed to load API configurations"),ev([])}catch(e){console.error("❌ Error loading API configurations:",e),ev([])}finally{eE(!1)}},ag=async()=>{var e,a,s;try{eR(!0),console.log("\uD83D\uDD04 Loading styles..."),console.log("\uD83D\uDD0D Session info:",{hasSession:!!ah,userEmail:null==ah?void 0:null===(e=ah.user)||void 0===e?void 0:e.email,userRole:er});let s=await fetch("/api/admin/styles",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(console.log("\uD83D\uDCE1 Styles API response:",{status:s.status,statusText:s.statusText}),s.ok){let e=await s.json();console.log("\uD83D\uDCCA Styles response data:",e),eZ(e.styles||[]),console.log("✅ Styles loaded successfully:",(null===(a=e.styles)||void 0===a?void 0:a.length)||0)}else{let e;try{e=await s.json()}catch(a){e=await s.text()}let a={status:s.status,statusText:s.statusText,error:e,url:s.url};console.error("❌ Failed to load styles:",a),401===s.status?console.error("\uD83D\uDD10 Authentication error: User not logged in"):403===s.status?console.error("⛔ Permission error: Admin access required"):500===s.status&&console.error("\uD83D\uDCA5 Server error: Database or internal error"),eZ([])}}catch(e){console.error("❌ Network or parsing error:",{message:e instanceof Error?e.message:"Unknown error",stack:e instanceof Error?e.stack:void 0,type:null==e?void 0:null===(s=e.constructor)||void 0===s?void 0:s.name}),eZ([])}finally{eR(!1),eL(!0)}},ab=async()=>{try{eI(!0),console.log("\uD83D\uDD04 开始加载Dashboard数据...");let e=new Date().getTime(),a=await fetch("/api/dashboard/stats?t=".concat(e),{cache:"no-cache",headers:{"Cache-Control":"no-cache"}});if(console.log("\uD83D\uDCCA Stats API响应状态:",a.status),a.ok){let e=await a.json();console.log("\uD83D\uDCCA 收到统计数据:",e),e.stats?(console.log("✅ 设置Dashboard统计:",e.stats),ef(e.stats)):console.error("⚠️ 统计数据格式错误:",e)}else console.error("❌ Stats API请求失败:",a.status);if("admin"===er){let e=await fetch("/api/dashboard/users");if(e.ok){let a=await e.json();eg(a.users||[])}let a=await fetch("/api/dashboard/images");if(a.ok){let e=await a.json();ey(e.images||[])}0===ej.length&&ap()}}catch(e){console.error("❌ 加载仪表板数据失败:",e)}finally{eI(!1)}},ay=()=>{let e=ex.totalUsers||0,a=ex.totalImages||0,s=ex.revenue||0;eC(["Jan","Feb","Mar","Apr","May","Jun"].map((t,l)=>({name:t,users:Math.floor(e*(.1+.05*l)),images:Math.floor(a*(.08+.04*l)),revenue:Math.floor(s*(.12+.03*l))}))),eS([{name:"Free Users",value:Math.floor(.6*e),color:"#8b7355"},{name:"Pro Users",value:Math.floor(.3*e),color:"#d4a574"},{name:"Wizard Users",value:Math.floor(.1*e),color:"#2d3e2d"}])};(0,l.useEffect)(()=>{var e,a;(null==ah?void 0:null===(e=ah.user)||void 0===e?void 0:e.email)&&"admin"===er&&eo?(console.log("✅ 满足条件，开始加载数据"),console.log("- 用户邮箱:",ah.user.email),console.log("- 用户角色:",er),console.log("- 角色检查完成:",eo),ab()):(console.log("❌ 不满足数据加载条件:"),console.log("- 用户邮箱:",(null==ah?void 0:null===(a=ah.user)||void 0===a?void 0:a.email)||"无"),console.log("- 用户角色:",er),console.log("- 角色检查完成:",eo))},[null==ah?void 0:null===(e=ah.user)||void 0===e?void 0:e.email,er,eo]),(0,l.useEffect)(()=>{(ex.totalUsers>0||ex.totalImages>0)&&(console.log("\uD83D\uDCC8 Dashboard统计数据已更新，生成图表数据:",ex),ay())},[ex]),(0,l.useEffect)(()=>{"images"!==et||"admin"!==er||0!==eY.length||eQ||(ak(!0),aP())},[et,er]);let[aj]=(0,l.useState)(()=>[{id:0,left:10,top:20,size:15,rotation:45,delay:.5},{id:1,left:80,top:10,size:20,rotation:90,delay:1},{id:2,left:30,top:70,size:12,rotation:180,delay:1.5},{id:3,left:60,top:40,size:18,rotation:270,delay:.8},{id:4,left:15,top:85,size:14,rotation:30,delay:1.2},{id:5,left:90,top:60,size:16,rotation:120,delay:.3},{id:6,left:45,top:15,size:22,rotation:200,delay:1.8},{id:7,left:70,top:90,size:13,rotation:315,delay:.7}]),av=async()=>{try{console.log("\uD83D\uDEAA 开始登出流程...");let e=await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){let a=await e.json();console.log("✅ 登出时间记录成功:",a)}else console.error("⚠️ 登出时间记录失败，但继续登出")}catch(e){console.error("⚠️ 调用登出API失败，但继续登出:",e)}await (0,d.dr)({callbackUrl:"/admin/login"})},aN=e=>{switch(e){case"Free":return"bg-[#8b7355] text-white";case"Pro":return"bg-[#d4a574] text-[#2d3e2d]";case"Wizard":return"bg-[#2d3e2d] text-white";default:return"bg-gray-500 text-white"}},aw=e=>{switch(e){case"active":case"approved":return"bg-green-500 text-white";case"inactive":default:return"bg-gray-500 text-white";case"pending":return"bg-yellow-500 text-white";case"rejected":return"bg-red-500 text-white"}},ak=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e?(eK(!0),e4(0)):e9(!0);try{let a=e?0:e1,s=new URLSearchParams({limit:"12",offset:a.toString(),filter:e5,search:e0}),t=await fetch("/api/admin/images?".concat(s)),l=await t.json();l.success?(e?eG(l.data):eG(e=>[...e,...l.data]),e7(l.hasMore),e4(a+l.data.length)):console.error("Failed to load images:",l.error)}catch(e){console.error("Error loading admin images:",e)}finally{eK(!1),e9(!1)}},a_=async()=>{if(as.file){eX(!0);try{let e=new FormData;e.append("file",as.file),e.append("title",as.title),e.append("prompt",as.prompt),e.append("style",as.style),e.append("isPublic",as.isPublic.toString());let a=await fetch("/api/admin/images/upload",{method:"POST",body:e}),s=await a.json();s.success?(console.log("✅ Image uploaded successfully:",s.data),at({file:null,title:"",prompt:"",style:"Admin",isPublic:!1}),eH(!1),ak(!0)):(console.error("Upload failed:",s.error),alert("Upload failed: "+s.error))}catch(e){console.error("Error uploading image:",e),alert("Upload failed, please try again")}finally{eX(!1)}}},aF=async e=>{if(confirm('Are you sure you want to delete image "'.concat(e.title,'"? This action cannot be undone.')))try{let a=await fetch("/api/admin/images",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:e.id,userId:e.user_id})}),s=await a.json();s.success?(console.log("✅ Image deleted successfully"),eG(a=>a.filter(a=>a.id!==e.id))):(console.error("Delete failed:",s.error),alert("Delete failed: "+s.error))}catch(a){console.error("Error deleting image:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Delete failed: ".concat(e))}},aD=async e=>{try{let a=await fetch("/api/admin/images/toggle-public",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:e.id,userId:e.user_id})}),s=await a.json();s.success?(console.log("✅ Image public status toggled"),eG(a=>a.map(a=>a.id===e.id?{...a,is_public:!a.is_public}:a))):(console.error("Toggle failed:",s.error),alert("Toggle status failed: "+s.error))}catch(a){console.error("Error toggling image public status:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Operation failed: ".concat(e))}},aA=async e=>{try{let a=await fetch(e.generated_image_url),s=await a.blob(),t=window.URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download="".concat(e.title,"_").concat(e.id,".png"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(t),document.body.removeChild(l)}catch(a){console.error("Error downloading image:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Download failed: ".concat(e))}},aC=e=>{ar(e),ad({prompt:e.prompt||"",style:e.style||"",is_public:e.is_public||!1,status:e.status||"completed"}),an(!0),0===ez.length&&"admin"===er&&(console.log("\uD83C\uDFA8 Loading styles for edit form..."),ag())},aO=async()=>{if(al){am(!0);try{let e=await fetch("/api/admin/images/edit",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:al.id,...ao})}),a=await e.json();a.success?(console.log("✅ Image updated successfully"),eG(e=>e.map(e=>e.id===al.id?{...e,...ao,updated_at:new Date().toISOString().split("T")[0]+" "+new Date().toISOString().split("T")[1].split(".")[0]}:e)),an(!1),ar(null),alert("✅ Image updated successfully!")):(console.error("Edit failed:",a.error),alert("Edit failed: "+a.error))}catch(a){console.error("Error editing image:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Edit failed: ".concat(e))}finally{am(!1)}}},aS=async()=>{if(confirm("确定要将所有图片设置为公开状态吗？这个操作不可撤销。"))try{let e=await fetch("/api/admin/images/make-all-public",{method:"POST",headers:{"Content-Type":"application/json"}}),a=await e.json();a.success?(console.log("✅ All images made public successfully"),alert("✅ 成功将 ".concat(a.updatedCount," 张图片设置为公开状态！")),ak(!0)):(console.error("Make all public failed:",a.error),alert("操作失败: "+a.error))}catch(a){console.error("Error making all images public:",a);let e=a instanceof Error?a.message:"Unknown error";alert("操作失败: ".concat(e))}},aB=async()=>{try{let e=await fetch("/api/admin/images/diagnose"),a=await e.json();if(a.success){let{stats:e,duplicatesByUrl:s,duplicatesByIds:t}=a,l="\uD83D\uDCCA 图片诊断结果:\n\n";l+="总图片数: ".concat(e.totalImages,"\n")+"公开图片: ".concat(e.publicImages,"\n")+"私有图片: ".concat(e.privateImages,"\n")+"唯一URL数: ".concat(e.uniqueUrls,"\n")+"重复URL数: ".concat(e.duplicateUrls,"\n")+"重复ID数: ".concat(e.duplicateIds,"\n\n"),e.duplicateUrls>0?(l+="⚠️ 发现 ".concat(e.duplicateUrls," 个重复的图片URL\n")+"这可能导致同一张图片显示多次。\n\n",s.length>0&&(l+="示例重复:\n",s.slice(0,3).forEach((e,a)=>{l+="".concat(a+1,". ").concat(e.count,"个相同图片 (").concat(e.images[0].style,")\n")}))):l+="✅ 没有发现重复的图片URL\n",alert(l),console.log("\uD83D\uDCCA 诊断结果:",a)}else console.error("Diagnose failed:",a.error),alert("诊断失败: "+a.error)}catch(a){console.error("Error diagnosing images:",a);let e=a instanceof Error?a.message:"Unknown error";alert("诊断失败: ".concat(e))}},aI=async e=>{try{let a=ae.has(e.id),s=await fetch("/api/admin/images/featured",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:e.id,featured:!a})}),t=await s.json();t.success?(console.log("✅ Featured status toggled"),aa(s=>{let t=new Set(s);return a?t.delete(e.id):t.add(e.id),t})):(console.error("Toggle featured failed:",t.error),alert("Toggle featured status failed: "+t.error))}catch(a){console.error("Error toggling featured status:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Operation failed: ".concat(e))}},aP=async()=>{try{let e=await fetch("/api/admin/images/featured"),a=await e.json();a.success&&aa(new Set(a.data.map(e=>e.image_id)))}catch(e){console.error("Error loading featured status:",e)}},aE=async e=>{try{let a={name:"".concat(e.name," (Copy)"),type:e.type,provider:e.provider,base_url:e.base_url,api_key:e.api_key,model:e.model,endpoint:e.endpoint,priority:e.priority+1,is_default:!1,is_active:e.is_active,max_retries:e.max_retries,timeout_seconds:e.timeout_seconds,rate_limit_per_minute:e.rate_limit_per_minute,config_data:e.config_data},s=await fetch("/api/admin/api-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(s.ok)await ap(),alert("✅ API configuration copied successfully!");else{let e=await s.json().catch(()=>({error:"Unknown error"}));alert("❌ Failed to copy API configuration: ".concat(e.error||"Unknown error"))}}catch(a){console.error("Error copying API config:",a);let e=a instanceof Error?a.message:"Unknown error";alert("❌ Failed to copy API configuration: ".concat(e))}};return((0,l.useEffect)(()=>{},[ah,er,eo,ec,af]),"loading"!==af&&ec)?(0,t.jsxs)("div",{className:"min-h-screen bg-[#f5f1e8] relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute top-20 right-20 w-40 h-40 bg-[#8b7355]/5 rounded-full blur-3xl"}),(0,t.jsx)("div",{className:"absolute bottom-20 left-20 w-32 h-32 bg-[#2d3e2d]/5 rounded-full blur-2xl"}),ec&&aj&&Array.isArray(aj)&&aj.map(e=>(0,t.jsx)(H.E.div,{className:"absolute",style:{left:"".concat(e.left,"%"),top:"".concat(e.top,"%"),width:"".concat(e.size,"px"),height:"".concat(e.size,"px")},animate:{y:[-10,10,-10],rotate:[0,360],scale:[.8,1.2,.8]},transition:{duration:6+e.delay,repeat:1/0,ease:"easeInOut"},children:(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-[#d4a574]/20 to-[#8b7355]/20 rounded-full",style:{transform:"rotate(".concat(e.rotation,"deg)")}})},e.id))]}),(0,t.jsx)("header",{className:"relative z-10 bg-white/95 backdrop-blur-md border-b-4 border-[#8b7355] p-4 md:p-6 shadow-lg",children:(0,t.jsx)("div",{className:"container mx-auto",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(r.z,{onClick:()=>ax.push("/"),variant:"ghost",className:"text-[#2d3e2d] hover:bg-[#d4a574] hover:text-[#2d3e2d] font-black rounded-2xl transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Back to Home \uD83C\uDFE0"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-[#2d3e2d] rounded-2xl flex items-center justify-center shadow-lg transform rotate-12",children:"admin"===er?(0,t.jsx)(N.Z,{className:"w-6 h-6 text-[#d4a574]"}):(0,t.jsx)(w.Z,{className:"w-6 h-6 text-[#d4a574]"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-black text-[#2d3e2d] transform -rotate-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif",textShadow:"2px 2px 0px #8b7355"},children:["AIMAGICA ","admin"===er?"Admin":"User"]}),(0,t.jsx)("p",{className:"text-sm font-bold text-[#8b7355] transform rotate-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"Master Control Panel \uD83D\uDC51":"Creative Workspace \uD83C\uDFA8"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(r.z,{variant:"ghost",className:"text-[#2d3e2d] hover:bg-[#d4a574] hover:text-[#2d3e2d] font-black rounded-2xl transform hover:scale-105 transition-all relative",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(k.Z,{className:"w-5 h-5"}),(0,t.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),(null==ah?void 0:ah.user)&&(0,t.jsx)("div",{className:"flex items-center space-x-3",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[ah.user.image?(0,t.jsx)("img",{src:ah.user.image,alt:ah.user.name||"User",className:"w-10 h-10 rounded-full border-2 border-[#d4a574] shadow-md",onError:e=>{console.warn("Avatar loading failed:",ah.user.image),e.currentTarget.style.display="none";let a=e.currentTarget.nextElementSibling;a&&(a.style.display="flex")},onLoad:()=>{console.log("Avatar loaded successfully:",ah.user.image)}}):null,(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-[#d4a574] to-[#8b7355] rounded-full flex items-center justify-center text-white font-black",style:{display:ah.user.image?"none":"flex"},children:(null===(a=ah.user.name)||void 0===a?void 0:a.charAt(0))||(null===(s=ah.user.email)||void 0===s?void 0:s.charAt(0))||"U"}),(0,t.jsxs)("div",{className:"hidden md:block",children:[(0,t.jsx)("p",{className:"text-[#2d3e2d] font-black text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:ah.user.name||"Magic User"}),(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-xs",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"Admin":"User"})]})]})}),(0,t.jsxs)(r.z,{onClick:av,className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-[#f5f1e8] font-black px-6 py-3 rounded-2xl shadow-lg transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Logout \uD83D\uDC4B"]})]})]})})}),(0,t.jsxs)("main",{className:"relative z-10 container mx-auto px-4 md:px-6 py-8",children:[(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:(0,t.jsxs)("div",{className:"bg-gradient-to-r from-[#2d3e2d] via-[#8b7355] to-[#d4a574] rounded-3xl border-4 border-[#2d3e2d] p-6 shadow-2xl relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-[#f5f1e8] rounded-full opacity-80"}),(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"admin"===er?"\uD83D\uDC51":"\uD83C\uDFA8"}),(0,t.jsxs)("h2",{className:"text-3xl md:text-4xl font-black text-[#f5f1e8] mb-2 transform -rotate-1",style:{fontFamily:"Fredoka One, Arial Black, sans-serif",textShadow:"2px 2px 0px rgba(0,0,0,0.3)"},children:["Welcome, ",(null==ah?void 0:null===($=ah.user)||void 0===$?void 0:$.name)||("admin"===er?"Master Admin":"Creative Master"),"! ✨"]}),(0,t.jsxs)("p",{className:"text-[#f5f1e8] font-bold text-lg opacity-90",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["admin"===er?"Manage the magical kingdom of AIMAGICA with your supreme power!":"Track your creative journey and manage your magical artworks!"," \uD83C\uDF1F"]})]})]})}),(0,t.jsxs)(n.mQ,{value:et,onValueChange:el,className:"w-full",children:[(0,t.jsxs)(n.dr,{className:"grid w-full ".concat("admin"===er?"grid-cols-8":"grid-cols-3"," bg-[#4a5a4a] rounded-2xl p-2 shadow-lg mb-8"),children:[(0,t.jsxs)(n.SP,{value:"overview",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(F.Z,{className:"w-4 h-4 mr-2"}),"Overview \uD83D\uDCCA"]}),(0,t.jsxs)(n.SP,{value:"images",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(D.Z,{className:"w-4 h-4 mr-2"}),"admin"===er?"All Images":"My Art"," \uD83C\uDFA8"]}),"admin"===er&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.SP,{value:"users",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Users \uD83D\uDC65"]}),(0,t.jsxs)(n.SP,{value:"styles",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(C.Z,{className:"w-4 h-4 mr-2"}),"Styles \uD83C\uDFAD"]}),(0,t.jsxs)(n.SP,{value:"api-configs",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(O.Z,{className:"w-4 h-4 mr-2"}),"API Configs ⚡"]}),(0,t.jsxs)(n.SP,{value:"payment",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(S.Z,{className:"w-4 h-4 mr-2"}),"Payment \uD83D\uDCB3"]}),(0,t.jsxs)(n.SP,{value:"prompts",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},onClick:()=>ax.push("/admin/prompts"),children:[(0,t.jsx)(B.Z,{className:"w-4 h-4 mr-2"}),"Prompts ✨"]})]}),(0,t.jsxs)(n.SP,{value:"settings",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(I.Z,{className:"w-4 h-4 mr-2"}),"Settings ⚙️"]})]}),(0,t.jsxs)(n.nU,{value:"overview",className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,t.jsx)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"Total Users":"My Images"}),(0,t.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?(null==ex?void 0:null===(X=ex.totalUsers)||void 0===X?void 0:X.toString())||"0":(null==ex?void 0:null===(ee=ex.userImages)||void 0===ee?void 0:ee.toString())||"0"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-[#8b7355] rounded-full flex items-center justify-center",children:(0,t.jsx)(A.Z,{className:"w-6 h-6 text-white"})})]})})})}),(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,t.jsx)(i.Zb,{className:"bg-white border-4 border-[#d4a574] rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"Total Images":"Total Views"}),(0,t.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?((null==ex?void 0:ex.totalImages)||0).toString():((null==ex?void 0:ex.userViews)||0).toString()})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-[#d4a574] rounded-full flex items-center justify-center",children:(0,t.jsx)(D.Z,{className:"w-6 h-6 text-white"})})]})})})}),(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,t.jsx)(i.Zb,{className:"bg-white border-4 border-[#2d3e2d] rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"Monthly Revenue":"Total Likes"}),(0,t.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"$".concat(((null==ex?void 0:ex.revenue)||0).toString()):((null==ex?void 0:ex.userLikes)||0).toString()})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-[#2d3e2d] rounded-full flex items-center justify-center",children:"admin"===er?(0,t.jsx)(P.Z,{className:"w-6 h-6 text-white"}):(0,t.jsx)(E.Z,{className:"w-6 h-6 text-white"})})]})})})}),(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,t.jsx)(i.Zb,{className:"bg-white border-4 border-green-500 rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"Growth Rate":"Followers"}),(0,t.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"admin"===er?"+".concat(ex.revenueGrowth,"%"):(null===(ea=ex.userFollowers)||void 0===ea?void 0:ea.toString())||"0"})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:(0,t.jsx)(z.Z,{className:"w-6 h-6 text-white"})})]})})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsx)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},children:(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(c.v,{className:"w-6 h-6 mr-2"}),"admin"===er?"Platform Statistics \uD83D\uDCC8":"My Progress \uD83D\uDCCA"]})}),(0,t.jsx)(i.aY,{children:(0,t.jsx)(m.h,{width:"100%",height:300,children:(0,t.jsxs)(x.w,{data:eA,children:[(0,t.jsx)(u.q,{strokeDasharray:"3 3"}),(0,t.jsx)(h.K,{dataKey:"name"}),(0,t.jsx)(f.B,{}),(0,t.jsx)(p.u,{}),(0,t.jsx)(g.x,{type:"monotone",dataKey:"admin"===er?"users":"images",stroke:"#d4a574",strokeWidth:3}),(0,t.jsx)(g.x,{type:"monotone",dataKey:"admin"===er?"revenue":"views",stroke:"#2d3e2d",strokeWidth:3})]})})})]})}),(0,t.jsx)(H.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.6},children:(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#d4a574] rounded-2xl shadow-lg",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(b.u,{className:"w-6 h-6 mr-2"}),"admin"===er?"User Distribution \uD83E\uDD67":"Style Breakdown \uD83C\uDFA8"]})}),(0,t.jsx)(i.aY,{children:(0,t.jsx)(m.h,{width:"100%",height:300,children:(0,t.jsxs)(b.u,{children:[(0,t.jsx)(y.b,{data:eO,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:a,percent:s}=e;return"".concat(a," ").concat((100*s).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:eO&&Array.isArray(eO)&&eO.map((e,a)=>(0,t.jsx)(j.b,{fill:e.color},"cell-".concat(a)))}),(0,t.jsx)(p.u,{})]})})})]})})]})]}),"admin"===er&&(0,t.jsx)(n.nU,{value:"users",className:"space-y-6",children:(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(A.Z,{className:"w-8 h-8 mr-3"}),"User Management \uD83D\uDC65"]}),(0,t.jsxs)(r.z,{className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 mr-2"}),"Add User ➕"]})]})}),(0,t.jsx)(i.aY,{children:(0,t.jsx)("div",{className:"space-y-4",children:ep&&Array.isArray(ep)&&ep.map((e,a)=>(0,t.jsxs)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"flex items-center justify-between p-4 bg-[#f5f1e8] rounded-2xl border-2 border-[#8b7355] hover:border-[#d4a574] transition-all",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-[#d4a574] to-[#8b7355] rounded-full flex items-center justify-center text-white font-black",children:e.avatar}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e.name}),(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e.email})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(o.C,{className:aN(e.plan),children:e.plan}),(0,t.jsx)(o.C,{className:aw(e.status),children:e.status}),(0,t.jsxs)("span",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[e.images," images"]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",children:(0,t.jsx)(U.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",children:(0,t.jsx)(R.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",children:(0,t.jsx)(T.Z,{className:"w-4 h-4"})})]})]})]},e.id))})})]})})}),(0,t.jsxs)(n.nU,{value:"images",className:"space-y-6",children:[(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#d4a574] rounded-2xl shadow-lg",children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(D.Z,{className:"w-8 h-8 mr-3"}),"admin"===er?"Image Management \uD83D\uDDBC️":"My Artworks \uD83C\uDFA8"]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:["admin"===er&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.z,{onClick:()=>eH(!0),className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-[#f5f1e8] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(L.Z,{className:"w-4 h-4 mr-2"}),"Upload Image ⬆️"]}),(0,t.jsxs)(r.z,{onClick:aS,className:"bg-green-600 hover:bg-green-700 text-white font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(M.Z,{className:"w-4 h-4 mr-2"}),"Make All Public \uD83C\uDF10"]}),(0,t.jsxs)(r.z,{onClick:aB,className:"bg-purple-600 hover:bg-purple-700 text-white font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(F.Z,{className:"w-4 h-4 mr-2"}),"Diagnose \uD83D\uDD0D"]})]}),(0,t.jsxs)(r.z,{onClick:ak,variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(F.Z,{className:"w-4 h-4 mr-2"}),"Refresh List \uD83D\uDD04"]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)("input",{type:"text",placeholder:"Search prompts or styles...",value:e0,onChange:e=>e2(e.target.value),className:"w-full px-4 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"}})}),(0,t.jsxs)("select",{value:e5,onChange:e=>e3(e.target.value),className:"px-4 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)("option",{value:"all",children:"All Images"}),(0,t.jsx)("option",{value:"public",children:"Public Images"}),(0,t.jsx)("option",{value:"private",children:"Private Images"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"processing",children:"Processing"}),(0,t.jsx)("option",{value:"failed",children:"Failed"})]}),(0,t.jsx)(r.z,{onClick:()=>{ak(!0)},className:"bg-[#8b7355] hover:bg-[#6b5a44] text-white font-black rounded-xl px-6",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Search \uD83D\uDD0D"})]})]}),(0,t.jsxs)(i.aY,{children:[ec?eQ?(0,t.jsxs)("div",{className:"flex justify-center items-center py-20",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355]"}),(0,t.jsx)("span",{className:"ml-4 text-[#8b7355] font-bold",children:"Loading images..."})]}):eY&&Array.isArray(eY)&&0!==eY.length?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:eY&&Array.isArray(eY)&&eY.map((e,a)=>(0,t.jsxs)(H.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*a},className:"bg-[#f5f1e8] rounded-2xl border-2 border-[#d4a574] hover:border-[#8b7355] transition-all overflow-hidden",children:[(0,t.jsxs)("div",{className:"relative aspect-square",children:[(0,t.jsx)("img",{src:e.generated_image_url,alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/placeholder-image.png"}}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-1",children:[(0,t.jsx)("button",{onClick:()=>aD(e),className:"px-2 py-1 rounded-lg text-xs font-bold transition-all hover:scale-105 ".concat(e.is_public?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-500 hover:bg-gray-600 text-white"),title:"Click to make ".concat(e.is_public?"private":"public"),children:e.is_public?"\uD83C\uDF10 Public":"\uD83D\uDD12 Private"}),(0,t.jsx)(o.C,{className:"bg-[#8b7355] text-white text-xs",children:e.style})]})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h4",{className:"font-black text-[#2d3e2d] text-sm mb-2 line-clamp-2",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},title:e.prompt,children:e.title}),(0,t.jsxs)("p",{className:"text-[#8b7355] font-bold text-xs mb-3",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["User: ",e.user_name," • ",e.created_at]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-[#8b7355] font-bold text-xs",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(E.Z,{className:"w-3 h-3 mr-1"}),e.likes_count]}),e.render_time&&(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(J.Z,{className:"w-3 h-3 mr-1"}),e.render_time,"s"]})]}),(0,t.jsxs)("div",{className:"flex space-x-1",children:[(0,t.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>window.open(e.generated_image_url,"_blank"),className:"text-[#8b7355] hover:text-[#2d3e2d] p-1 h-8 w-8",children:(0,t.jsx)(U.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>aA(e),className:"text-[#8b7355] hover:text-[#2d3e2d] p-1 h-8 w-8",children:(0,t.jsx)(q.Z,{className:"w-4 h-4"})}),"admin"===er&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>aI(e),className:"p-1 h-8 w-8 ".concat(ae.has(e.id)?"text-orange-500 hover:text-orange-700":"text-gray-400 hover:text-orange-500"),title:ae.has(e.id)?"Remove from Featured":"Add to Featured",children:(0,t.jsx)(V.Z,{className:"w-4 h-4 ".concat(ae.has(e.id)?"fill-current":"")})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>aC(e),className:"text-yellow-500 hover:text-yellow-700 p-1 h-8 w-8",title:"Edit Image",children:(0,t.jsx)(R.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>aF(e),className:"text-red-500 hover:text-red-700 p-1 h-8 w-8",title:"Delete Image",children:(0,t.jsx)(T.Z,{className:"w-4 h-4"})})]})]})]})]})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-20",children:[(0,t.jsx)(D.Z,{className:"w-16 h-16 text-[#d4a574] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-lg",children:"No images found"}),(0,t.jsx)("p",{className:"text-[#8b7355] text-sm mt-2",children:"Try adjusting search criteria or upload new images"})]}):(0,t.jsxs)("div",{className:"flex justify-center items-center py-20",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355]"}),(0,t.jsx)("span",{className:"ml-4 text-[#8b7355] font-bold",children:"Loading..."})]}),eY&&Array.isArray(eY)&&eY.length>0&&e8&&(0,t.jsx)("div",{className:"text-center mt-6",children:(0,t.jsx)(r.z,{onClick:()=>{ak(!1)},disabled:e6,className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl px-8",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e6?"Loading...":"Load More \uD83D\uDCF8"})})]})]})}),eW&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)(H.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl p-6 max-w-md w-full mx-4 border-4 border-[#d4a574]",children:[(0,t.jsx)("h3",{className:"text-2xl font-black text-[#2d3e2d] mb-4",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Upload Image \uD83D\uDCF8"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Select Image File"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];s&&at(e=>({...e,file:s,title:e.title||s.name.replace(/\.[^/.]+$/,"")}))},className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Image Title"}),(0,t.jsx)("input",{type:"text",value:as.title,onChange:e=>at({...as,title:e.target.value}),placeholder:"Enter image title...",className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Image Description"}),(0,t.jsx)("textarea",{value:as.prompt,onChange:e=>at({...as,prompt:e.target.value}),placeholder:"Enter image description...",rows:3,className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none resize-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Image Style"}),(0,t.jsxs)("select",{value:as.style,onChange:e=>at({...as,style:e.target.value}),className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)("option",{value:"Admin",children:"Admin"}),(0,t.jsx)("option",{value:"Realistic",children:"Realistic"}),(0,t.jsx)("option",{value:"Anime",children:"Anime"}),(0,t.jsx)("option",{value:"Cartoon",children:"Cartoon"}),(0,t.jsx)("option",{value:"Fantasy",children:"Fantasy"}),(0,t.jsx)("option",{value:"Abstract",children:"Abstract"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",id:"isPublic",checked:as.isPublic,onChange:e=>at({...as,isPublic:e.target.checked}),className:"w-4 h-4 text-[#8b7355] border-2 border-[#d4a574] rounded focus:ring-[#8b7355]"}),(0,t.jsx)("label",{htmlFor:"isPublic",className:"text-sm font-bold text-[#8b7355]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Share to Gallery"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,t.jsx)(r.z,{onClick:()=>eH(!1),variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Cancel"}),(0,t.jsx)(r.z,{onClick:a_,disabled:e$||!as.file,className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-white font-black rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e$?"Uploading...":"Upload \uD83D\uDCE4"})]})]})}),ai&&al&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)(H.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl p-6 max-w-2xl w-full mx-4 border-4 border-[#d4a574] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("h3",{className:"text-2xl font-black text-[#2d3e2d] mb-4 flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(R.Z,{className:"w-6 h-6 mr-2"}),"Edit Image Metadata ✏️"]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"relative aspect-video bg-gray-100 rounded-xl overflow-hidden",children:[(0,t.jsx)("img",{src:al.generated_image_url,alt:al.title,className:"w-full h-full object-contain"}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-1",children:[(0,t.jsx)(o.C,{className:"".concat(al.is_public?"bg-green-500":"bg-gray-500"," text-white text-xs"),children:al.is_public?"Public":"Private"}),(0,t.jsx)(o.C,{className:"bg-[#8b7355] text-white text-xs",children:al.style})]})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[(0,t.jsx)("strong",{children:"ID:"})," ",al.id," |",(0,t.jsx)("strong",{children:" User:"})," ",al.user_name," |",(0,t.jsx)("strong",{children:" Created:"})," ",al.created_at]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Prompt / Description"}),(0,t.jsx)("textarea",{value:ao.prompt,onChange:e=>ad({...ao,prompt:e.target.value}),placeholder:"Enter image description or prompt...",rows:4,className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none resize-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Style"}),(0,t.jsx)("select",{value:ao.style,onChange:e=>ad({...ao,style:e.target.value}),className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:ez&&Array.isArray(ez)&&ez.length>0?ez.map(e=>(0,t.jsxs)("option",{value:e.name,children:[e.emoji," ",e.name]},e.id)):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("option",{value:"Photorealistic",children:"Photorealistic"}),(0,t.jsx)("option",{value:"Art Toy Style",children:"Art Toy Style"}),(0,t.jsx)("option",{value:"Chibi Diorama",children:"Chibi Diorama"}),(0,t.jsx)("option",{value:"Photo Dump Aesthetic",children:"Photo Dump Aesthetic"}),(0,t.jsx)("option",{value:"Hyperrealistic Fur",children:"Hyperrealistic Fur"}),(0,t.jsx)("option",{value:"3D Street Art",children:"3D Street Art"}),(0,t.jsx)("option",{value:"Cyberpunk",children:"Cyberpunk"}),(0,t.jsx)("option",{value:"Realistic",children:"Realistic"}),(0,t.jsx)("option",{value:"Anime",children:"Anime"}),(0,t.jsx)("option",{value:"Cartoon",children:"Cartoon"}),(0,t.jsx)("option",{value:"Fantasy",children:"Fantasy"}),(0,t.jsx)("option",{value:"Abstract",children:"Abstract"}),(0,t.jsx)("option",{value:"Admin",children:"Admin"})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Status"}),(0,t.jsxs)("select",{value:ao.status,onChange:e=>ad({...ao,status:e.target.value}),className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"processing",children:"Processing"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"failed",children:"Failed"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",id:"editIsPublic",checked:ao.is_public,onChange:e=>ad({...ao,is_public:e.target.checked}),className:"w-4 h-4 text-[#8b7355] border-2 border-[#d4a574] rounded focus:ring-[#8b7355]"}),(0,t.jsx)("label",{htmlFor:"editIsPublic",className:"text-sm font-bold text-[#8b7355]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Public Gallery Visibility"}),ao.is_public&&(0,t.jsx)(o.C,{className:"bg-green-500 text-white text-xs",children:"\uD83C\uDF10 Public"}),!ao.is_public&&(0,t.jsx)(o.C,{className:"bg-gray-500 text-white text-xs",children:"\uD83D\uDD12 Private"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,t.jsx)(r.z,{onClick:()=>{an(!1),ar(null),ad({prompt:"",style:"",is_public:!1,status:"completed"})},variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Cancel"}),(0,t.jsx)(r.z,{onClick:aO,disabled:ac,className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-white font-black rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:ac?"Saving...":"Save Changes \uD83D\uDCBE"})]})]})})]}),"admin"===er&&(0,t.jsx)(n.nU,{value:"api-configs",className:"space-y-6",children:(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:ek?(0,t.jsx)(ei,{config:eF,onSave:async e=>{try{let a=eF?"/api/admin/api-configs/".concat(eF.id):"/api/admin/api-configs",s=await fetch(a,{method:eF?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok)await ap(),e_(!1),eD(null),alert(eF?"✅ API configuration updated successfully!":"✅ API configuration created successfully!");else{let e=await s.json().catch(()=>({error:"Unknown error"}));alert("❌ Failed to ".concat(eF?"update":"create"," API configuration: ").concat(e.error||"Unknown error"))}}catch(a){console.error("Error saving API config:",a);let e=a instanceof Error?a.message:"Unknown error";alert("❌ Failed to ".concat(eF?"update":"create"," API configuration: ").concat(e))}},onCancel:()=>{e_(!1),eD(null)},isLoading:!1}):(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(O.Z,{className:"w-8 h-8 mr-3"}),"API Configuration Management ⚡"]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsxs)(r.z,{onClick:ap,variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(F.Z,{className:"w-4 h-4 mr-2"}),"Refresh \uD83D\uDD04"]}),(0,t.jsxs)(r.z,{onClick:()=>{eD(null),e_(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 mr-2"}),"Add API Config ➕"]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,t.jsx)(r.z,{onClick:()=>ew("image_generation"),variant:"image_generation"===eN?"default":"outline",className:"rounded-xl font-black",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Image Generation \uD83C\uDFA8"}),(0,t.jsx)(r.z,{onClick:()=>ew("video_generation"),variant:"video_generation"===eN?"default":"outline",className:"rounded-xl font-black",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Video Generation \uD83C\uDFAC"})]})]}),(0,t.jsx)(i.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[!eP&&ej&&Array.isArray(ej)&&ej.filter(e=>e.type===eN).map((e,a)=>(0,t.jsx)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"p-4 border-2 border-[#8b7355] rounded-xl bg-[#f5f1e8]/30 hover:bg-[#f5f1e8]/50 transition-all",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("h3",{className:"text-xl font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e.name}),(0,t.jsx)(o.C,{className:"".concat(e.is_default?"bg-[#d4a574]":"bg-[#8b7355]"," text-white font-bold"),children:e.is_default?"默认":"优先级 ".concat(e.priority)}),(0,t.jsx)(o.C,{className:"".concat(e.is_active?"bg-green-500":"bg-red-500"," text-white font-bold"),children:e.is_active?"启用":"禁用"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Provider:"}),(0,t.jsx)("p",{className:"text-[#2d3e2d]",children:e.provider})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Model:"}),(0,t.jsx)("p",{className:"text-[#2d3e2d]",children:e.model||"None"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Success Rate:"}),(0,t.jsxs)("p",{className:"text-[#2d3e2d]",children:[e.success_count+e.error_count>0?Math.round(e.success_count/(e.success_count+e.error_count)*100):0,"% (",e.success_count,"/",e.success_count+e.error_count,")"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Last Used:"}),(0,t.jsx)("p",{className:"text-[#2d3e2d]",children:e.last_used_at?new Date(e.last_used_at).toLocaleDateString():"Never"})]})]}),e.last_error_message&&(0,t.jsxs)("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg",children:[(0,t.jsx)("span",{className:"font-bold text-red-600",children:"Last Error:"}),(0,t.jsx)("p",{className:"text-red-700 text-sm",children:e.last_error_message})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",onClick:()=>{eD(e),e_(!0)},title:"Edit API Configuration",children:(0,t.jsx)(R.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-blue-500 hover:text-blue-700",onClick:async a=>{a.preventDefault(),confirm("Are you sure you want to copy this API configuration?")&&await aE(e)},title:"Copy API Configuration",children:(0,t.jsx)(Y.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:async a=>{if(a.preventDefault(),confirm("Are you sure you want to delete this API configuration?"))try{let a=await fetch("/api/admin/api-configs/".concat(e.id),{method:"DELETE"});if(a.ok)await ap();else{let e=await a.json().catch(()=>({error:"Unknown error"}));alert(e.error||"Failed to delete API configuration")}}catch(a){console.error("Error deleting API config:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Failed to delete API configuration: ".concat(e))}},title:"Delete API Configuration",children:(0,t.jsx)(T.Z,{className:"w-4 h-4"})})]})]})},e.id)),eP&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg font-black text-[#8b7355]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Loading API configurations... \uD83D\uDD04"})]}),!eP&&ej&&Array.isArray(ej)&&0===ej.filter(e=>e.type===eN).length&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("p",{className:"text-xl font-black text-[#8b7355] mb-4",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:["No ","image_generation"===eN?"Image":"Video"," Generation APIs configured yet! \uD83D\uDE80"]}),(0,t.jsx)("p",{className:"text-[#8b7355] mb-4",children:"Add your first API configuration to start generating amazing content."}),(0,t.jsxs)(r.z,{onClick:()=>{eD(null),e_(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 mr-2"}),"Add Your First API Config ✨"]})]})]})})]})})}),"admin"===er&&(0,t.jsx)(n.nU,{value:"styles",className:"space-y-6",children:(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:eM?(0,t.jsx)(eu,{style:eq,onSave:async e=>{try{let a=eq?"/api/admin/styles/".concat(eq.id):"/api/admin/styles",s=await fetch(a,{method:eq?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok)await ag(),eJ(!1),eV(null),alert(eq?"✅ Style updated successfully!":"✅ Style created successfully!");else{let e=await s.json().catch(()=>({error:"Unknown error"}));alert("❌ Failed to ".concat(eq?"update":"create"," style: ").concat(e.error||"Unknown error"))}}catch(a){console.error("Error saving style:",a);let e=a instanceof Error?a.message:"Unknown error";alert("❌ Failed to ".concat(eq?"update":"create"," style: ").concat(e))}},onCancel:()=>{eJ(!1),eV(null)},isLoading:!1}):(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(G.Z,{className:"w-8 h-8 mr-3"}),"Style Management \uD83C\uDFAD"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(r.z,{onClick:async()=>{let e=await fetch("/api/admin/styles/fix-templates"),a=await e.json();if(a.problematicCount>0){if(confirm("发现 ".concat(a.problematicCount," 个风格缺少 {prompt} 占位符。是否自动修复？"))){let e=await fetch("/api/admin/styles/fix-templates",{method:"POST"}),a=await e.json();a.success?(alert("✅ 成功修复了 ".concat(a.fixedCount," 个风格模板！")),ag()):alert("❌ 修复失败: ".concat(a.error))}}else alert("✅ 所有风格模板都正常，包含 {prompt} 占位符！")},className:"bg-orange-500 hover:bg-orange-600 text-white font-black px-4 py-2 rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Q.Z,{className:"w-4 h-4 mr-1"}),"Fix Templates"]}),(0,t.jsxs)(r.z,{onClick:()=>{console.log("\uD83D\uDD04 Manual refresh triggered"),ag()},variant:"outline",size:"sm",className:"border-[#8b7355] text-[#8b7355] hover:bg-[#8b7355] hover:text-white font-black rounded-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},disabled:eU,children:[(0,t.jsx)(F.Z,{className:"w-4 h-4 mr-1"}),"Refresh"]}),(0,t.jsxs)(r.z,{onClick:()=>{eV(null),eJ(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 mr-2"}),"Add Style ✨"]})]})]})}),(0,t.jsx)(i.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[!eU&&ez&&Array.isArray(ez)&&ez.map((e,a)=>(0,t.jsx)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"p-4 border-2 border-[#8b7355] rounded-xl bg-[#f5f1e8]/30 hover:bg-[#f5f1e8]/50 transition-all",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:e.image_url?(0,t.jsx)("img",{src:e.image_url,alt:e.name,className:"w-16 h-16 object-cover rounded-xl border-2 border-[#8b7355]"}):(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-[#8b7355] to-[#2d3e2d] rounded-xl flex items-center justify-center text-2xl",children:e.emoji||"\uD83C\uDFA8"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsxs)("h3",{className:"text-xl font-black text-[#2d3e2d]",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[e.emoji," ",e.name]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(o.C,{variant:"outline",className:"text-xs",children:e.type}),(0,t.jsx)(o.C,{variant:"outline",className:"text-xs",children:e.category}),e.is_premium&&(0,t.jsx)(o.C,{className:"text-xs bg-[#d4a574] text-[#2d3e2d]",children:"Premium"}),(0,t.jsx)(o.C,{className:"text-xs ".concat(e.is_active?"bg-green-500":"bg-red-500"," text-white"),children:e.is_active?"Active":"Inactive"})]})]}),(0,t.jsx)("p",{className:"text-[#8b7355] font-bold text-sm mb-2",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:e.description}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,t.jsx)("strong",{children:"Prompt Template:"})," ",e.prompt_template&&e.prompt_template.length>100?e.prompt_template.substring(0,100)+"...":e.prompt_template||"No template"]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",onClick:()=>{eV(e),eJ(!0)},children:(0,t.jsx)(R.Z,{className:"w-4 h-4"})}),(0,t.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:async a=>{if(a.preventDefault(),confirm("Are you sure you want to delete this style?"))try{let a=await fetch("/api/admin/styles/".concat(e.id),{method:"DELETE"});if(a.ok)await ag();else{let e=await a.json().catch(()=>({error:"Unknown error"}));alert(e.error||"Failed to delete style")}}catch(a){console.error("Error deleting style:",a);let e=a instanceof Error?a.message:"Unknown error";alert("Failed to delete style: ".concat(e))}},children:(0,t.jsx)(T.Z,{className:"w-4 h-4"})})]})]})},e.id)),eU&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg font-black text-[#8b7355] mb-2",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Loading styles... \uD83D\uDD04"}),(0,t.jsx)("p",{className:"text-sm text-[#8b7355] opacity-75",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"This may take a few seconds..."}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("p",{className:"text-xs text-gray-500",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"If loading takes too long, try refreshing the page"})})]}),!eU&&eT&&ez&&Array.isArray(ez)&&0===ez.length&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-xl font-black text-[#8b7355] mb-4",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"No styles configured yet! \uD83C\uDFA8"}),(0,t.jsx)("p",{className:"text-[#8b7355] mb-6",children:"Create your first style to get started."}),(0,t.jsxs)(r.z,{onClick:()=>{eV(null),eJ(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black px-6 py-3 rounded-2xl transform hover:scale-105 transition-all text-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(Z.Z,{className:"w-5 h-5 mr-2"}),"Add Your First Style ✨"]})]})]})})]})})}),"admin"===er&&(0,t.jsx)(n.nU,{value:"payment",className:"space-y-6",children:(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#2d3e2d] rounded-2xl shadow-lg",children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(S.Z,{className:"w-8 h-8 mr-3"}),"Payment System Management \uD83D\uDCB3"]}),(0,t.jsx)(i.SZ,{className:"text-[#8b7355] text-lg",children:"管理支付提供商、订阅计划和交易配置"})]}),(0,t.jsx)(i.aY,{className:"space-y-6",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(S.Z,{className:"w-16 h-16 text-[#d4a574] mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-2xl font-black text-[#2d3e2d] mb-2",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Payment Configuration Required \uD83D\uDD27"}),(0,t.jsx)("p",{className:"text-[#8b7355] mb-6",children:"Configure your payment providers and subscription plans to enable payment processing."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(r.z,{onClick:()=>{window.open("/admin/payment","_blank")},className:"w-full bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black px-6 py-4 rounded-2xl transform hover:scale-105 transition-all text-lg",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(S.Z,{className:"w-5 h-5 mr-2"}),"Open Payment Management \uD83D\uDE80"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)(i.Zb,{className:"border-2 border-[#8b7355] rounded-xl p-4",children:[(0,t.jsx)("h4",{className:"font-bold text-[#2d3e2d] mb-2",children:"\uD83D\uDCCB Setup Steps:"}),(0,t.jsxs)("ul",{className:"text-sm text-[#8b7355] space-y-1 text-left",children:[(0,t.jsx)("li",{children:"• Configure database migration"}),(0,t.jsx)("li",{children:"• Add payment providers (Stripe/PayPal)"}),(0,t.jsx)("li",{children:"• Create subscription plans"}),(0,t.jsx)("li",{children:"• Test payment integration"})]})]}),(0,t.jsxs)(i.Zb,{className:"border-2 border-[#d4a574] rounded-xl p-4",children:[(0,t.jsx)("h4",{className:"font-bold text-[#2d3e2d] mb-2",children:"\uD83D\uDD12 Security Features:"}),(0,t.jsxs)("ul",{className:"text-sm text-[#8b7355] space-y-1 text-left",children:[(0,t.jsx)("li",{children:"• Amount tampering prevention"}),(0,t.jsx)("li",{children:"• Webhook signature verification"}),(0,t.jsx)("li",{children:"• Encrypted payment sessions"}),(0,t.jsx)("li",{children:"• Audit logging"})]})]})]})]})]})})]})})}),(0,t.jsx)(n.nU,{value:"settings",className:"space-y-6",children:(0,t.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,t.jsxs)(i.Zb,{className:"bg-white border-4 border-[#2d3e2d] rounded-2xl shadow-lg",children:[(0,t.jsxs)(i.Ol,{children:[(0,t.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(I.Z,{className:"w-8 h-8 mr-3"}),"Settings & Quick Actions ⚙️"]}),(0,t.jsx)(i.SZ,{className:"text-[#8b7355] text-lg",children:"Manage your account and access platform features"})]}),(0,t.jsxs)(i.aY,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["admin"===er&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.z,{onClick:()=>window.open("/admin/payment","_blank"),className:"w-full bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(S.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"Payment Management"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"Configure payment providers"})]}),(0,t.jsxs)(r.z,{onClick:()=>el("api-configs"),className:"w-full bg-[#8b7355] hover:bg-[#6d5a42] text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(O.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"API Configurations"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"Manage AI service providers"})]}),(0,t.jsxs)(r.z,{onClick:()=>el("styles"),className:"w-full bg-[#2d3e2d] hover:bg-[#1a2a1a] text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(G.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"Style Management"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"Create and edit art styles"})]}),(0,t.jsxs)(r.z,{onClick:()=>window.open("/admin/magic-coins","_blank"),className:"w-full bg-yellow-500 hover:bg-yellow-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(K.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"Magic Coins"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"Manage magic coin system"})]}),(0,t.jsxs)(r.z,{onClick:()=>el("users"),className:"w-full bg-green-500 hover:bg-green-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(A.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"User Management"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"View and manage users"})]}),(0,t.jsxs)(r.z,{onClick:()=>el("images"),className:"w-full bg-purple-500 hover:bg-purple-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(D.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"Image Gallery"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"Browse all user images"})]})]}),(0,t.jsxs)(r.z,{onClick:()=>el("overview"),className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(F.Z,{className:"w-8 h-8 mb-2"}),(0,t.jsx)("span",{children:"Dashboard Overview"}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:"View platform statistics"})]})]}),(0,t.jsxs)("div",{className:"border-t-2 border-[#8b7355] pt-6",children:[(0,t.jsx)("h4",{className:"text-xl font-black text-[#2d3e2d] mb-4",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Account Actions \uD83D\uDC64"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)(r.z,{onClick:av,className:"w-full bg-red-500 hover:bg-red-600 text-white font-black rounded-2xl p-3",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Sign Out \uD83D\uDEAA"]}),(0,t.jsxs)(r.z,{onClick:()=>window.open("/","_blank"),className:"w-full bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl p-3",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:[(0,t.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"View Main Site \uD83C\uDF10"]})]})]}),(0,t.jsxs)("div",{className:"border-t-2 border-[#8b7355] pt-6",children:[(0,t.jsx)("h4",{className:"text-xl font-black text-[#2d3e2d] mb-4",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"System Information ℹ️"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"bg-[#f5f1e8] p-4 rounded-xl border border-[#8b7355]",children:[(0,t.jsx)("div",{className:"font-bold text-[#2d3e2d] mb-2",children:"Account Details"}),(0,t.jsxs)("div",{className:"text-[#8b7355] space-y-1",children:[(0,t.jsxs)("div",{children:["Email: ",(null==ah?void 0:null===(es=ah.user)||void 0===es?void 0:es.email)||"Not available"]}),(0,t.jsxs)("div",{children:["Role: ","admin"===er?"Administrator \uD83D\uDC51":"User \uD83D\uDC64"]}),(0,t.jsxs)("div",{children:["Status: ",ah?"Authenticated ✅":"Not logged in ❌"]})]})]}),(0,t.jsxs)("div",{className:"bg-[#f5f1e8] p-4 rounded-xl border border-[#8b7355]",children:[(0,t.jsx)("div",{className:"font-bold text-[#2d3e2d] mb-2",children:"Platform Stats"}),(0,t.jsxs)("div",{className:"text-[#8b7355] space-y-1",children:[(0,t.jsxs)("div",{children:["Total Users: ",ex.totalUsers]}),(0,t.jsxs)("div",{children:["Total Images: ",ex.totalImages]}),(0,t.jsxs)("div",{children:["Revenue: $",ex.revenue]})]})]})]})]})]})]})})})]})]}),(0,t.jsx)(eh,{})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#f5f1e8] via-[#e8dcc0] to-[#d4a574] flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-[#2d3e2d] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-[#2d3e2d] font-bold",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Loading magical dashboard... ✨"})]})})}function ep(){return(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#f5f1e8] to-[#ede7d3] flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-[#d4a574] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-[#2d3e2d] font-black text-xl",style:{fontFamily:"Fredoka One, Arial Black, sans-serif"},children:"Loading Admin Dashboard... ⚡"})]})}),children:(0,t.jsx)(ef,{})})}s(62420)},24698:function(e,a,s){"use strict";s.d(a,{default:function(){return x},lh:function(){return m},dr:function(){return c},VF:function(){return d}});var t=s(18376),l=s(57894),r=(s(38269),s(98130));function i(e){let{children:a,...s}=e;return(0,t.jsx)(r.f,{...s,children:a})}let n=(0,l.createContext)({data:null,status:"unauthenticated",update:async()=>null});function o(e){let{children:a}=e;return(0,t.jsx)(n.Provider,{value:{data:null,status:"unauthenticated",update:async()=>null},children:a})}function d(){{let[e,a]=l.useState({data:null,status:"loading",update:async()=>null});return l.useEffect(()=>{!function(){let e=new URLSearchParams(window.location.search),a=e.get("login"),s=e.get("error");if("success"===a){let e=window.location.pathname;window.history.replaceState({},"",e),window.location.reload()}else if(s){console.error("登录错误:",s),alert("登录失败: ".concat(s));let e=window.location.pathname;window.history.replaceState({},"",e)}}();let e=function(){try{let e=document.cookie.split(";").find(e=>e.trim().startsWith("user-info="));if(!e)return null;let a=e.split("=")[1];return JSON.parse(decodeURIComponent(atob(a).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(e){return console.error("获取用户信息失败:",e),null}}();e?a({data:{user:e},status:"authenticated",update:async()=>null}):a({data:null,status:"unauthenticated",update:async()=>null})},[]),e}}async function c(e){window.location.href="/auth/logout"}async function m(e,a){window.location.href="/auth/google"}function x(e){let{children:a}=e;return(0,t.jsx)(o,{children:(0,t.jsx)(i,{attribute:"class",defaultTheme:"dark",enableSystem:!1,disableTransitionOnChange:!0,storageKey:void 0,children:a})})}},46859:function(e,a,s){"use strict";s.d(a,{C:function(){return n}});var t=s(18376);s(57894);var l=s(30330),r=s(58755);let i=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:a,variant:s,...l}=e;return(0,t.jsx)("div",{className:(0,r.cn)(i({variant:s}),a),...l})}},65354:function(e,a,s){"use strict";s.d(a,{z:function(){return d}});var t=s(18376),l=s(57894),r=s(7116),i=s(30330),n=s(58755);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,a)=>{let{className:s,variant:l,size:i,asChild:d=!1,...c}=e,m=d?r.g7:"button";return(0,t.jsx)(m,{className:(0,n.cn)(o({variant:l,size:i,className:s})),ref:a,...c})});d.displayName="Button"},95801:function(e,a,s){"use strict";s.d(a,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return o}});var t=s(18376),l=s(57894),r=s(58755);let i=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...l})});i.displayName="Card";let n=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...l})});n.displayName="CardHeader";let o=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...l})});o.displayName="CardTitle";let d=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",s),...l})});d.displayName="CardDescription";let c=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",s),...l})});c.displayName="CardContent",l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",s),...l})}).displayName="CardFooter"},31554:function(e,a,s){"use strict";s.d(a,{I:function(){return i}});var t=s(18376),l=s(57894),r=s(58755);let i=l.forwardRef((e,a)=>{let{className:s,type:l,...i}=e;return(0,t.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...i})});i.displayName="Input"},41775:function(e,a,s){"use strict";s.d(a,{_:function(){return d}});var t=s(18376),l=s(57894),r=s(77639),i=s(30330),n=s(58755);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.f,{ref:a,className:(0,n.cn)(o(),s),...l})});d.displayName=r.f.displayName},82878:function(e,a,s){"use strict";s.d(a,{Bw:function(){return f},Ph:function(){return c},Ql:function(){return p},i4:function(){return x},ki:function(){return m}});var t=s(18376),l=s(57894),r=s(74386),i=s(96889),n=s(78172),o=s(6772),d=s(58755);let c=r.fC;r.ZA;let m=r.B4,x=l.forwardRef((e,a)=>{let{className:s,children:l,...n}=e;return(0,t.jsxs)(r.xz,{ref:a,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[l,(0,t.jsx)(r.JO,{asChild:!0,children:(0,t.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=r.xz.displayName;let u=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.u_,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});u.displayName=r.u_.displayName;let h=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.$G,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});h.displayName=r.$G.displayName;let f=l.forwardRef((e,a)=>{let{className:s,children:l,position:i="popper",...n}=e;return(0,t.jsx)(r.h_,{children:(0,t.jsxs)(r.VY,{ref:a,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...n,children:[(0,t.jsx)(u,{}),(0,t.jsx)(r.l_,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,t.jsx)(h,{})]})})});f.displayName=r.VY.displayName,l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.__,{ref:a,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...l})}).displayName=r.__.displayName;let p=l.forwardRef((e,a)=>{let{className:s,children:l,...i}=e;return(0,t.jsxs)(r.ck,{ref:a,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.wU,{children:(0,t.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(r.eT,{children:l})]})});p.displayName=r.ck.displayName,l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.Z0,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",s),...l})}).displayName=r.Z0.displayName},36419:function(e,a,s){"use strict";s.d(a,{i:function(){return n}});var t=s(18376),l=s(57894),r=s(26696),i=s(58755);let n=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsxs)(r.fC,{ref:a,className:(0,i.cn)("relative flex w-full touch-none select-none items-center",s),...l,children:[(0,t.jsx)(r.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,t.jsx)(r.e6,{className:"absolute h-full bg-primary"})}),(0,t.jsx)(r.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});n.displayName=r.fC.displayName},44911:function(e,a,s){"use strict";s.d(a,{r:function(){return n}});var t=s(18376),l=s(57894),r=s(17162),i=s(58755);let n=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...l,ref:a,children:(0,t.jsx)(r.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});n.displayName=r.fC.displayName},92392:function(e,a,s){"use strict";s.d(a,{SP:function(){return d},dr:function(){return o},mQ:function(){return n},nU:function(){return c}});var t=s(18376),l=s(57894),r=s(28048),i=s(58755);let n=r.fC,o=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.aV,{ref:a,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...l})});o.displayName=r.aV.displayName;let d=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.xz,{ref:a,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...l})});d.displayName=r.xz.displayName;let c=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.VY,{ref:a,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...l})});c.displayName=r.VY.displayName},53922:function(e,a,s){"use strict";s.d(a,{g:function(){return i}});var t=s(18376),l=s(57894),r=s(58755);let i=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...l})});i.displayName="Textarea"},58755:function(e,a,s){"use strict";s.d(a,{cn:function(){return r}});var t=s(4941),l=s(48244);function r(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,l.m6)((0,t.W)(a))}}},function(e){e.O(0,[8166,7198,2593,8048,5159,8176,6860,7345,2437,8922,5996,1744],function(){return e(e.s=68628)}),_N_E=e.O()}]);