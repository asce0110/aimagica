(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{68628:function(e,s,t){Promise.resolve().then(t.bind(t,83581))},83581:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ep}});var a=t(18376),l=t(57894),r=t(65354),i=t(95801),n=t(92392),o=t(46859),c=t(7053),d=t(27346),m=t(34200),u=t(13249),x=t(55859),h=t(287),f=t(39371),p=t(41595),g=t(37316),b=t(64238),v=t(71883),y=t(43782),j=t(25418),N=t(96823),w=t(66660),S=t(618),C=t(46047),_=t(27847),D=t(52609),k=t(50909),F=t(77456),M=t(84349),A=t(19892),I=t(4738),P=t(95908),E=t(36288),z=t(84207),Z=t(42857),U=t(37929),R=t(96433),O=t(16270),T=t(95520),L=t(79170),q=t(38049),J=t(98468),V=t(74010),B=t(12513),Y=t(11948),G=t(9978),Q=t(22469),K=t(54685),W=t(65538),H=t(16860),$=t(31554),X=t(41775),ee=t(82878),es=t(44911),et=t(53922),ea=t(79914),el=t(6479),er=t(87824);function ei(e){let{config:s,onSave:t,onCancel:n,isLoading:o}=e,c=s?"api-config-edit-".concat(s.id):"api-config-new",d=(0,l.useRef)(!1),[m,u]=(0,l.useState)(()=>{{let e=localStorage.getItem(c);if(e)try{let s=JSON.parse(e);return console.log("\uD83D\uDCE5 恢复已保存的编辑数据:",s.timestamp),d.current=!0,s.formData}catch(e){console.warn("❌ 无法解析保存的数据，使用默认值")}}return{name:(null==s?void 0:s.name)||"",type:(null==s?void 0:s.type)||"image_generation",provider:(null==s?void 0:s.provider)||"",base_url:(null==s?void 0:s.base_url)||"",api_key:(null==s?void 0:s.api_key)||"",model:(null==s?void 0:s.model)||"",endpoint:(null==s?void 0:s.endpoint)||"",priority:(null==s?void 0:s.priority)||0,is_default:(null==s?void 0:s.is_default)||!1,is_active:(null==s?void 0:s.is_active)!==!1,max_retries:(null==s?void 0:s.max_retries)||3,timeout_seconds:(null==s?void 0:s.timeout_seconds)||60,rate_limit_per_minute:(null==s?void 0:s.rate_limit_per_minute)||60,config_data:(null==s?void 0:s.config_data)||{}}}),[x,h]=(0,l.useState)(!1),[f,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(null),[v,y]=(0,l.useState)(()=>{{let e=localStorage.getItem(c);if(e)try{return JSON.parse(e).configDataText||JSON.stringify((null==s?void 0:s.config_data)||{},null,2)}catch(e){console.warn("❌ 无法解析保存的配置数据文本")}}return JSON.stringify((null==s?void 0:s.config_data)||{},null,2)}),j=()=>{try{{let e={formData:m,configDataText:v,timestamp:new Date().toISOString()};localStorage.setItem(c,JSON.stringify(e)),d.current=!0,p(!0),console.log("\uD83D\uDCBE 自动保存编辑数据")}}catch(e){console.error("自动保存失败:",e)}},N=()=>{try{localStorage.removeItem(c),d.current=!1,p(!1),console.log("\uD83D\uDDD1️ 清除保存的编辑数据")}catch(e){console.error("清除保存数据失败:",e)}};(0,l.useEffect)(()=>{let e=setTimeout(()=>{try{j()}catch(e){console.error("定时自动保存失败:",e)}},1e3);return()=>clearTimeout(e)},[m,v]),(0,l.useEffect)(()=>{let e=e=>{if(d.current)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?","You have unsaved changes. Are you sure you want to leave?"},s=()=>{try{"hidden"===document.visibilityState&&d.current&&(j(),console.log("\uD83D\uDCE4 页面隐藏时自动保存"))}catch(e){console.error("页面隐藏时自动保存失败:",e)}};return window.addEventListener("beforeunload",e),document.addEventListener("visibilitychange",s),()=>{window.removeEventListener("beforeunload",e),document.removeEventListener("visibilitychange",s)}},[]),(0,l.useEffect)(()=>{d.current&&(p(!0),console.log("✨ 检测到未保存的编辑数据已自动恢复")),_(v)},[]);let w=async e=>{e.preventDefault();try{let e={};if(v.trim())try{e=JSON.parse(v)}catch(s){console.error("JSON解析错误:",s),console.error("待解析的文本:",v);let e=s instanceof Error?s.message:"Unknown JSON error";alert("❌ JSON格式错误!\n\n错误详情: ".concat(e,"\n\n请检查配置数据的JSON格式是否正确。\n\n提示:\n- 确保所有引号都是英文引号\n- 确保没有多余的逗号\n- 确保大括号和方括号配对正确"));return}await t({...m,config_data:e}),N()}catch(e){console.error("保存配置错误:",e),alert("❌ 保存失败!\n\n错误详情: ".concat(e instanceof Error?e.message:"Unknown error"))}},S=()=>{if(d.current){if(!confirm("You have unsaved changes. Are you sure you want to discard them?"))return;N()}n()},C={OpenAI:{base_url:"https://api.openai.com/v1",endpoint:"/images/generations",model:"dall-e-3",config_data:{quality:"standard",size:"1024x1024",style:"vivid"}},"Stability AI":{base_url:"https://api.stability.ai/v1",endpoint:"/generation/stable-diffusion-xl-1024-v1-0/text-to-image",model:"stable-diffusion-xl-1024-v1-0",config_data:{samples:1,steps:30,cfg_scale:7}},Replicate:{base_url:"https://api.replicate.com/v1",endpoint:"/predictions",model:"stability-ai/sdxl",config_data:{width:1024,height:1024,num_outputs:1}},Runway:{base_url:"https://api.runwayml.com/v1",endpoint:"/generate",model:"gen2",config_data:{duration:4,seed:0,upscale:!1}},"Kie.ai Pro":{base_url:"https://api.kie.ai",endpoint:"/api/v1/flux/kontext/generate",model:"flux-kontext-pro",config_data:{aspectRatios:{"21:9":"21:9","16:9":"16:9","4:3":"4:3","1:1":"1:1","3:4":"3:4","9:16":"9:16","16:21":"16:21"},supportedModes:["text_to_image","image_edit"],promptLanguage:"en",description:"Standard Flux Kontext model for most use cases"}},"Kie.ai Max":{base_url:"https://api.kie.ai",endpoint:"/api/v1/flux/kontext/generate",model:"flux-kontext-max",config_data:{aspectRatios:{"21:9":"21:9","16:9":"16:9","4:3":"4:3","1:1":"1:1","3:4":"3:4","9:16":"9:16","16:21":"16:21"},supportedModes:["text_to_image","image_edit"],promptLanguage:"en",description:"Enhanced Flux Kontext model for complex scenarios"}}},_=e=>{if(!e.trim())return b(null),!0;try{return JSON.parse(e),b(null),!0}catch(e){return b(e instanceof Error?e.message:"Invalid JSON"),!1}},D=e=>{y(e),_(e)};return(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(U.Z,{className:"w-6 h-6 mr-2"}),s?"Edit API Configuration \uD83D\uDD27":"Add New API Configuration ⚡"]}),(0,a.jsx)(i.SZ,{className:"text-[#8b7355] font-bold",children:"Configure AI generation APIs with automatic failover support"})]}),(0,a.jsx)(r.z,{onClick:S,variant:"ghost",className:"text-[#8b7355] hover:text-[#2d3e2d]",children:(0,a.jsx)(ea.Z,{className:"w-4 h-4"})})]})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"name",className:"text-[#2d3e2d] font-bold",children:"Configuration Name *"}),(0,a.jsx)($.I,{id:"name",value:m.name,onChange:e=>u(s=>({...s,name:e.target.value})),placeholder:"e.g., OpenAI DALL-E 3 Primary Config",required:!0,className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"type",className:"text-[#2d3e2d] font-bold",children:"API Type *"}),(0,a.jsxs)(ee.Ph,{value:m.type,onValueChange:e=>u(s=>({...s,type:e})),children:[(0,a.jsx)(ee.i4,{className:"border-2 border-[#8b7355] rounded-xl",children:(0,a.jsx)(ee.ki,{})}),(0,a.jsxs)(ee.Bw,{children:[(0,a.jsx)(ee.Ql,{value:"image_generation",children:"Image Generation \uD83C\uDFA8"}),(0,a.jsx)(ee.Ql,{value:"video_generation",children:"Video Generation \uD83C\uDFAC"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"provider",className:"text-[#2d3e2d] font-bold",children:"Provider *"}),(0,a.jsxs)(ee.Ph,{value:m.provider,onValueChange:e=>{u(s=>({...s,provider:e}));let s=C[e];if(s){u(e=>({...e,base_url:s.base_url,endpoint:s.endpoint,model:s.model}));let e=JSON.stringify(s.config_data,null,2);y(e),_(e)}},children:[(0,a.jsx)(ee.i4,{className:"border-2 border-[#8b7355] rounded-xl",children:(0,a.jsx)(ee.ki,{placeholder:"Select a provider"})}),(0,a.jsxs)(ee.Bw,{children:[(0,a.jsx)(ee.Ql,{value:"OpenAI",children:"OpenAI"}),(0,a.jsx)(ee.Ql,{value:"Stability AI",children:"Stability AI"}),(0,a.jsx)(ee.Ql,{value:"Replicate",children:"Replicate"}),(0,a.jsx)(ee.Ql,{value:"Runway",children:"Runway"}),(0,a.jsx)(ee.Ql,{value:"Kie.ai Pro",children:"Kie.ai Flux Kontext Pro"}),(0,a.jsx)(ee.Ql,{value:"Kie.ai Max",children:"Kie.ai Flux Kontext Max"}),(0,a.jsx)(ee.Ql,{value:"Pika",children:"Pika Labs"}),(0,a.jsx)(ee.Ql,{value:"Custom",children:"Custom Provider"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"priority",className:"text-[#2d3e2d] font-bold",children:"Priority (Lower = Higher Priority)"}),(0,a.jsx)($.I,{id:"priority",type:"number",value:m.priority,onChange:e=>u(s=>({...s,priority:parseInt(e.target.value)||0})),min:"0",className:"border-2 border-[#8b7355] rounded-xl"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"base_url",className:"text-[#2d3e2d] font-bold",children:"Base URL *"}),(0,a.jsx)($.I,{id:"base_url",value:m.base_url,onChange:e=>u(s=>({...s,base_url:e.target.value})),placeholder:"https://api.openai.com/v1",required:!0,className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"endpoint",className:"text-[#2d3e2d] font-bold",children:"Endpoint Path"}),(0,a.jsx)($.I,{id:"endpoint",value:m.endpoint,onChange:e=>u(s=>({...s,endpoint:e.target.value})),placeholder:"/images/generations",className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"api_key",className:"text-[#2d3e2d] font-bold",children:"API Key *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)($.I,{id:"api_key",type:x?"text":"password",value:m.api_key,onChange:e=>u(s=>({...s,api_key:e.target.value})),placeholder:"Enter your API key here",required:!0,className:"border-2 border-[#8b7355] rounded-xl pr-10"}),(0,a.jsx)(r.z,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2",onClick:()=>h(!x),children:x?(0,a.jsx)(el.Z,{className:"w-4 h-4"}):(0,a.jsx)(R.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"model",className:"text-[#2d3e2d] font-bold",children:"Model Name"}),(0,a.jsx)($.I,{id:"model",value:m.model,onChange:e=>u(s=>({...s,model:e.target.value})),placeholder:"dall-e-3",className:"border-2 border-[#8b7355] rounded-xl"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"max_retries",className:"text-[#2d3e2d] font-bold",children:"Max Retries"}),(0,a.jsx)($.I,{id:"max_retries",type:"number",value:m.max_retries,onChange:e=>u(s=>({...s,max_retries:parseInt(e.target.value)||3})),min:"0",max:"10",className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"timeout_seconds",className:"text-[#2d3e2d] font-bold",children:"Timeout (seconds)"}),(0,a.jsx)($.I,{id:"timeout_seconds",type:"number",value:m.timeout_seconds,onChange:e=>u(s=>({...s,timeout_seconds:parseInt(e.target.value)||60})),min:"10",max:"300",className:"border-2 border-[#8b7355] rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(X._,{htmlFor:"rate_limit",className:"text-[#2d3e2d] font-bold",children:"Rate Limit (per minute)"}),(0,a.jsx)($.I,{id:"rate_limit",type:"number",value:m.rate_limit_per_minute,onChange:e=>u(s=>({...s,rate_limit_per_minute:parseInt(e.target.value)||60})),min:"1",className:"border-2 border-[#8b7355] rounded-xl"})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(es.r,{checked:m.is_active,onCheckedChange:e=>u(s=>({...s,is_active:e}))}),(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold",children:"Active"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(es.r,{checked:m.is_default,onCheckedChange:e=>u(s=>({...s,is_default:e}))}),(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold",children:"Set as Default"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(X._,{htmlFor:"config_data",className:"text-[#2d3e2d] font-bold",children:["Additional Configuration (JSON)",g&&(0,a.jsx)("span",{className:"text-red-500 ml-2 text-sm",children:"❌ Invalid JSON"})]}),(0,a.jsx)(r.z,{type:"button",onClick:e=>{e.preventDefault();try{let e=JSON.parse(v),s=JSON.stringify(e,null,2);y(s),_(s)}catch(e){console.error("格式化JSON失败:",e),alert("无法格式化JSON，请先修复语法错误")}},variant:"outline",size:"sm",className:"text-xs px-2 py-1 h-6",disabled:!!g,children:"Format JSON"})]}),(0,a.jsx)(et.g,{id:"config_data",value:v,onChange:e=>D(e.target.value),placeholder:'{"quality": "standard", "size": "1024x1024"}',rows:8,className:"border-2 rounded-xl font-mono text-sm ".concat(g?"border-red-500 bg-red-50":"border-[#8b7355]")}),g&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"text-red-500 text-lg",children:"❌"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-700 font-bold text-sm",children:"JSON格式错误"}),(0,a.jsx)("p",{className:"text-red-600 text-xs mt-1",children:g}),(0,a.jsxs)("div",{className:"text-red-600 text-xs mt-2",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"常见问题："})}),(0,a.jsx)("p",{children:'• 确保使用英文引号 " 而不是中文引号 " "'}),(0,a.jsx)("p",{children:"• 检查是否有多余的逗号"}),(0,a.jsxs)("p",{children:["• 确保大括号 "," 配对正确"]})]})]})]})}),(0,a.jsxs)("div",{className:"text-xs text-[#8b7355] space-y-1",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Common image sizes:"})}),(0,a.jsx)("p",{children:'• 1:1 → "1024x1024" (Square)'}),(0,a.jsx)("p",{children:'• 2:3 → "1024x1536" (Portrait)'}),(0,a.jsx)("p",{children:'• 3:2 → "1536x1024" (Landscape)'}),(0,a.jsx)("p",{children:'• 16:9 → "1792x1024" (Widescreen)'}),(0,a.jsx)("p",{children:'Note: KIE.AI uses ratios like "1:1", others use pixels'})]})]}),f&&(0,a.jsxs)("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-yellow-700 font-bold text-sm",children:"\uD83D\uDCDD Unsaved draft detected and automatically restored"})]}),(0,a.jsx)(r.z,{type:"button",onClick:()=>{confirm("Are you sure you want to clear the draft data? This will restore to the original state.")&&(N(),window.location.reload())},variant:"ghost",size:"sm",className:"text-yellow-600 hover:text-yellow-800 text-xs",children:"Clear Draft"})]}),(0,a.jsx)("p",{className:"text-yellow-600 text-xs mt-1",children:"Your edits are automatically saved, even when switching tabs ✨"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)(r.z,{type:"button",onClick:S,variant:"outline",className:"border-2 border-[#8b7355] text-[#8b7355] hover:bg-[#8b7355] hover:text-white rounded-xl",children:"Cancel"}),(0,a.jsxs)(r.z,{type:"submit",disabled:o||!!g,className:"bg-[#4a5a4a] hover:bg-[#5a6a5a] text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(er.Z,{className:"w-4 h-4 mr-2"}),o?"Saving...":s?"Update Configuration":"Create Configuration",g&&" (Fix JSON first)"]})]})]})})]})}var en=t(25556),eo=t(77305);t(24806);var ec=t(36419),ed=t(99517),em=t(4036);function eu(e){let{onCropComplete:s,onCancel:t,maxWidth:n=512,maxHeight:o=512,aspectRatio:c=1,className:d,styleName:m}=e,[u,x]=(0,l.useState)(""),[h,f]=(0,l.useState)({unit:"%",width:80,height:80,x:10,y:10}),[p,g]=(0,l.useState)(),[b,v]=(0,l.useState)([100]),[y,j]=(0,l.useState)(0),N=(0,l.useRef)(null),w=(0,l.useRef)(null),S=(0,l.useRef)(null),C=(0,l.useRef)(""),_=(0,l.useCallback)(e=>{c&&f({unit:"%",width:80,height:80,x:10,y:10})},[c]),D=(0,l.useCallback)(async(e,s,t,a)=>{let l=w.current;if(!l||!s||0===s.width||0===s.height)return;l.width=200,l.height=200;let r=l.getContext("2d");if(!r)return;r.clearRect(0,0,200,200),r.imageSmoothingQuality="high";let i=e.naturalWidth/e.width,n=e.naturalHeight/e.height,o=s.x*i,c=s.y*n,d=s.width*i,m=s.height*n;0!==a&&(r.save(),r.translate(100,100),r.rotate(a*Math.PI/180),r.translate(-100,-100)),r.drawImage(e,o,c,d,m,0,0,200,200),0!==a&&r.restore();try{l.toBlob(e=>{e&&(C.current&&URL.revokeObjectURL(C.current),C.current=URL.createObjectURL(e))},"image/jpeg",.95)}catch(e){console.error("生成预览失败:",e)}},[]),k=(0,l.useCallback)(e=>{g(e),N.current&&e.width&&e.height&&D(N.current,e,b[0],y)},[D,b,y]),[F,M]=(0,l.useState)(!1),A=async()=>{if(C.current)try{M(!0);let e=w.current;if(!e)throw Error("无法获取裁剪后的图片数据");let t=e.toDataURL("image/png");console.log("\uD83D\uDCF8 准备上传裁剪后的图片到R2，样式名称：".concat(m));let a=await fetch("/api/admin/upload-cropped-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:t,styleName:m||"unknown_style"})});if(!a.ok){let e=await a.json();throw Error(e.error||"上传失败")}let l=await a.json();console.log("✅ 图片上传到R2成功：".concat(l.data.r2Url)),s(l.data.r2Url)}catch(e){console.error("❌ 上传裁剪图片失败:",e),alert("上传失败: ".concat(e instanceof Error?e.message:"未知错误"))}finally{M(!1)}};return(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 ".concat(d),children:[(0,a.jsxs)(i.Zb,{className:"w-full max-w-5xl mx-4 bg-white border-4 border-[#d4a574] rounded-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(i.Ol,{className:"bg-[#d4a574] border-b-4 border-[#8b7355]",children:(0,a.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center justify-between",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(en.Z,{className:"w-6 h-6"}),"图片裁剪器 ✂️"]}),(0,a.jsx)(r.z,{onClick:t,variant:"destructive",size:"sm",className:"rounded-full",children:(0,a.jsx)(ea.Z,{className:"w-4 h-4"})})]})}),(0,a.jsx)(i.aY,{className:"p-6 space-y-6",children:u?(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:"裁剪和编辑图片"}),(0,a.jsx)("div",{className:"border-2 border-[#8b7355] rounded-xl overflow-hidden bg-gray-100",children:(0,a.jsx)(eo.ZP,{crop:h,onChange:(e,s)=>f(s),onComplete:k,aspect:c,className:"max-h-96",children:(0,a.jsx)("img",{ref:N,src:u,style:{transform:"scale(".concat(b[0]/100,") rotate(").concat(y,"deg)"),maxHeight:"400px",maxWidth:"100%"},onLoad:_,alt:"Crop preview"})})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(X._,{className:"text-[#2d3e2d] font-bold text-sm mb-2 block",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4 inline mr-1"}),"缩放: ",b[0],"%"]}),(0,a.jsx)(ec.i,{value:b,onValueChange:e=>{v(e),N.current&&p&&D(N.current,p,e[0],y)},min:50,max:200,step:10,className:"w-full"})]}),(0,a.jsx)("div",{className:"flex flex-col justify-end",children:(0,a.jsxs)(r.z,{type:"button",onClick:()=>{let e=(y+90)%360;j(e),N.current&&p&&D(N.current,p,b[0],e)},className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white font-bold rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(em.Z,{className:"w-4 h-4 mr-1"}),"旋转90\xb0"]})})]}),(0,a.jsx)(r.z,{type:"button",onClick:()=>{f({unit:"%",width:80,height:80,x:10,y:10}),v([100]),j(0)},variant:"outline",className:"w-full border-2 border-[#8b7355] text-[#8b7355] hover:bg-[#f5f1e8] font-bold rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:"重置裁剪"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:"预览效果"}),(0,a.jsxs)("div",{className:"border-2 border-[#8b7355] rounded-xl p-4 bg-white text-center",children:[(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)("p",{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"在首页中的显示效果："})}),p?(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"border-2 border-[#8b7355] bg-white rounded-lg shadow-md overflow-hidden",style:{width:"120px",height:"140px"},children:(0,a.jsxs)("div",{className:"p-2 text-center",children:[(0,a.jsx)("div",{className:"w-full aspect-square mb-1 rounded-lg overflow-hidden border-2 border-[#8b7355]/30",children:(0,a.jsx)("canvas",{ref:w,className:"w-full h-full object-cover scale-110",style:{imageRendering:"crisp-edges",filter:"contrast(1.1) brightness(1.05) saturate(1.1)"}})}),(0,a.jsx)("div",{className:"text-sm",children:"\uD83C\uDFA8"}),(0,a.jsx)("h4",{className:"text-[#2d3e2d] font-black text-xs leading-tight",style:{fontFamily:"Comic Sans MS, cursive"},children:"YOUR STYLE"})]})}),(0,a.jsx)("p",{className:"text-[#8b7355] text-xs",style:{fontFamily:"Comic Sans MS, cursive"},children:"裁剪框中的内容就是最终显示的效果"})]}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-[#8b7355]",children:(0,a.jsx)("p",{style:{fontFamily:"Comic Sans MS, cursive"},children:"调整裁剪区域查看预览"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,a.jsx)(r.z,{type:"button",onClick:A,disabled:!p||F,className:"bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"上传中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(er.Z,{className:"w-4 h-4 mr-1"}),"保存到云端"]})}),(0,a.jsxs)(r.z,{type:"button",onClick:t,variant:"outline",className:"border-2 border-red-500 text-red-500 hover:bg-red-50 font-bold rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(ea.Z,{className:"w-4 h-4 mr-1"}),"取消"]})]})]})]}):(0,a.jsxs)("div",{className:"border-2 border-dashed border-[#8b7355] rounded-xl p-8 text-center bg-[#f5f1e8]",children:[(0,a.jsx)(L.Z,{className:"w-12 h-12 text-[#8b7355] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-lg mb-2",style:{fontFamily:"Comic Sans MS, cursive"},children:"选择图片进行裁剪 \uD83D\uDCF8"}),(0,a.jsx)("p",{className:"text-[#8b7355] text-sm mb-4",children:"支持 JPEG、PNG、WebP（最大 10MB）"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;if(!t.type.startsWith("image/")){alert("请选择图片文件");return}if(t.size>10485760){alert("图片大小不能超过 10MB");return}let a=new FileReader;a.onload=()=>{x(a.result)},a.readAsDataURL(t)},className:"hidden",id:"image-upload"}),(0,a.jsx)("label",{htmlFor:"image-upload",children:(0,a.jsx)(r.z,{type:"button",className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white font-bold rounded-xl cursor-pointer",style:{fontFamily:"Comic Sans MS, cursive"},asChild:!0,children:(0,a.jsx)("span",{children:"选择图片"})})})]})})]}),(0,a.jsx)("a",{ref:S,download:!0,style:{position:"absolute",top:"-200vh",visibility:"hidden"},children:"Hidden download"})]})}function ex(e){var s;let{style:t,onSave:n,onCancel:c,isLoading:d}=e,[m,u]=(0,l.useState)({name:"",description:"",emoji:"\uD83C\uDFA8",image_url:"",prompt_template:"",default_prompt:"",type:"image",category:"photographic-realism",is_premium:!1,is_active:!0,sort_order:0,requires_image_upload:!1,requires_prompt_description:!1,prohibits_image_upload:!1,min_prompt_length:0,max_prompt_length:1e3,allowed_image_formats:["jpg","jpeg","png","webp"],requirements_description:""}),[x,h]=(0,l.useState)(""),[f,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!0),j="admin_style_form_draft";(0,l.useEffect)(()=>{let e=()=>{y(!document.hidden),document.hidden||console.log("页面重新可见，保持当前状态")};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),(0,l.useEffect)(()=>{if(t)u({name:t.name,description:t.description,emoji:t.emoji,image_url:t.image_url,prompt_template:t.prompt_template,default_prompt:t.default_prompt||"",type:t.type,category:t.category,is_premium:t.is_premium,is_active:t.is_active,sort_order:t.sort_order,requires_image_upload:t.requires_image_upload||!1,requires_prompt_description:t.requires_prompt_description||!1,prohibits_image_upload:t.prohibits_image_upload||!1,min_prompt_length:t.min_prompt_length||0,max_prompt_length:t.max_prompt_length||1e3,allowed_image_formats:t.allowed_image_formats||["jpg","jpeg","png","webp"],requirements_description:t.requirements_description||""}),h(t.image_url);else try{let e=localStorage.getItem(j);if(e){let s=JSON.parse(e);s.formData&&(u(s.formData),h(s.previewImage||""),console.log("已恢复表单草稿"))}}catch(e){console.log("加载表单草稿失败:",e)}},[]),(0,l.useEffect)(()=>{t&&(u({name:t.name,description:t.description,emoji:t.emoji,image_url:t.image_url,prompt_template:t.prompt_template,default_prompt:t.default_prompt||"",type:t.type,category:t.category,is_premium:t.is_premium,is_active:t.is_active,sort_order:t.sort_order,requires_image_upload:t.requires_image_upload||!1,requires_prompt_description:t.requires_prompt_description||!1,prohibits_image_upload:t.prohibits_image_upload||!1,min_prompt_length:t.min_prompt_length||0,max_prompt_length:t.max_prompt_length||1e3,allowed_image_formats:t.allowed_image_formats||["jpg","jpeg","png","webp"],requirements_description:t.requirements_description||""}),h(t.image_url))},[null==t?void 0:t.id]),(0,l.useEffect)(()=>{if(!t&&(m.name||m.description||m.prompt_template||x)){let e=setTimeout(()=>{try{let e={formData:m,previewImage:x,selectedFile:null,timestamp:Date.now(),version:"1.0"};localStorage.setItem(j,JSON.stringify(e)),console.log("✅ 已自动保存草稿 (包含图片)")}catch(e){console.log("❌ 保存表单草稿失败:",e)}},300);return()=>clearTimeout(e)}},[m,x,t]),(0,l.useEffect)(()=>{let e=()=>{if(!t&&(m.name||m.description||m.prompt_template||x))try{let e={formData:m,previewImage:x,timestamp:Date.now(),version:"1.0"};localStorage.setItem(j,JSON.stringify(e)),console.log("\uD83D\uDD04 页面卸载前保存草稿")}catch(e){console.log("❌ 页面卸载前保存失败:",e)}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[m,x,t]);let N=(e,s)=>{u(t=>({...t,[e]:s}))},w=async e=>{if(e.preventDefault(),!m.name.trim()||!m.description.trim()||!m.prompt_template.trim()){alert("请填写所有必填字段");return}if(!m.prompt_template.includes("{prompt}")){alert("⚠️ 提示词模板必须包含 {prompt} 占位符以接收用户输入");return}try{await n(m),t||localStorage.removeItem(j)}catch(e){console.error("保存样式失败:",e)}},S=[{value:"photographic-realism",label:"Photographic Realism"},{value:"illustration-digital-painting",label:"Illustration & Digital Painting"},{value:"anime-comics",label:"Anime & Comics"},{value:"concept-art",label:"Concept Art"},{value:"3d-render",label:"3D Render"},{value:"abstract",label:"Abstract"},{value:"fine-art-movements",label:"Fine-Art Movements"},{value:"technical-scientific",label:"Technical & Scientific"},{value:"architecture-interior",label:"Architecture & Interior"},{value:"design-commercial",label:"Design & Commercial"},{value:"genre-driven",label:"Genre-Driven"},{value:"vintage-retro",label:"Vintage & Retro"}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.Zb,{className:"w-full max-w-4xl mx-auto border-4 border-[#8b7355] bg-[#f5f1e8]",children:[(0,a.jsx)(i.Ol,{className:"bg-[#d4a574] border-b-4 border-[#8b7355]",children:(0,a.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center gap-2",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(F.Z,{className:"w-6 h-6"}),t?"编辑样式":"创建新样式"," ✨"]})}),(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(X._,{htmlFor:"name",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Comic Sans MS, cursive"},children:["样式名称 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)($.I,{id:"name",value:m.name,onChange:e=>N("name",e.target.value),placeholder:"例如：动漫风格",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"emoji",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"表情符号"}),(0,a.jsx)($.I,{id:"emoji",value:m.emoji,onChange:e=>N("emoji",e.target.value),placeholder:"\uD83C\uDFA8",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",maxLength:2})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"type",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"类型"}),(0,a.jsxs)(ee.Ph,{value:m.type,onValueChange:e=>N("type",e),children:[(0,a.jsx)(ee.i4,{className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",children:(0,a.jsx)(ee.ki,{})}),(0,a.jsxs)(ee.Bw,{children:[(0,a.jsx)(ee.Ql,{value:"image",children:"图片生成"}),(0,a.jsx)(ee.Ql,{value:"video",children:"视频生成"}),(0,a.jsx)(ee.Ql,{value:"both",children:"两者皆可"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"category",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"分类"}),(0,a.jsxs)(ee.Ph,{value:m.category,onValueChange:e=>N("category",e),children:[(0,a.jsx)(ee.i4,{className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",children:(0,a.jsx)(ee.ki,{})}),(0,a.jsx)(ee.Bw,{children:S.map(e=>(0,a.jsx)(ee.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"样式预览图片"}),(0,a.jsx)("div",{className:"border-2 border-dashed border-[#8b7355] rounded-xl p-4 text-center bg-white relative",children:x?(0,a.jsx)("div",{className:"relative flex justify-center",children:(0,a.jsxs)("div",{className:"w-48 h-48 relative rounded-lg overflow-hidden border-2 border-[#8b7355]",children:[(0,a.jsx)("img",{src:x,alt:"Style preview",className:"w-full h-full object-cover"}),(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2",children:[(0,a.jsx)(r.z,{type:"button",variant:"outline",size:"sm",className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white transform transition-all duration-200 hover:scale-110 active:scale-95 shadow-md hover:shadow-lg",onClick:()=>b(!0),children:(0,a.jsx)(en.Z,{className:"w-4 h-4 transition-transform duration-200 hover:rotate-12"})}),(0,a.jsx)(r.z,{type:"button",variant:"destructive",size:"sm",className:"transform transition-all duration-200 hover:scale-110 active:scale-95 shadow-md hover:shadow-lg",onClick:()=>{h(""),N("image_url","")},children:(0,a.jsx)(ea.Z,{className:"w-4 h-4 transition-transform duration-200 hover:rotate-90"})})]})]})}):(0,a.jsx)("div",{className:"py-8",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,a.jsx)(L.Z,{className:"w-8 h-8 text-[#8b7355]"}),(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"点击上传并裁剪图片 ✂️"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"支持 PNG、JPG，最大 10MB • 自动裁剪和缩放"}),(0,a.jsxs)(r.z,{type:"button",className:"bg-[#8b7355] hover:bg-[#6d5a44] text-white font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 shadow-lg hover:shadow-xl",style:{fontFamily:"Comic Sans MS, cursive"},onClick:()=>b(!0),children:[(0,a.jsx)(en.Z,{className:"w-4 h-4 mr-2 transition-transform duration-200 group-active:rotate-12"}),"选择并裁剪图片"]})]})})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(X._,{htmlFor:"description",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Comic Sans MS, cursive"},children:["描述 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(et.g,{id:"description",value:m.description,onChange:e=>N("description",e.target.value),placeholder:"描述样式的特点和特色...",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl min-h-[80px]",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(X._,{htmlFor:"prompt_template",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Comic Sans MS, cursive"},children:["提示词模板 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(et.g,{id:"prompt_template",value:m.prompt_template,onChange:e=>N("prompt_template",e.target.value),placeholder:"例如：{prompt}, anime style, vibrant colors, detailed artwork",className:"border-2 ".concat(m.prompt_template.includes("{prompt}")?"border-[#8b7355]":"border-red-500"," focus:border-[#d4a574] rounded-xl min-h-[100px]"),required:!0}),(0,a.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["使用 ","{prompt}"," 作为用户输入的占位符"]}),!m.prompt_template.includes("{prompt}")&&m.prompt_template&&(0,a.jsxs)("p",{className:"text-xs text-red-500 font-bold flex items-center",children:[(0,a.jsx)("span",{className:"mr-1",children:"⚠️"}),"警告：模板必须包含 ","{prompt}"," 占位符以接收用户输入"]}),m.prompt_template.includes("{prompt}")&&m.prompt_template&&(0,a.jsxs)("p",{className:"text-xs text-green-600 font-bold flex items-center",children:[(0,a.jsx)("span",{className:"mr-1",children:"✅"}),"模板有效 - 包含 ","{prompt}"," 占位符"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(X._,{htmlFor:"default_prompt",className:"text-[#2d3e2d] font-bold text-sm flex items-center gap-1",style:{fontFamily:"Comic Sans MS, cursive"},children:["默认提示词 ",(0,a.jsx)("span",{className:"text-blue-500",children:"(可选)"})]}),(0,a.jsx)(et.g,{id:"default_prompt",value:m.default_prompt,onChange:e=>N("default_prompt",e.target.value),placeholder:"例如：Sun Wukong causing havoc in heaven, traditional Chinese mythology, epic battle scene",className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl min-h-[80px]"}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"当用户不输入提示词时使用的默认英文提示词。如果用户输入了提示词，则使用用户的提示词。"}),m.default_prompt&&(0,a.jsxs)("p",{className:"text-xs text-green-600 font-bold flex items-center mt-1",children:[(0,a.jsx)("span",{className:"mr-1",children:"✅"}),"已设置默认提示词：用户无输入时将使用此提示词"]})]})]}),(0,a.jsxs)("div",{className:"p-6 bg-gradient-to-r from-[#f5f1e8] to-[#d4a574]/20 rounded-xl border-2 border-[#8b7355]/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("span",{className:"text-xl",children:"⚙️"}),(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:"使用限制条件"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-[#8b7355]/30",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDCF8 必须上传图片"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"用户必须上传参考图片才能使用此风格"})]}),(0,a.jsx)(es.r,{checked:m.requires_image_upload,onCheckedChange:e=>N("requires_image_upload",e),disabled:m.prohibits_image_upload})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-[#8b7355]/30",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"✍️ 必须输入描述"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"用户必须输入提示词描述"})]}),(0,a.jsx)(es.r,{checked:m.requires_prompt_description,onCheckedChange:e=>N("requires_prompt_description",e)})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-xl border border-red-300",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{className:"text-red-700 font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDEAB 禁止图片上传"}),(0,a.jsx)("p",{className:"text-xs text-red-600",children:"此风格仅支持文本生成，不允许上传图片（如CHIBI DIORAMA等风格）"})]}),(0,a.jsx)(es.r,{checked:m.prohibits_image_upload,onCheckedChange:e=>{N("prohibits_image_upload",e),e&&N("requires_image_upload",!1)}})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"min_prompt_length",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDCDD 最小描述长度"}),(0,a.jsx)($.I,{id:"min_prompt_length",type:"number",value:m.min_prompt_length,onChange:e=>N("min_prompt_length",parseInt(e.target.value)||0),className:"border border-[#8b7355]/30 focus:border-[#d4a574] rounded-lg",min:"0",max:"500",placeholder:"0"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"设置为0表示无限制"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"max_prompt_length",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDCCF 最大描述长度"}),(0,a.jsx)($.I,{id:"max_prompt_length",type:"number",value:m.max_prompt_length,onChange:e=>N("max_prompt_length",parseInt(e.target.value)||1e3),className:"border border-[#8b7355]/30 focus:border-[#d4a574] rounded-lg",min:"10",max:"2000",placeholder:"1000"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"建议设置为1000以内"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)(X._,{htmlFor:"allowed_image_formats",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDDBC️ 允许的图片格式"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:["jpg","jpeg","png","webp","gif","bmp"].map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-1 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:m.allowed_image_formats.includes(e),onChange:s=>{let t=m.allowed_image_formats;s.target.checked?N("allowed_image_formats",[...t,e]):N("allowed_image_formats",t.filter(s=>s!==e))},className:"rounded border-[#8b7355]"}),(0,a.jsx)("span",{className:"text-sm font-bold text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:e.toUpperCase()})]},e))}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"选择此风格支持的图片格式"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"requirements_description",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDCCB 使用要求说明"}),(0,a.jsx)(et.g,{id:"requirements_description",value:m.requirements_description,onChange:e=>N("requirements_description",e.target.value),placeholder:"例如：此风格需要上传参考图片，AI将基于您的图片创造玩具摄影风格的作品。请确保图片清晰，主体明确。",className:"border border-[#8b7355]/30 focus:border-[#d4a574] rounded-lg min-h-[80px] mt-1"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"向用户说明使用此风格的具体要求和注意事项"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-xl border-2 border-[#8b7355]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"高级样式"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"需要订阅"})]}),(0,a.jsx)(es.r,{checked:m.is_premium,onCheckedChange:e=>N("is_premium",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-xl border-2 border-[#8b7355]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"启用"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"用户可见"})]}),(0,a.jsx)(es.r,{checked:m.is_active,onCheckedChange:e=>N("is_active",e)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(X._,{htmlFor:"sort_order",className:"text-[#2d3e2d] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"排序顺序"}),(0,a.jsx)($.I,{id:"sort_order",type:"number",value:m.sort_order,onChange:e=>N("sort_order",parseInt(e.target.value)||0),className:"border-2 border-[#8b7355] focus:border-[#d4a574] rounded-xl",min:"0"})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-white rounded-xl border-2 border-[#8b7355]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5 text-[#8b7355]"}),(0,a.jsx)(X._,{className:"text-[#2d3e2d] font-bold",style:{fontFamily:"Comic Sans MS, cursive"},children:"样式预览"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"text-2xl",children:m.emoji}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-[#2d3e2d] text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:m.name||"样式名称"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:m.description||"样式描述"}),(0,a.jsxs)("div",{className:"flex gap-1 mt-1",children:[(0,a.jsx)(o.C,{variant:"outline",className:"text-xs",children:"image"===m.type?"图片":"video"===m.type?"视频":"两者"}),(0,a.jsx)(o.C,{variant:"outline",className:"text-xs",children:null===(s=S.find(e=>e.value===m.category))||void 0===s?void 0:s.label}),m.is_premium&&(0,a.jsx)(o.C,{className:"text-xs bg-[#d4a574] text-[#2d3e2d]",children:"高级"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-between",children:[(0,a.jsx)("div",{children:!t&&(m.name||m.description||m.prompt_template||x)&&(0,a.jsx)(r.z,{type:"button",variant:"outline",onClick:()=>{try{let e={formData:m,previewImage:x,timestamp:Date.now(),version:"1.0"};localStorage.setItem(j,JSON.stringify(e)),alert("✅ 草稿已手动保存！"),console.log("\uD83D\uDD04 手动保存草稿成功")}catch(e){alert("❌ 保存草稿失败"),console.log("❌ 手动保存草稿失败:",e)}},className:"border-2 border-blue-500 text-blue-500 hover:bg-blue-50 font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 shadow-md hover:shadow-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:"\uD83D\uDCBE 保存草稿"})}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(r.z,{type:"button",variant:"outline",onClick:c,className:"border-2 border-[#8b7355] text-[#2d3e2d] hover:bg-[#8b7355] hover:text-white font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 shadow-md hover:shadow-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:"取消"}),(0,a.jsx)(r.z,{type:"submit",disabled:d||f,className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-bold rounded-xl transform transition-all duration-200 hover:scale-105 active:scale-95 active:bg-[#b8935a] shadow-lg hover:shadow-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#2d3e2d] mr-2"}),"保存中..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(er.Z,{className:"w-4 h-4 mr-2 transition-transform duration-200 group-active:rotate-12"}),t?"更新样式":"创建样式"]})})]})]})]})})]}),g&&(0,a.jsx)(eu,{onCropComplete:e=>{h(e),N("image_url",e),b(!1)},onCancel:()=>{b(!1)},aspectRatio:1,maxWidth:512,maxHeight:512,styleName:m.name})]})}function eh(){let{data:e,status:s,update:t}=(0,c.V)(),[a,r]=(0,l.useState)(!1);return null}function ef(){var e,s,t,$,X,ee,es,et;let[ea,el]=(0,l.useState)("overview"),[er,en]=(0,l.useState)("user"),[eo,ec]=(0,l.useState)(!1),[ed,em]=(0,l.useState)(!1),[eu,ef]=(0,l.useState)({totalUsers:0,activeUsers:0,newUsers:0,premiumUsers:0,totalImages:0,imagesThisMonth:0,revenue:0,revenueGrowth:0,userImages:0,userViews:0,userLikes:0,userFollowers:0}),[ep,eg]=(0,l.useState)([]),[eb,ev]=(0,l.useState)([]),[ey,ej]=(0,l.useState)([]),[eN,ew]=(0,l.useState)("image_generation"),[eS,eC]=(0,l.useState)(!1),[e_,eD]=(0,l.useState)(null),[ek,eF]=(0,l.useState)([]),[eM,eA]=(0,l.useState)([]),[eI,eP]=(0,l.useState)(!0),[eE,ez]=(0,l.useState)(!1),[eZ,eU]=(0,l.useState)([]),[eR,eO]=(0,l.useState)(!1),[eT,eL]=(0,l.useState)(!1),[eq,eJ]=(0,l.useState)(!1),[eV,eB]=(0,l.useState)(null),[eY,eG]=(0,l.useState)([]),[eQ,eK]=(0,l.useState)(!1),[eW,eH]=(0,l.useState)(!1),[e$,eX]=(0,l.useState)(!1),[e0,e2]=(0,l.useState)(""),[e5,e3]=(0,l.useState)("all"),[e1,e4]=(0,l.useState)(0),[e8,e7]=(0,l.useState)(!1),[e6,e9]=(0,l.useState)(!1),[se,ss]=(0,l.useState)(new Set),[st,sa]=(0,l.useState)({file:null,title:"",prompt:"",style:"Admin",isPublic:!1}),[sl,sr]=(0,l.useState)(null),[si,sn]=(0,l.useState)(!1),[so,sc]=(0,l.useState)({prompt:"",style:"",is_public:!1,status:"completed"}),[sd,sm]=(0,l.useState)(!1),su=(0,W.useRouter)(),sx=(0,W.useSearchParams)(),{data:sh,status:sf}=(0,c.V)();(0,l.useEffect)(()=>{var e;if(em(!0),"unauthenticated"===sf){su.push("/admin/login");return}if("user"===sx.get("role")){en("user"),ec(!0);return}(null==sh?void 0:null===(e=sh.user)||void 0===e?void 0:e.email)&&(console.log("\uD83D\uDD0D 检查用户session权限:",{email:sh.user.email,isAdmin:sh.user.isAdmin}),sh.user.isAdmin?(console.log("✅ Session中确认为管理员，设置userRole为admin"),en("admin")):(console.log("❌ Session中确认为普通用户，设置userRole为user"),en("user")),ec(!0))},[sx,sh,sf,su]),(0,l.useEffect)(()=>{"true"===sx.get("admin")&&(console.log("\uD83D\uDD27 临时管理员覆盖激活"),en("admin"),ec(!0))},[sx]),(0,l.useEffect)(()=>{var e;"styles"===ea&&"admin"===er&&(null==sh?void 0:null===(e=sh.user)||void 0===e?void 0:e.email)&&(console.log("\uD83C\uDFAF 切换到styles标签页"),eT&&0!==eZ.length?console.log("✅ Styles数据已存在，跳过重复加载"):(console.log("\uD83D\uDD04 首次加载或数据为空，开始加载styles数据"),sg()))},[ea,er,sh,eT,eZ.length]),(0,l.useEffect)(()=>{var e;"api-configs"===ea&&"admin"===er&&(null==sh?void 0:null===(e=sh.user)||void 0===e?void 0:e.email)&&(console.log("\uD83C\uDFAF 切换到api-configs标签页"),0!==ey.length||eE?console.log("✅ API配置数据已存在，跳过重复加载"):(console.log("\uD83D\uDD04 首次加载或数据为空，开始加载API配置数据"),sp()))},[ea,er,sh,ey.length,eE]);let sp=async()=>{try{ez(!0),console.log("\uD83D\uDD04 Loading API configurations...");let s=await fetch("/api/admin/api-configs");if(s.ok){var e;let t=await s.json();ej(t.configs||[]),console.log("✅ API configurations loaded:",(null===(e=t.configs)||void 0===e?void 0:e.length)||0)}else console.error("❌ Failed to load API configurations"),ej([])}catch(e){console.error("❌ Error loading API configurations:",e),ej([])}finally{ez(!1)}},sg=async()=>{var e,s,t;try{eO(!0),console.log("\uD83D\uDD04 Loading styles..."),console.log("\uD83D\uDD0D Session info:",{hasSession:!!sh,userEmail:null==sh?void 0:null===(e=sh.user)||void 0===e?void 0:e.email,userRole:er});let t=await fetch("/api/admin/styles",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(console.log("\uD83D\uDCE1 Styles API response:",{status:t.status,statusText:t.statusText}),t.ok){let e=await t.json();console.log("\uD83D\uDCCA Styles response data:",e),eU(e.styles||[]),console.log("✅ Styles loaded successfully:",(null===(s=e.styles)||void 0===s?void 0:s.length)||0)}else{let e;try{e=await t.json()}catch(s){e=await t.text()}let s={status:t.status,statusText:t.statusText,error:e,url:t.url};console.error("❌ Failed to load styles:",s),401===t.status?console.error("\uD83D\uDD10 Authentication error: User not logged in"):403===t.status?console.error("⛔ Permission error: Admin access required"):500===t.status&&console.error("\uD83D\uDCA5 Server error: Database or internal error"),eU([])}}catch(e){console.error("❌ Network or parsing error:",{message:e instanceof Error?e.message:"Unknown error",stack:e instanceof Error?e.stack:void 0,type:null==e?void 0:null===(t=e.constructor)||void 0===t?void 0:t.name}),eU([])}finally{eO(!1),eL(!0)}},sb=async()=>{try{eP(!0),console.log("\uD83D\uDD04 开始加载Dashboard数据...");let e=new Date().getTime(),s=await fetch("/api/dashboard/stats?t=".concat(e),{cache:"no-cache",headers:{"Cache-Control":"no-cache"}});if(console.log("\uD83D\uDCCA Stats API响应状态:",s.status),s.ok){let e=await s.json();console.log("\uD83D\uDCCA 收到统计数据:",e),e.stats?(console.log("✅ 设置Dashboard统计:",e.stats),ef(e.stats)):console.error("⚠️ 统计数据格式错误:",e)}else console.error("❌ Stats API请求失败:",s.status);if("admin"===er){let e=await fetch("/api/dashboard/users");if(e.ok){let s=await e.json();eg(s.users||[])}let s=await fetch("/api/dashboard/images");if(s.ok){let e=await s.json();ev(e.images||[])}0===ey.length&&sp()}}catch(e){console.error("❌ 加载仪表板数据失败:",e)}finally{eP(!1)}},sv=()=>{let e=eu.totalUsers||0,s=eu.totalImages||0,t=eu.revenue||0;eF(["Jan","Feb","Mar","Apr","May","Jun"].map((a,l)=>({name:a,users:Math.floor(e*(.1+.05*l)),images:Math.floor(s*(.08+.04*l)),revenue:Math.floor(t*(.12+.03*l))}))),eA([{name:"Free Users",value:Math.floor(.6*e),color:"#8b7355"},{name:"Pro Users",value:Math.floor(.3*e),color:"#d4a574"},{name:"Wizard Users",value:Math.floor(.1*e),color:"#2d3e2d"}])};(0,l.useEffect)(()=>{var e,s;(null==sh?void 0:null===(e=sh.user)||void 0===e?void 0:e.email)&&"admin"===er&&eo?(console.log("✅ 满足条件，开始加载数据"),console.log("- 用户邮箱:",sh.user.email),console.log("- 用户角色:",er),console.log("- 角色检查完成:",eo),sb()):(console.log("❌ 不满足数据加载条件:"),console.log("- 用户邮箱:",(null==sh?void 0:null===(s=sh.user)||void 0===s?void 0:s.email)||"无"),console.log("- 用户角色:",er),console.log("- 角色检查完成:",eo))},[null==sh?void 0:null===(e=sh.user)||void 0===e?void 0:e.email,er,eo]),(0,l.useEffect)(()=>{(eu.totalUsers>0||eu.totalImages>0)&&(console.log("\uD83D\uDCC8 Dashboard统计数据已更新，生成图表数据:",eu),sv())},[eu]),(0,l.useEffect)(()=>{"images"!==ea||"admin"!==er||0!==eY.length||eQ||(sS(!0),sE())},[ea,er]);let[sy]=(0,l.useState)(()=>[{id:0,left:10,top:20,size:15,rotation:45,delay:.5},{id:1,left:80,top:10,size:20,rotation:90,delay:1},{id:2,left:30,top:70,size:12,rotation:180,delay:1.5},{id:3,left:60,top:40,size:18,rotation:270,delay:.8},{id:4,left:15,top:85,size:14,rotation:30,delay:1.2},{id:5,left:90,top:60,size:16,rotation:120,delay:.3},{id:6,left:45,top:15,size:22,rotation:200,delay:1.8},{id:7,left:70,top:90,size:13,rotation:315,delay:.7}]),sj=async()=>{try{console.log("\uD83D\uDEAA 开始登出流程...");let e=await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){let s=await e.json();console.log("✅ 登出时间记录成功:",s)}else console.error("⚠️ 登出时间记录失败，但继续登出")}catch(e){console.error("⚠️ 调用登出API失败，但继续登出:",e)}await (0,c.d)({callbackUrl:"/admin/login"})},sN=e=>{switch(e){case"Free":return"bg-[#8b7355] text-white";case"Pro":return"bg-[#d4a574] text-[#2d3e2d]";case"Wizard":return"bg-[#2d3e2d] text-white";default:return"bg-gray-500 text-white"}},sw=e=>{switch(e){case"active":case"approved":return"bg-green-500 text-white";case"inactive":default:return"bg-gray-500 text-white";case"pending":return"bg-yellow-500 text-white";case"rejected":return"bg-red-500 text-white"}},sS=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e?(eK(!0),e4(0)):e9(!0);try{let s=e?0:e1,t=new URLSearchParams({limit:"12",offset:s.toString(),filter:e5,search:e0}),a=await fetch("/api/admin/images?".concat(t)),l=await a.json();l.success?(e?eG(l.data):eG(e=>[...e,...l.data]),e7(l.hasMore),e4(s+l.data.length)):console.error("Failed to load images:",l.error)}catch(e){console.error("Error loading admin images:",e)}finally{eK(!1),e9(!1)}},sC=async()=>{if(st.file){eX(!0);try{let e=new FormData;e.append("file",st.file),e.append("title",st.title),e.append("prompt",st.prompt),e.append("style",st.style),e.append("isPublic",st.isPublic.toString());let s=await fetch("/api/admin/images/upload",{method:"POST",body:e}),t=await s.json();t.success?(console.log("✅ Image uploaded successfully:",t.data),sa({file:null,title:"",prompt:"",style:"Admin",isPublic:!1}),eH(!1),sS(!0)):(console.error("Upload failed:",t.error),alert("Upload failed: "+t.error))}catch(e){console.error("Error uploading image:",e),alert("Upload failed, please try again")}finally{eX(!1)}}},s_=async e=>{if(confirm('Are you sure you want to delete image "'.concat(e.title,'"? This action cannot be undone.')))try{let s=await fetch("/api/admin/images",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:e.id,userId:e.user_id})}),t=await s.json();t.success?(console.log("✅ Image deleted successfully"),eG(s=>s.filter(s=>s.id!==e.id))):(console.error("Delete failed:",t.error),alert("Delete failed: "+t.error))}catch(s){console.error("Error deleting image:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Delete failed: ".concat(e))}},sD=async e=>{try{let s=await fetch("/api/admin/images/toggle-public",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:e.id,userId:e.user_id})}),t=await s.json();t.success?(console.log("✅ Image public status toggled"),eG(s=>s.map(s=>s.id===e.id?{...s,is_public:!s.is_public}:s))):(console.error("Toggle failed:",t.error),alert("Toggle status failed: "+t.error))}catch(s){console.error("Error toggling image public status:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Operation failed: ".concat(e))}},sk=async e=>{try{let s=await fetch(e.generated_image_url),t=await s.blob(),a=window.URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="".concat(e.title,"_").concat(e.id,".png"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l)}catch(s){console.error("Error downloading image:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Download failed: ".concat(e))}},sF=e=>{sr(e),sc({prompt:e.prompt||"",style:e.style||"",is_public:e.is_public||!1,status:e.status||"completed"}),sn(!0),0===eZ.length&&"admin"===er&&(console.log("\uD83C\uDFA8 Loading styles for edit form..."),sg())},sM=async()=>{if(sl){sm(!0);try{let e=await fetch("/api/admin/images/edit",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:sl.id,...so})}),s=await e.json();s.success?(console.log("✅ Image updated successfully"),eG(e=>e.map(e=>e.id===sl.id?{...e,...so,updated_at:new Date().toISOString().split("T")[0]+" "+new Date().toISOString().split("T")[1].split(".")[0]}:e)),sn(!1),sr(null),alert("✅ Image updated successfully!")):(console.error("Edit failed:",s.error),alert("Edit failed: "+s.error))}catch(s){console.error("Error editing image:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Edit failed: ".concat(e))}finally{sm(!1)}}},sA=async()=>{if(confirm("确定要将所有图片设置为公开状态吗？这个操作不可撤销。"))try{let e=await fetch("/api/admin/images/make-all-public",{method:"POST",headers:{"Content-Type":"application/json"}}),s=await e.json();s.success?(console.log("✅ All images made public successfully"),alert("✅ 成功将 ".concat(s.updatedCount," 张图片设置为公开状态！")),sS(!0)):(console.error("Make all public failed:",s.error),alert("操作失败: "+s.error))}catch(s){console.error("Error making all images public:",s);let e=s instanceof Error?s.message:"Unknown error";alert("操作失败: ".concat(e))}},sI=async()=>{try{let e=await fetch("/api/admin/images/diagnose"),s=await e.json();if(s.success){let{stats:e,duplicatesByUrl:t,duplicatesByIds:a}=s,l="\uD83D\uDCCA 图片诊断结果:\n\n";l+="总图片数: ".concat(e.totalImages,"\n")+"公开图片: ".concat(e.publicImages,"\n")+"私有图片: ".concat(e.privateImages,"\n")+"唯一URL数: ".concat(e.uniqueUrls,"\n")+"重复URL数: ".concat(e.duplicateUrls,"\n")+"重复ID数: ".concat(e.duplicateIds,"\n\n"),e.duplicateUrls>0?(l+="⚠️ 发现 ".concat(e.duplicateUrls," 个重复的图片URL\n")+"这可能导致同一张图片显示多次。\n\n",t.length>0&&(l+="示例重复:\n",t.slice(0,3).forEach((e,s)=>{l+="".concat(s+1,". ").concat(e.count,"个相同图片 (").concat(e.images[0].style,")\n")}))):l+="✅ 没有发现重复的图片URL\n",alert(l),console.log("\uD83D\uDCCA 诊断结果:",s)}else console.error("Diagnose failed:",s.error),alert("诊断失败: "+s.error)}catch(s){console.error("Error diagnosing images:",s);let e=s instanceof Error?s.message:"Unknown error";alert("诊断失败: ".concat(e))}},sP=async e=>{try{let s=se.has(e.id),t=await fetch("/api/admin/images/featured",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:e.id,featured:!s})}),a=await t.json();a.success?(console.log("✅ Featured status toggled"),ss(t=>{let a=new Set(t);return s?a.delete(e.id):a.add(e.id),a})):(console.error("Toggle featured failed:",a.error),alert("Toggle featured status failed: "+a.error))}catch(s){console.error("Error toggling featured status:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Operation failed: ".concat(e))}},sE=async()=>{try{let e=await fetch("/api/admin/images/featured"),s=await e.json();s.success&&ss(new Set(s.data.map(e=>e.image_id)))}catch(e){console.error("Error loading featured status:",e)}},sz=async e=>{try{let s={name:"".concat(e.name," (Copy)"),type:e.type,provider:e.provider,base_url:e.base_url,api_key:e.api_key,model:e.model,endpoint:e.endpoint,priority:e.priority+1,is_default:!1,is_active:e.is_active,max_retries:e.max_retries,timeout_seconds:e.timeout_seconds,rate_limit_per_minute:e.rate_limit_per_minute,config_data:e.config_data},t=await fetch("/api/admin/api-configs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(t.ok)await sp(),alert("✅ API configuration copied successfully!");else{let e=await t.json().catch(()=>({error:"Unknown error"}));alert("❌ Failed to copy API configuration: ".concat(e.error||"Unknown error"))}}catch(s){console.error("Error copying API config:",s);let e=s instanceof Error?s.message:"Unknown error";alert("❌ Failed to copy API configuration: ".concat(e))}};return((0,l.useEffect)(()=>{},[sh,er,eo,ed,sf]),"loading"!==sf&&ed)?(0,a.jsxs)("div",{className:"min-h-screen bg-[#f5f1e8] relative overflow-hidden",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,a.jsx)("div",{className:"absolute top-20 right-20 w-40 h-40 bg-[#8b7355]/5 rounded-full blur-3xl"}),(0,a.jsx)("div",{className:"absolute bottom-20 left-20 w-32 h-32 bg-[#2d3e2d]/5 rounded-full blur-2xl"}),ed&&sy.map(e=>(0,a.jsx)(H.E.div,{className:"absolute",style:{left:"".concat(e.left,"%"),top:"".concat(e.top,"%"),width:"".concat(e.size,"px"),height:"".concat(e.size,"px")},animate:{y:[-10,10,-10],rotate:[0,360],scale:[.8,1.2,.8]},transition:{duration:6+e.delay,repeat:1/0,ease:"easeInOut"},children:(0,a.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-[#d4a574]/20 to-[#8b7355]/20 rounded-full",style:{transform:"rotate(".concat(e.rotation,"deg)")}})},e.id))]}),(0,a.jsx)("header",{className:"relative z-10 bg-white/95 backdrop-blur-md border-b-4 border-[#8b7355] p-4 md:p-6 shadow-lg",children:(0,a.jsx)("div",{className:"container mx-auto",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(r.z,{onClick:()=>su.push("/"),variant:"ghost",className:"text-[#2d3e2d] hover:bg-[#d4a574] hover:text-[#2d3e2d] font-black rounded-2xl transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),"Back to Home \uD83C\uDFE0"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-[#2d3e2d] rounded-2xl flex items-center justify-center shadow-lg transform rotate-12",children:"admin"===er?(0,a.jsx)(N.Z,{className:"w-6 h-6 text-[#d4a574]"}):(0,a.jsx)(w.Z,{className:"w-6 h-6 text-[#d4a574]"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-black text-[#2d3e2d] transform -rotate-1",style:{fontFamily:"Comic Sans MS, cursive",textShadow:"2px 2px 0px #8b7355"},children:["AIMAGICA ","admin"===er?"Admin":"User"]}),(0,a.jsx)("p",{className:"text-sm font-bold text-[#8b7355] transform rotate-1",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"Master Control Panel \uD83D\uDC51":"Creative Workspace \uD83C\uDFA8"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(r.z,{variant:"ghost",className:"text-[#2d3e2d] hover:bg-[#d4a574] hover:text-[#2d3e2d] font-black rounded-2xl transform hover:scale-105 transition-all relative",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(S.Z,{className:"w-5 h-5"}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),(null==sh?void 0:sh.user)&&(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[sh.user.image?(0,a.jsx)("img",{src:sh.user.image,alt:sh.user.name||"User",className:"w-10 h-10 rounded-full border-2 border-[#d4a574] shadow-md",onError:e=>{console.warn("Avatar loading failed:",sh.user.image),e.currentTarget.style.display="none";let s=e.currentTarget.nextElementSibling;s&&(s.style.display="flex")},onLoad:()=>{console.log("Avatar loaded successfully:",sh.user.image)}}):null,(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-[#d4a574] to-[#8b7355] rounded-full flex items-center justify-center text-white font-black",style:{display:sh.user.image?"none":"flex"},children:(null===(s=sh.user.name)||void 0===s?void 0:s.charAt(0))||(null===(t=sh.user.email)||void 0===t?void 0:t.charAt(0))||"U"}),(0,a.jsxs)("div",{className:"hidden md:block",children:[(0,a.jsx)("p",{className:"text-[#2d3e2d] font-black text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:sh.user.name||"Magic User"}),(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-xs",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"Admin":"User"})]})]})}),(0,a.jsxs)(r.z,{onClick:sj,className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-[#f5f1e8] font-black px-6 py-3 rounded-2xl shadow-lg transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(C.Z,{className:"w-4 h-4 mr-2"}),"Logout \uD83D\uDC4B"]})]})]})})}),(0,a.jsxs)("main",{className:"relative z-10 container mx-auto px-4 md:px-6 py-8",children:[(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:(0,a.jsxs)("div",{className:"bg-gradient-to-r from-[#2d3e2d] via-[#8b7355] to-[#d4a574] rounded-3xl border-4 border-[#2d3e2d] p-6 shadow-2xl relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-[#f5f1e8] rounded-full opacity-80"}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"admin"===er?"\uD83D\uDC51":"\uD83C\uDFA8"}),(0,a.jsxs)("h2",{className:"text-3xl md:text-4xl font-black text-[#f5f1e8] mb-2 transform -rotate-1",style:{fontFamily:"Comic Sans MS, cursive",textShadow:"2px 2px 0px rgba(0,0,0,0.3)"},children:["Welcome, ",(null==sh?void 0:null===($=sh.user)||void 0===$?void 0:$.name)||("admin"===er?"Master Admin":"Creative Master"),"! ✨"]}),(0,a.jsxs)("p",{className:"text-[#f5f1e8] font-bold text-lg opacity-90",style:{fontFamily:"Comic Sans MS, cursive"},children:["admin"===er?"Manage the magical kingdom of AIMAGICA with your supreme power!":"Track your creative journey and manage your magical artworks!"," \uD83C\uDF1F"]})]})]})}),(0,a.jsxs)(n.mQ,{value:ea,onValueChange:el,className:"w-full",children:[(0,a.jsxs)(n.dr,{className:"grid w-full ".concat("admin"===er?"grid-cols-8":"grid-cols-3"," bg-[#4a5a4a] rounded-2xl p-2 shadow-lg mb-8"),children:[(0,a.jsxs)(n.SP,{value:"overview",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Overview \uD83D\uDCCA"]}),(0,a.jsxs)(n.SP,{value:"images",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 mr-2"}),"admin"===er?"All Images":"My Art"," \uD83C\uDFA8"]}),"admin"===er&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.SP,{value:"users",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(k.Z,{className:"w-4 h-4 mr-2"}),"Users \uD83D\uDC65"]}),(0,a.jsxs)(n.SP,{value:"styles",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(F.Z,{className:"w-4 h-4 mr-2"}),"Styles \uD83C\uDFAD"]}),(0,a.jsxs)(n.SP,{value:"api-configs",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(M.Z,{className:"w-4 h-4 mr-2"}),"API Configs ⚡"]}),(0,a.jsxs)(n.SP,{value:"payment",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Payment \uD83D\uDCB3"]}),(0,a.jsxs)(n.SP,{value:"prompts",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},onClick:()=>su.push("/admin/prompts"),children:[(0,a.jsx)(I.Z,{className:"w-4 h-4 mr-2"}),"Prompts ✨"]})]}),(0,a.jsxs)(n.SP,{value:"settings",className:"rounded-xl font-black data-[state=active]:bg-[#d4a574] data-[state=active]:text-[#2d3e2d] data-[state=active]:shadow-lg text-[#f5f1e8] transform hover:scale-105 transition-all",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 mr-2"}),"Settings ⚙️"]})]}),(0,a.jsxs)(n.nU,{value:"overview",className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,a.jsx)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"Total Users":"My Images"}),(0,a.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?(null==eu?void 0:null===(X=eu.totalUsers)||void 0===X?void 0:X.toString())||"0":(null==eu?void 0:null===(ee=eu.userImages)||void 0===ee?void 0:ee.toString())||"0"})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-[#8b7355] rounded-full flex items-center justify-center",children:(0,a.jsx)(k.Z,{className:"w-6 h-6 text-white"})})]})})})}),(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsx)(i.Zb,{className:"bg-white border-4 border-[#d4a574] rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"Total Images":"Total Views"}),(0,a.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?((null==eu?void 0:eu.totalImages)||0).toString():((null==eu?void 0:eu.userViews)||0).toString()})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-[#d4a574] rounded-full flex items-center justify-center",children:(0,a.jsx)(D.Z,{className:"w-6 h-6 text-white"})})]})})})}),(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,a.jsx)(i.Zb,{className:"bg-white border-4 border-[#2d3e2d] rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"Monthly Revenue":"Total Likes"}),(0,a.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"$".concat(((null==eu?void 0:eu.revenue)||0).toString()):((null==eu?void 0:eu.userLikes)||0).toString()})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-[#2d3e2d] rounded-full flex items-center justify-center",children:"admin"===er?(0,a.jsx)(E.Z,{className:"w-6 h-6 text-white"}):(0,a.jsx)(z.Z,{className:"w-6 h-6 text-white"})})]})})})}),(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,a.jsx)(i.Zb,{className:"bg-white border-4 border-green-500 rounded-2xl shadow-lg transform hover:scale-105 transition-all",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"Growth Rate":"Followers"}),(0,a.jsx)("p",{className:"text-3xl font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:"admin"===er?"+".concat(eu.revenueGrowth,"%"):(null===(es=eu.userFollowers)||void 0===es?void 0:es.toString())||"0"})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(Z.Z,{className:"w-6 h-6 text-white"})})]})})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsx)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},children:(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(d.v,{className:"w-6 h-6 mr-2"}),"admin"===er?"Platform Statistics \uD83D\uDCC8":"My Progress \uD83D\uDCCA"]})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)(m.h,{width:"100%",height:300,children:(0,a.jsxs)(u.w,{data:ek,children:[(0,a.jsx)(x.q,{strokeDasharray:"3 3"}),(0,a.jsx)(h.K,{dataKey:"name"}),(0,a.jsx)(f.B,{}),(0,a.jsx)(p.u,{}),(0,a.jsx)(g.x,{type:"monotone",dataKey:"admin"===er?"users":"images",stroke:"#d4a574",strokeWidth:3}),(0,a.jsx)(g.x,{type:"monotone",dataKey:"admin"===er?"revenue":"views",stroke:"#2d3e2d",strokeWidth:3})]})})})]})}),(0,a.jsx)(H.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.6},children:(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#d4a574] rounded-2xl shadow-lg",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)(i.ll,{className:"text-2xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(b.u,{className:"w-6 h-6 mr-2"}),"admin"===er?"User Distribution \uD83E\uDD67":"Style Breakdown \uD83C\uDFA8"]})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)(m.h,{width:"100%",height:300,children:(0,a.jsxs)(b.u,{children:[(0,a.jsx)(v.b,{data:eM,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:t}=e;return"".concat(s," ").concat((100*t).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:eM.map((e,s)=>(0,a.jsx)(y.b,{fill:e.color},"cell-".concat(s)))}),(0,a.jsx)(p.u,{})]})})})]})})]})]}),"admin"===er&&(0,a.jsx)(n.nU,{value:"users",className:"space-y-6",children:(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(k.Z,{className:"w-8 h-8 mr-3"}),"User Management \uD83D\uDC65"]}),(0,a.jsxs)(r.z,{className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Add User ➕"]})]})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:ep.map((e,s)=>(0,a.jsxs)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"flex items-center justify-between p-4 bg-[#f5f1e8] rounded-2xl border-2 border-[#8b7355] hover:border-[#d4a574] transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-[#d4a574] to-[#8b7355] rounded-full flex items-center justify-center text-white font-black",children:e.avatar}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:e.name}),(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:e.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(o.C,{className:sN(e.plan),children:e.plan}),(0,a.jsx)(o.C,{className:sw(e.status),children:e.status}),(0,a.jsxs)("span",{className:"text-[#8b7355] font-bold text-sm",style:{fontFamily:"Comic Sans MS, cursive"},children:[e.images," images"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",children:(0,a.jsx)(R.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})})]})]})]},e.id))})})]})})}),(0,a.jsxs)(n.nU,{value:"images",className:"space-y-6",children:[(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#d4a574] rounded-2xl shadow-lg",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(D.Z,{className:"w-8 h-8 mr-3"}),"admin"===er?"Image Management \uD83D\uDDBC️":"My Artworks \uD83C\uDFA8"]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:["admin"===er&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.z,{onClick:()=>eH(!0),className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-[#f5f1e8] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 mr-2"}),"Upload Image ⬆️"]}),(0,a.jsxs)(r.z,{onClick:sA,className:"bg-green-600 hover:bg-green-700 text-white font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(q.Z,{className:"w-4 h-4 mr-2"}),"Make All Public \uD83C\uDF10"]}),(0,a.jsxs)(r.z,{onClick:sI,className:"bg-purple-600 hover:bg-purple-700 text-white font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Diagnose \uD83D\uDD0D"]})]}),(0,a.jsxs)(r.z,{onClick:sS,variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Refresh List \uD83D\uDD04"]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"Search prompts or styles...",value:e0,onChange:e=>e2(e.target.value),className:"w-full px-4 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"}})}),(0,a.jsxs)("select",{value:e5,onChange:e=>e3(e.target.value),className:"px-4 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)("option",{value:"all",children:"All Images"}),(0,a.jsx)("option",{value:"public",children:"Public Images"}),(0,a.jsx)("option",{value:"private",children:"Private Images"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"processing",children:"Processing"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]}),(0,a.jsx)(r.z,{onClick:()=>{sS(!0)},className:"bg-[#8b7355] hover:bg-[#6b5a44] text-white font-black rounded-xl px-6",style:{fontFamily:"Comic Sans MS, cursive"},children:"Search \uD83D\uDD0D"})]})]}),(0,a.jsxs)(i.aY,{children:[ed?eQ?(0,a.jsxs)("div",{className:"flex justify-center items-center py-20",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355]"}),(0,a.jsx)("span",{className:"ml-4 text-[#8b7355] font-bold",children:"Loading images..."})]}):0===eY.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)(D.Z,{className:"w-16 h-16 text-[#d4a574] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-lg",children:"No images found"}),(0,a.jsx)("p",{className:"text-[#8b7355] text-sm mt-2",children:"Try adjusting search criteria or upload new images"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:eY.map((e,s)=>(0,a.jsxs)(H.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*s},className:"bg-[#f5f1e8] rounded-2xl border-2 border-[#d4a574] hover:border-[#8b7355] transition-all overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative aspect-square",children:[(0,a.jsx)("img",{src:e.generated_image_url,alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/placeholder-image.png"}}),(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>sD(e),className:"px-2 py-1 rounded-lg text-xs font-bold transition-all hover:scale-105 ".concat(e.is_public?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-500 hover:bg-gray-600 text-white"),title:"Click to make ".concat(e.is_public?"private":"public"),children:e.is_public?"\uD83C\uDF10 Public":"\uD83D\uDD12 Private"}),(0,a.jsx)(o.C,{className:"bg-[#8b7355] text-white text-xs",children:e.style})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h4",{className:"font-black text-[#2d3e2d] text-sm mb-2 line-clamp-2",style:{fontFamily:"Comic Sans MS, cursive"},title:e.prompt,children:e.title}),(0,a.jsxs)("p",{className:"text-[#8b7355] font-bold text-xs mb-3",style:{fontFamily:"Comic Sans MS, cursive"},children:["User: ",e.user_name," • ",e.created_at]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-[#8b7355] font-bold text-xs",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(z.Z,{className:"w-3 h-3 mr-1"}),e.likes_count]}),e.render_time&&(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(J.Z,{className:"w-3 h-3 mr-1"}),e.render_time,"s"]})]}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>window.open(e.generated_image_url,"_blank"),className:"text-[#8b7355] hover:text-[#2d3e2d] p-1 h-8 w-8",children:(0,a.jsx)(R.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>sk(e),className:"text-[#8b7355] hover:text-[#2d3e2d] p-1 h-8 w-8",children:(0,a.jsx)(V.Z,{className:"w-4 h-4"})}),"admin"===er&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>sP(e),className:"p-1 h-8 w-8 ".concat(se.has(e.id)?"text-orange-500 hover:text-orange-700":"text-gray-400 hover:text-orange-500"),title:se.has(e.id)?"Remove from Featured":"Add to Featured",children:(0,a.jsx)(B.Z,{className:"w-4 h-4 ".concat(se.has(e.id)?"fill-current":"")})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>sF(e),className:"text-yellow-500 hover:text-yellow-700 p-1 h-8 w-8",title:"Edit Image",children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",onClick:()=>s_(e),className:"text-red-500 hover:text-red-700 p-1 h-8 w-8",title:"Delete Image",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})})]})]})]})]})]},e.id))}):(0,a.jsxs)("div",{className:"flex justify-center items-center py-20",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355]"}),(0,a.jsx)("span",{className:"ml-4 text-[#8b7355] font-bold",children:"Loading..."})]}),eY.length>0&&e8&&(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsx)(r.z,{onClick:()=>{sS(!1)},disabled:e6,className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl px-8",style:{fontFamily:"Comic Sans MS, cursive"},children:e6?"Loading...":"Load More \uD83D\uDCF8"})})]})]})}),eW&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)(H.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl p-6 max-w-md w-full mx-4 border-4 border-[#d4a574]",children:[(0,a.jsx)("h3",{className:"text-2xl font-black text-[#2d3e2d] mb-4",style:{fontFamily:"Comic Sans MS, cursive"},children:"Upload Image \uD83D\uDCF8"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Select Image File"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];t&&sa(e=>({...e,file:t,title:e.title||t.name.replace(/\.[^/.]+$/,"")}))},className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Image Title"}),(0,a.jsx)("input",{type:"text",value:st.title,onChange:e=>sa({...st,title:e.target.value}),placeholder:"Enter image title...",className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Image Description"}),(0,a.jsx)("textarea",{value:st.prompt,onChange:e=>sa({...st,prompt:e.target.value}),placeholder:"Enter image description...",rows:3,className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none resize-none",style:{fontFamily:"Comic Sans MS, cursive"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Image Style"}),(0,a.jsxs)("select",{value:st.style,onChange:e=>sa({...st,style:e.target.value}),className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)("option",{value:"Admin",children:"Admin"}),(0,a.jsx)("option",{value:"Realistic",children:"Realistic"}),(0,a.jsx)("option",{value:"Anime",children:"Anime"}),(0,a.jsx)("option",{value:"Cartoon",children:"Cartoon"}),(0,a.jsx)("option",{value:"Fantasy",children:"Fantasy"}),(0,a.jsx)("option",{value:"Abstract",children:"Abstract"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"isPublic",checked:st.isPublic,onChange:e=>sa({...st,isPublic:e.target.checked}),className:"w-4 h-4 text-[#8b7355] border-2 border-[#d4a574] rounded focus:ring-[#8b7355]"}),(0,a.jsx)("label",{htmlFor:"isPublic",className:"text-sm font-bold text-[#8b7355]",style:{fontFamily:"Comic Sans MS, cursive"},children:"Share to Gallery"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)(r.z,{onClick:()=>eH(!1),variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:"Cancel"}),(0,a.jsx)(r.z,{onClick:sC,disabled:e$||!st.file,className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-white font-black rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:e$?"Uploading...":"Upload \uD83D\uDCE4"})]})]})}),si&&sl&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)(H.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl p-6 max-w-2xl w-full mx-4 border-4 border-[#d4a574] max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("h3",{className:"text-2xl font-black text-[#2d3e2d] mb-4 flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(O.Z,{className:"w-6 h-6 mr-2"}),"Edit Image Metadata ✏️"]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"relative aspect-video bg-gray-100 rounded-xl overflow-hidden",children:[(0,a.jsx)("img",{src:sl.generated_image_url,alt:sl.title,className:"w-full h-full object-contain"}),(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-1",children:[(0,a.jsx)(o.C,{className:"".concat(sl.is_public?"bg-green-500":"bg-gray-500"," text-white text-xs"),children:sl.is_public?"Public":"Private"}),(0,a.jsx)(o.C,{className:"bg-[#8b7355] text-white text-xs",children:sl.style})]})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[(0,a.jsx)("strong",{children:"ID:"})," ",sl.id," |",(0,a.jsx)("strong",{children:" User:"})," ",sl.user_name," |",(0,a.jsx)("strong",{children:" Created:"})," ",sl.created_at]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Prompt / Description"}),(0,a.jsx)("textarea",{value:so.prompt,onChange:e=>sc({...so,prompt:e.target.value}),placeholder:"Enter image description or prompt...",rows:4,className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none resize-none",style:{fontFamily:"Comic Sans MS, cursive"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Style"}),(0,a.jsx)("select",{value:so.style,onChange:e=>sc({...so,style:e.target.value}),className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"},children:eZ.length>0?eZ.map(e=>(0,a.jsxs)("option",{value:e.name,children:[e.emoji," ",e.name]},e.id)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"Photorealistic",children:"Photorealistic"}),(0,a.jsx)("option",{value:"Art Toy Style",children:"Art Toy Style"}),(0,a.jsx)("option",{value:"Chibi Diorama",children:"Chibi Diorama"}),(0,a.jsx)("option",{value:"Photo Dump Aesthetic",children:"Photo Dump Aesthetic"}),(0,a.jsx)("option",{value:"Hyperrealistic Fur",children:"Hyperrealistic Fur"}),(0,a.jsx)("option",{value:"3D Street Art",children:"3D Street Art"}),(0,a.jsx)("option",{value:"Cyberpunk",children:"Cyberpunk"}),(0,a.jsx)("option",{value:"Realistic",children:"Realistic"}),(0,a.jsx)("option",{value:"Anime",children:"Anime"}),(0,a.jsx)("option",{value:"Cartoon",children:"Cartoon"}),(0,a.jsx)("option",{value:"Fantasy",children:"Fantasy"}),(0,a.jsx)("option",{value:"Abstract",children:"Abstract"}),(0,a.jsx)("option",{value:"Admin",children:"Admin"})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-[#8b7355] mb-2",children:"Status"}),(0,a.jsxs)("select",{value:so.status,onChange:e=>sc({...so,status:e.target.value}),className:"w-full px-3 py-2 border-2 border-[#d4a574] rounded-xl focus:border-[#8b7355] outline-none",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"processing",children:"Processing"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"editIsPublic",checked:so.is_public,onChange:e=>sc({...so,is_public:e.target.checked}),className:"w-4 h-4 text-[#8b7355] border-2 border-[#d4a574] rounded focus:ring-[#8b7355]"}),(0,a.jsx)("label",{htmlFor:"editIsPublic",className:"text-sm font-bold text-[#8b7355]",style:{fontFamily:"Comic Sans MS, cursive"},children:"Public Gallery Visibility"}),so.is_public&&(0,a.jsx)(o.C,{className:"bg-green-500 text-white text-xs",children:"\uD83C\uDF10 Public"}),!so.is_public&&(0,a.jsx)(o.C,{className:"bg-gray-500 text-white text-xs",children:"\uD83D\uDD12 Private"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)(r.z,{onClick:()=>{sn(!1),sr(null),sc({prompt:"",style:"",is_public:!1,status:"completed"})},variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:"Cancel"}),(0,a.jsx)(r.z,{onClick:sM,disabled:sd,className:"bg-[#2d3e2d] hover:bg-[#1a2a1a] text-white font-black rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:sd?"Saving...":"Save Changes \uD83D\uDCBE"})]})]})})]}),"admin"===er&&(0,a.jsx)(n.nU,{value:"api-configs",className:"space-y-6",children:(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:eS?(0,a.jsx)(ei,{config:e_,onSave:async e=>{try{let s=e_?"/api/admin/api-configs/".concat(e_.id):"/api/admin/api-configs",t=await fetch(s,{method:e_?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)await sp(),eC(!1),eD(null),alert(e_?"✅ API configuration updated successfully!":"✅ API configuration created successfully!");else{let e=await t.json().catch(()=>({error:"Unknown error"}));alert("❌ Failed to ".concat(e_?"update":"create"," API configuration: ").concat(e.error||"Unknown error"))}}catch(s){console.error("Error saving API config:",s);let e=s instanceof Error?s.message:"Unknown error";alert("❌ Failed to ".concat(e_?"update":"create"," API configuration: ").concat(e))}},onCancel:()=>{eC(!1),eD(null)},isLoading:!1}):(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(M.Z,{className:"w-8 h-8 mr-3"}),"API Configuration Management ⚡"]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)(r.z,{onClick:sp,variant:"outline",className:"border-[#8b7355] text-[#8b7355] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),"Refresh \uD83D\uDD04"]}),(0,a.jsxs)(r.z,{onClick:()=>{eD(null),eC(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Add API Config ➕"]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,a.jsx)(r.z,{onClick:()=>ew("image_generation"),variant:"image_generation"===eN?"default":"outline",className:"rounded-xl font-black",style:{fontFamily:"Comic Sans MS, cursive"},children:"Image Generation \uD83C\uDFA8"}),(0,a.jsx)(r.z,{onClick:()=>ew("video_generation"),variant:"video_generation"===eN?"default":"outline",className:"rounded-xl font-black",style:{fontFamily:"Comic Sans MS, cursive"},children:"Video Generation \uD83C\uDFAC"})]})]}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[!eE&&ey.filter(e=>e.type===eN).map((e,s)=>(0,a.jsx)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"p-4 border-2 border-[#8b7355] rounded-xl bg-[#f5f1e8]/30 hover:bg-[#f5f1e8]/50 transition-all",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-xl font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:e.name}),(0,a.jsx)(o.C,{className:"".concat(e.is_default?"bg-[#d4a574]":"bg-[#8b7355]"," text-white font-bold"),children:e.is_default?"默认":"优先级 ".concat(e.priority)}),(0,a.jsx)(o.C,{className:"".concat(e.is_active?"bg-green-500":"bg-red-500"," text-white font-bold"),children:e.is_active?"启用":"禁用"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Provider:"}),(0,a.jsx)("p",{className:"text-[#2d3e2d]",children:e.provider})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Model:"}),(0,a.jsx)("p",{className:"text-[#2d3e2d]",children:e.model||"None"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Success Rate:"}),(0,a.jsxs)("p",{className:"text-[#2d3e2d]",children:[e.success_count+e.error_count>0?Math.round(e.success_count/(e.success_count+e.error_count)*100):0,"% (",e.success_count,"/",e.success_count+e.error_count,")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold text-[#8b7355]",children:"Last Used:"}),(0,a.jsx)("p",{className:"text-[#2d3e2d]",children:e.last_used_at?new Date(e.last_used_at).toLocaleDateString():"Never"})]})]}),e.last_error_message&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("span",{className:"font-bold text-red-600",children:"Last Error:"}),(0,a.jsx)("p",{className:"text-red-700 text-sm",children:e.last_error_message})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",onClick:()=>{eD(e),eC(!0)},title:"Edit API Configuration",children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-blue-500 hover:text-blue-700",onClick:async s=>{s.preventDefault(),confirm("Are you sure you want to copy this API configuration?")&&await sz(e)},title:"Copy API Configuration",children:(0,a.jsx)(Y.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:async s=>{if(s.preventDefault(),confirm("Are you sure you want to delete this API configuration?"))try{let s=await fetch("/api/admin/api-configs/".concat(e.id),{method:"DELETE"});if(s.ok)await sp();else{let e=await s.json().catch(()=>({error:"Unknown error"}));alert(e.error||"Failed to delete API configuration")}}catch(s){console.error("Error deleting API config:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Failed to delete API configuration: ".concat(e))}},title:"Delete API Configuration",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})})]})]})},e.id)),eE&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg font-black text-[#8b7355]",style:{fontFamily:"Comic Sans MS, cursive"},children:"Loading API configurations... \uD83D\uDD04"})]}),!eE&&0===ey.filter(e=>e.type===eN).length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("p",{className:"text-xl font-black text-[#8b7355] mb-4",style:{fontFamily:"Comic Sans MS, cursive"},children:["No ","image_generation"===eN?"Image":"Video"," Generation APIs configured yet! \uD83D\uDE80"]}),(0,a.jsx)("p",{className:"text-[#8b7355] mb-4",children:"Add your first API configuration to start generating amazing content."}),(0,a.jsxs)(r.z,{onClick:()=>{eD(null),eC(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Add Your First API Config ✨"]})]})]})})]})})}),"admin"===er&&(0,a.jsx)(n.nU,{value:"styles",className:"space-y-6",children:(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:eq?(0,a.jsx)(ex,{style:eV,onSave:async e=>{try{let s=eV?"/api/admin/styles/".concat(eV.id):"/api/admin/styles",t=await fetch(s,{method:eV?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)await sg(),eJ(!1),eB(null),alert(eV?"✅ Style updated successfully!":"✅ Style created successfully!");else{let e=await t.json().catch(()=>({error:"Unknown error"}));alert("❌ Failed to ".concat(eV?"update":"create"," style: ").concat(e.error||"Unknown error"))}}catch(s){console.error("Error saving style:",s);let e=s instanceof Error?s.message:"Unknown error";alert("❌ Failed to ".concat(eV?"update":"create"," style: ").concat(e))}},onCancel:()=>{eJ(!1),eB(null)},isLoading:!1}):(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#8b7355] rounded-2xl shadow-lg",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(G.Z,{className:"w-8 h-8 mr-3"}),"Style Management \uD83C\uDFAD"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(r.z,{onClick:async()=>{let e=await fetch("/api/admin/styles/fix-templates"),s=await e.json();if(s.problematicCount>0){if(confirm("发现 ".concat(s.problematicCount," 个风格缺少 {prompt} 占位符。是否自动修复？"))){let e=await fetch("/api/admin/styles/fix-templates",{method:"POST"}),s=await e.json();s.success?(alert("✅ 成功修复了 ".concat(s.fixedCount," 个风格模板！")),sg()):alert("❌ 修复失败: ".concat(s.error))}}else alert("✅ 所有风格模板都正常，包含 {prompt} 占位符！")},className:"bg-orange-500 hover:bg-orange-600 text-white font-black px-4 py-2 rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(Q.Z,{className:"w-4 h-4 mr-1"}),"Fix Templates"]}),(0,a.jsxs)(r.z,{onClick:()=>{console.log("\uD83D\uDD04 Manual refresh triggered"),sg()},variant:"outline",size:"sm",className:"border-[#8b7355] text-[#8b7355] hover:bg-[#8b7355] hover:text-white font-black rounded-xl",style:{fontFamily:"Comic Sans MS, cursive"},disabled:eR,children:[(0,a.jsx)(_.Z,{className:"w-4 h-4 mr-1"}),"Refresh"]}),(0,a.jsxs)(r.z,{onClick:()=>{eB(null),eJ(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Add Style ✨"]})]})]})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[!eR&&eZ.map((e,s)=>(0,a.jsx)(H.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"p-4 border-2 border-[#8b7355] rounded-xl bg-[#f5f1e8]/30 hover:bg-[#f5f1e8]/50 transition-all",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:e.image_url?(0,a.jsx)("img",{src:e.image_url,alt:e.name,className:"w-16 h-16 object-cover rounded-xl border-2 border-[#8b7355]"}):(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-[#8b7355] to-[#2d3e2d] rounded-xl flex items-center justify-center text-2xl",children:e.emoji||"\uD83C\uDFA8"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsxs)("h3",{className:"text-xl font-black text-[#2d3e2d]",style:{fontFamily:"Comic Sans MS, cursive"},children:[e.emoji," ",e.name]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(o.C,{variant:"outline",className:"text-xs",children:e.type}),(0,a.jsx)(o.C,{variant:"outline",className:"text-xs",children:e.category}),e.is_premium&&(0,a.jsx)(o.C,{className:"text-xs bg-[#d4a574] text-[#2d3e2d]",children:"Premium"}),(0,a.jsx)(o.C,{className:"text-xs ".concat(e.is_active?"bg-green-500":"bg-red-500"," text-white"),children:e.is_active?"Active":"Inactive"})]})]}),(0,a.jsx)("p",{className:"text-[#8b7355] font-bold text-sm mb-2",style:{fontFamily:"Comic Sans MS, cursive"},children:e.description}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,a.jsx)("strong",{children:"Prompt Template:"})," ",e.prompt_template.length>100?e.prompt_template.substring(0,100)+"...":e.prompt_template]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-[#8b7355] hover:text-[#2d3e2d]",onClick:()=>{eB(e),eJ(!0)},children:(0,a.jsx)(O.Z,{className:"w-4 h-4"})}),(0,a.jsx)(r.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700",onClick:async s=>{if(s.preventDefault(),confirm("Are you sure you want to delete this style?"))try{let s=await fetch("/api/admin/styles/".concat(e.id),{method:"DELETE"});if(s.ok)await sg();else{let e=await s.json().catch(()=>({error:"Unknown error"}));alert(e.error||"Failed to delete style")}}catch(s){console.error("Error deleting style:",s);let e=s instanceof Error?s.message:"Unknown error";alert("Failed to delete style: ".concat(e))}},children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})})]})]})},e.id)),eR&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8b7355] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg font-black text-[#8b7355] mb-2",style:{fontFamily:"Comic Sans MS, cursive"},children:"Loading styles... \uD83D\uDD04"}),(0,a.jsx)("p",{className:"text-sm text-[#8b7355] opacity-75",style:{fontFamily:"Comic Sans MS, cursive"},children:"This may take a few seconds..."}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("p",{className:"text-xs text-gray-500",style:{fontFamily:"Comic Sans MS, cursive"},children:"If loading takes too long, try refreshing the page"})})]}),!eR&&eT&&0===eZ.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-xl font-black text-[#8b7355] mb-4",style:{fontFamily:"Comic Sans MS, cursive"},children:"No styles configured yet! \uD83C\uDFA8"}),(0,a.jsx)("p",{className:"text-[#8b7355] mb-6",children:"Create your first style to get started."}),(0,a.jsxs)(r.z,{onClick:()=>{eB(null),eJ(!0)},className:"bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black px-6 py-3 rounded-2xl transform hover:scale-105 transition-all text-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(U.Z,{className:"w-5 h-5 mr-2"}),"Add Your First Style ✨"]})]})]})})]})})}),"admin"===er&&(0,a.jsx)(n.nU,{value:"payment",className:"space-y-6",children:(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#2d3e2d] rounded-2xl shadow-lg",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(A.Z,{className:"w-8 h-8 mr-3"}),"Payment System Management \uD83D\uDCB3"]}),(0,a.jsx)(i.SZ,{className:"text-[#8b7355] text-lg",children:"管理支付提供商、订阅计划和交易配置"})]}),(0,a.jsx)(i.aY,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(A.Z,{className:"w-16 h-16 text-[#d4a574] mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-2xl font-black text-[#2d3e2d] mb-2",style:{fontFamily:"Comic Sans MS, cursive"},children:"Payment Configuration Required \uD83D\uDD27"}),(0,a.jsx)("p",{className:"text-[#8b7355] mb-6",children:"Configure your payment providers and subscription plans to enable payment processing."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(r.z,{onClick:()=>{window.open("/admin/payment","_blank")},className:"w-full bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black px-6 py-4 rounded-2xl transform hover:scale-105 transition-all text-lg",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(A.Z,{className:"w-5 h-5 mr-2"}),"Open Payment Management \uD83D\uDE80"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(i.Zb,{className:"border-2 border-[#8b7355] rounded-xl p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-[#2d3e2d] mb-2",children:"\uD83D\uDCCB Setup Steps:"}),(0,a.jsxs)("ul",{className:"text-sm text-[#8b7355] space-y-1 text-left",children:[(0,a.jsx)("li",{children:"• Configure database migration"}),(0,a.jsx)("li",{children:"• Add payment providers (Stripe/PayPal)"}),(0,a.jsx)("li",{children:"• Create subscription plans"}),(0,a.jsx)("li",{children:"• Test payment integration"})]})]}),(0,a.jsxs)(i.Zb,{className:"border-2 border-[#d4a574] rounded-xl p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-[#2d3e2d] mb-2",children:"\uD83D\uDD12 Security Features:"}),(0,a.jsxs)("ul",{className:"text-sm text-[#8b7355] space-y-1 text-left",children:[(0,a.jsx)("li",{children:"• Amount tampering prevention"}),(0,a.jsx)("li",{children:"• Webhook signature verification"}),(0,a.jsx)("li",{children:"• Encrypted payment sessions"}),(0,a.jsx)("li",{children:"• Audit logging"})]})]})]})]})]})})]})})}),(0,a.jsx)(n.nU,{value:"settings",className:"space-y-6",children:(0,a.jsx)(H.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,a.jsxs)(i.Zb,{className:"bg-white border-4 border-[#2d3e2d] rounded-2xl shadow-lg",children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)(i.ll,{className:"text-3xl font-black text-[#2d3e2d] flex items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(P.Z,{className:"w-8 h-8 mr-3"}),"Settings & Quick Actions ⚙️"]}),(0,a.jsx)(i.SZ,{className:"text-[#8b7355] text-lg",children:"Manage your account and access platform features"})]}),(0,a.jsxs)(i.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["admin"===er&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.z,{onClick:()=>window.open("/admin/payment","_blank"),className:"w-full bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(A.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"Payment Management"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"Configure payment providers"})]}),(0,a.jsxs)(r.z,{onClick:()=>el("api-configs"),className:"w-full bg-[#8b7355] hover:bg-[#6d5a42] text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(M.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"API Configurations"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"Manage AI service providers"})]}),(0,a.jsxs)(r.z,{onClick:()=>el("styles"),className:"w-full bg-[#2d3e2d] hover:bg-[#1a2a1a] text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(G.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"Style Management"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"Create and edit art styles"})]}),(0,a.jsxs)(r.z,{onClick:()=>window.open("/admin/magic-coins","_blank"),className:"w-full bg-yellow-500 hover:bg-yellow-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(K.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"Magic Coins"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"Manage magic coin system"})]}),(0,a.jsxs)(r.z,{onClick:()=>el("users"),className:"w-full bg-green-500 hover:bg-green-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(k.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"User Management"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"View and manage users"})]}),(0,a.jsxs)(r.z,{onClick:()=>el("images"),className:"w-full bg-purple-500 hover:bg-purple-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(D.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"Image Gallery"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"Browse all user images"})]})]}),(0,a.jsxs)(r.z,{onClick:()=>el("overview"),className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-black rounded-2xl p-4 h-auto flex flex-col items-center",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(_.Z,{className:"w-8 h-8 mb-2"}),(0,a.jsx)("span",{children:"Dashboard Overview"}),(0,a.jsx)("span",{className:"text-xs opacity-75",children:"View platform statistics"})]})]}),(0,a.jsxs)("div",{className:"border-t-2 border-[#8b7355] pt-6",children:[(0,a.jsx)("h4",{className:"text-xl font-black text-[#2d3e2d] mb-4",style:{fontFamily:"Comic Sans MS, cursive"},children:"Account Actions \uD83D\uDC64"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(r.z,{onClick:sj,className:"w-full bg-red-500 hover:bg-red-600 text-white font-black rounded-2xl p-3",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(C.Z,{className:"w-4 h-4 mr-2"}),"Sign Out \uD83D\uDEAA"]}),(0,a.jsxs)(r.z,{onClick:()=>window.open("/","_blank"),className:"w-full bg-[#d4a574] hover:bg-[#c19660] text-[#2d3e2d] font-black rounded-2xl p-3",style:{fontFamily:"Comic Sans MS, cursive"},children:[(0,a.jsx)(R.Z,{className:"w-4 h-4 mr-2"}),"View Main Site \uD83C\uDF10"]})]})]}),(0,a.jsxs)("div",{className:"border-t-2 border-[#8b7355] pt-6",children:[(0,a.jsx)("h4",{className:"text-xl font-black text-[#2d3e2d] mb-4",style:{fontFamily:"Comic Sans MS, cursive"},children:"System Information ℹ️"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"bg-[#f5f1e8] p-4 rounded-xl border border-[#8b7355]",children:[(0,a.jsx)("div",{className:"font-bold text-[#2d3e2d] mb-2",children:"Account Details"}),(0,a.jsxs)("div",{className:"text-[#8b7355] space-y-1",children:[(0,a.jsxs)("div",{children:["Email: ",(null==sh?void 0:null===(et=sh.user)||void 0===et?void 0:et.email)||"Not available"]}),(0,a.jsxs)("div",{children:["Role: ","admin"===er?"Administrator \uD83D\uDC51":"User \uD83D\uDC64"]}),(0,a.jsxs)("div",{children:["Status: ",sh?"Authenticated ✅":"Not logged in ❌"]})]})]}),(0,a.jsxs)("div",{className:"bg-[#f5f1e8] p-4 rounded-xl border border-[#8b7355]",children:[(0,a.jsx)("div",{className:"font-bold text-[#2d3e2d] mb-2",children:"Platform Stats"}),(0,a.jsxs)("div",{className:"text-[#8b7355] space-y-1",children:[(0,a.jsxs)("div",{children:["Total Users: ",eu.totalUsers]}),(0,a.jsxs)("div",{children:["Total Images: ",eu.totalImages]}),(0,a.jsxs)("div",{children:["Revenue: $",eu.revenue]})]})]})]})]})]})]})})})]})]}),(0,a.jsx)(eh,{})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#f5f1e8] via-[#e8dcc0] to-[#d4a574] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-[#2d3e2d] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-[#2d3e2d] font-bold",style:{fontFamily:"Comic Sans MS, cursive"},children:"Loading magical dashboard... ✨"})]})})}function ep(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#f5f1e8] to-[#ede7d3] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-[#d4a574] mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-[#2d3e2d] font-black text-xl",style:{fontFamily:"Comic Sans MS, cursive"},children:"Loading Admin Dashboard... ⚡"})]})}),children:(0,a.jsx)(ef,{})})}t(62420)},7053:function(e,s,t){"use strict";t.d(s,{default:function(){return m},d:function(){return d},V:function(){return c}});var a=t(18376),l=t(57894),r=t(98130);function i(e){let{children:s,...t}=e;return(0,a.jsx)(r.f,{...t,children:s})}let n=(0,l.createContext)({data:null,status:"unauthenticated",update:async()=>null});function o(e){let{children:s}=e;return(0,a.jsx)(n.Provider,{value:{data:null,status:"unauthenticated",update:async()=>null},children:s})}function c(){let[e]=l.useState({data:null,status:"unauthenticated",update:async()=>null});try{let e=(0,l.useContext)(n);if(e)return e}catch(e){console.debug("MockSessionContext not available:",e)}return e}async function d(e){window.location.href=(null==e?void 0:e.callbackUrl)||"/"}function m(e){let{children:s}=e;return(0,a.jsx)(o,{children:(0,a.jsx)(i,{attribute:"class",defaultTheme:"dark",enableSystem:!1,disableTransitionOnChange:!0,storageKey:void 0,children:s})})}},46859:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var a=t(18376);t(57894);var l=t(30330),r=t(58755);let i=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...l}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:t}),s),...l})}},65354:function(e,s,t){"use strict";t.d(s,{z:function(){return c}});var a=t(18376),l=t(57894),r=t(7116),i=t(30330),n=t(58755);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,s)=>{let{className:t,variant:l,size:i,asChild:c=!1,...d}=e,m=c?r.g7:"button";return(0,a.jsx)(m,{className:(0,n.cn)(o({variant:l,size:i,className:t})),ref:s,...d})});c.displayName="Button"},95801:function(e,s,t){"use strict";t.d(s,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return o}});var a=t(18376),l=t(57894),r=t(58755);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})});i.displayName="Card";let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...l})});n.displayName="CardHeader";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...l})});o.displayName="CardTitle";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",t),...l})});c.displayName="CardDescription";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...l})});d.displayName="CardContent",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",t),...l})}).displayName="CardFooter"},31554:function(e,s,t){"use strict";t.d(s,{I:function(){return i}});var a=t(18376),l=t(57894),r=t(58755);let i=l.forwardRef((e,s)=>{let{className:t,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...i})});i.displayName="Input"},41775:function(e,s,t){"use strict";t.d(s,{_:function(){return c}});var a=t(18376),l=t(57894),r=t(77639),i=t(30330),n=t(58755);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.f,{ref:s,className:(0,n.cn)(o(),t),...l})});c.displayName=r.f.displayName},82878:function(e,s,t){"use strict";t.d(s,{Bw:function(){return f},Ph:function(){return d},Ql:function(){return p},i4:function(){return u},ki:function(){return m}});var a=t(18376),l=t(57894),r=t(74386),i=t(96889),n=t(78172),o=t(6772),c=t(58755);let d=r.fC;r.ZA;let m=r.B4,u=l.forwardRef((e,s)=>{let{className:t,children:l,...n}=e;return(0,a.jsxs)(r.xz,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[l,(0,a.jsx)(r.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=r.xz.displayName;let x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.u_,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...l,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});x.displayName=r.u_.displayName;let h=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.$G,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...l,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});h.displayName=r.$G.displayName;let f=l.forwardRef((e,s)=>{let{className:t,children:l,position:i="popper",...n}=e;return(0,a.jsx)(r.h_,{children:(0,a.jsxs)(r.VY,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...n,children:[(0,a.jsx)(x,{}),(0,a.jsx)(r.l_,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,a.jsx)(h,{})]})})});f.displayName=r.VY.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.__,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...l})}).displayName=r.__.displayName;let p=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(r.ck,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.wU,{children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(r.eT,{children:l})]})});p.displayName=r.ck.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...l})}).displayName=r.Z0.displayName},36419:function(e,s,t){"use strict";t.d(s,{i:function(){return n}});var a=t(18376),l=t(57894),r=t(26696),i=t(58755);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsxs)(r.fC,{ref:s,className:(0,i.cn)("relative flex w-full touch-none select-none items-center",t),...l,children:[(0,a.jsx)(r.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(r.e6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(r.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});n.displayName=r.fC.displayName},44911:function(e,s,t){"use strict";t.d(s,{r:function(){return n}});var a=t(18376),l=t(57894),r=t(17162),i=t(58755);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,ref:s,children:(0,a.jsx)(r.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});n.displayName=r.fC.displayName},92392:function(e,s,t){"use strict";t.d(s,{SP:function(){return c},dr:function(){return o},mQ:function(){return n},nU:function(){return d}});var a=t(18376),l=t(57894),r=t(28048),i=t(58755);let n=r.fC,o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});o.displayName=r.aV.displayName;let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});c.displayName=r.xz.displayName;let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});d.displayName=r.VY.displayName},53922:function(e,s,t){"use strict";t.d(s,{g:function(){return i}});var a=t(18376),l=t(57894),r=t(58755);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});i.displayName="Textarea"},58755:function(e,s,t){"use strict";t.d(s,{cn:function(){return r}});var a=t(4941),l=t(48244);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.m6)((0,a.W)(s))}}},function(e){e.O(0,[8166,7198,2593,8048,8176,6860,7345,6082,8922,5996,1744],function(){return e(e.s=68628)}),_N_E=e.O()}]);