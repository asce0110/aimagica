(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3928],{96127:function(e,t,a){Promise.resolve().then(a.bind(a,61508))},61508:function(e,t,a){"use strict";a.d(t,{default:function(){return G}});var s=a(18376),r=a(57894),o=a(16860),l=a(65354),n=a(31554),i=a(67756),c=a(46859),d=a(92392),m=a(53922),u=a(29488),g=a(77456),h=a(42857),x=a(96823),f=a(84207),p=a(19167),b=a(96433),w=a(11948),y=a(6772),v=a(19472),k=a(74010),j=a(60265),N=a(20505),S=a(69717),C=a(7053),I=a(39352),A=a(95046),D=a(4738);function _(e){let{items:t,columns:a=4,gap:n=16,itemMinWidth:i=250,renderItem:c,onLoadMore:d,hasMore:m=!1,loading:u=!1,className:g="",initialRenderCount:h=12,overscan:x=5}=e,f=(0,r.useRef)(null),[p,b]=(0,r.useState)(0),[w,y]=(0,r.useState)(0),[v,k]=(0,r.useState)(0),[j,N]=(0,r.useState)(new Map),[S,C]=(0,r.useState)({start:0,end:h}),[I,A]=(0,r.useState)(!0),_=(0,r.useMemo)(()=>!p||a<=2?a:Math.max(1,Math.min(a,Math.floor(p/(i+n)))),[p,a,i,n]),z=(0,r.useMemo)(()=>{let e=(p-n*(_-1))/_,a=Array(_).fill(0),s=[];return t.forEach((t,r)=>{let o=a.indexOf(Math.min(...a)),l=j.get(t.id)||t.height||300;s.push({left:o*(e+n),top:a[o],width:e,height:l,column:o}),a[o]+=l+n}),{positions:s,totalHeight:Math.max(...a),columnWidth:e}},[t,_,p,n,j]);(0,r.useEffect)(()=>{if(!z.positions.length||I)return;let e=w+v,a=z.positions.length,s=0;z.positions.forEach((t,r)=>{let o=t.top;t.top+t.height>=w-x*t.height&&o<=e+x*t.height&&(a=Math.min(a,r),s=Math.max(s,r+1))}),a=Math.max(0,a),s=Math.min(t.length,Math.max(s,a+1)),C({start:a,end:s})},[w,v,z.positions,x,I]),(0,r.useEffect)(()=>{let e=f.current;if(!e)return;let t=new ResizeObserver(e=>{let t=e[0];t&&(b(t.contentRect.width),k(t.contentRect.height))});return t.observe(e),()=>t.disconnect()},[]),(0,r.useEffect)(()=>{let e=()=>{f.current&&y(window.scrollY)};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]);let E=(0,r.useCallback)((e,t)=>{N(a=>{let s=new Map(a);return a.get(e)!==t&&t>0?(s.set(e,t),s):a})},[]);(0,r.useEffect)(()=>{if(I&&t.length>0){let e=setTimeout(()=>{A(!1)},100);return()=>clearTimeout(e)}},[t.length,I]),(0,r.useEffect)(()=>{if(!d||!m||u)return;let e=()=>{let{scrollTop:e,scrollHeight:t,clientHeight:a}=document.documentElement;e+a>=t-1e3&&d()};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[d,m,u]);let M=(0,r.useMemo)(()=>{let{start:e,end:a}=I?{start:0,end:Math.min(h,t.length)}:S;return t.slice(e,a).map((t,a)=>{let r=e+a,l=z.positions[r];return l?(0,s.jsx)(o.E.div,{className:"absolute",style:{left:l.left,top:l.top,width:l.width},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:a%_*.1},children:(0,s.jsx)(L,{item:t,index:r,onHeightChange:E,renderItem:c})},t.id):null})},[t,S,z.positions,c,E,_,I,h]);return(0,s.jsxs)("div",{ref:f,className:"relative w-full ".concat(g),children:[(0,s.jsx)("div",{style:{height:z.totalHeight}}),(0,s.jsx)("div",{className:"absolute inset-0",children:M}),m&&(0,s.jsx)("div",{className:"flex justify-center mt-8 relative z-10",children:(0,s.jsx)(l.z,{onClick:d,disabled:u,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform hover:scale-105 transition-all duration-200",children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.E.div,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Loading Magic..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Z,{className:"w-5 h-5 mr-2"}),"Load More Magic ✨"]})})})]})}function L(e){let{item:t,index:a,onHeightChange:o,renderItem:l}=e,n=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=n.current;if(!e)return;let a=new ResizeObserver(e=>{let a=e[0];if(a){let e=a.contentRect.height;e>0&&o(t.id,e)}});a.observe(e);let s=e.offsetHeight;return s>0&&o(t.id,s),()=>{a.disconnect()}},[t.id,o]),(0,s.jsx)("div",{ref:n,className:"w-full",children:l(t,a)})}var z=a(95801),E=a(52609),M=a(12513);function P(e){let{id:t,url:a,title:l,author:n,likes:i,views:d,isPremium:m=!1,isFeatured:u=!1,isLiked:h=!1,createdAt:p,size:w="medium",rotation:y=0,onClick:v,priority:k=!1,waterfallHeight:j}=e,[N,S]=(0,r.useState)(!1),[C,I]=(0,r.useState)(k),[D,_]=(0,r.useState)(!1),[L,P]=(0,r.useState)(),F=(0,r.useRef)(null),T=(0,r.useRef)(null),R=(0,A.ZP)(a);(0,r.useEffect)(()=>{if(k)return;if(F.current){let e=F.current.getBoundingClientRect();if(e.top<window.innerHeight&&e.bottom>0){I(!0);return}}let e=new IntersectionObserver(t=>{let a=t[0];(null==a?void 0:a.isIntersecting)&&(I(!0),e.disconnect())},{rootMargin:"100px",threshold:.05});return F.current&&e.observe(F.current),()=>e.disconnect()},[k]);let Z=()=>j||(window.innerWidth<768?({vertical:350,horizontal:200,small:250,medium:300,large:380})[w]||300:({vertical:400,horizontal:225,small:300,medium:375,large:450})[w]||375);return(0,s.jsxs)(o.E.div,{ref:F,className:"break-inside-avoid mb-4 relative cursor-pointer",onClick:v,style:{transform:"rotate(".concat(y,"deg)")},whileHover:{scale:1.03,zIndex:10,rotate:0,transition:{duration:.2}},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,s.jsx)(z.Zb,{className:"group overflow-hidden bg-white/60 backdrop-blur-sm border-white/30 shadow-lg hover:shadow-xl transition-all duration-300",children:(0,s.jsx)(z.aY,{className:"p-0",children:(0,s.jsx)("div",{className:"w-full relative bg-white rounded-md p-1",children:(0,s.jsxs)("div",{className:"w-full bg-white rounded-sm overflow-hidden relative",style:{...j?{height:Z()}:{aspectRatio:"vertical"===w?"3/4":"horizontal"===w?"4/3":"small"===w?"1/1":"medium"===w?"4/5":"large"===w?"3/4":"4/5",minHeight:Z()}},children:[!N&&(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-[#f5f1e8] to-[#ebe5d6] flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"relative w-12 h-12 mx-auto mb-2",children:[(0,s.jsx)("div",{className:"absolute inset-0 rounded-full border-2 border-[#d4a574]/40 animate-spin"}),(0,s.jsx)("div",{className:"absolute inset-1 rounded-full border-2 border-[#8b7355]/60 animate-[spin_1.5s_linear_infinite_reverse]"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(g.Z,{className:"w-5 h-5 text-[#8b7355] animate-pulse"})}),(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-[#d4a574] rounded-full animate-ping"}),(0,s.jsx)("div",{className:"absolute -bottom-1 -left-1 w-2 h-2 bg-[#8b7355] rounded-full animate-ping delay-300"}),(0,s.jsx)("div",{className:"absolute top-1 -left-1 w-1.5 h-1.5 bg-[#d4a574]/80 rounded-full animate-ping delay-500"}),(0,s.jsx)("div",{className:"absolute -bottom-1 right-1 w-1.5 h-1.5 bg-[#8b7355]/80 rounded-full animate-ping delay-700"})]}),(0,s.jsx)("div",{className:"text-sm text-[#8b7355] font-bold",style:{fontFamily:"var(--font-accent)"},children:C?"✨ Casting...":"\uD83D\uDD2E Waiting..."})]})}),D&&(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-[#f5f1e8] to-[#e1d4c0] flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 mx-auto mb-2 bg-gradient-to-br from-[#d4a574]/30 to-[#8b7355]/30 rounded-lg border-2 border-dashed border-[#8b7355]/40 flex items-center justify-center transform rotate-12",children:(0,s.jsx)(E.Z,{className:"w-6 h-6 text-[#8b7355]/60"})}),(0,s.jsx)("div",{className:"text-sm text-[#8b7355]/80 font-bold mb-1",style:{fontFamily:"var(--font-accent)"},children:"\uD83D\uDD2E Magic Failed"}),(0,s.jsx)("button",{className:"text-xs text-[#8b7355] font-medium hover:text-[#6b5d3f] transition-colors px-2 py-1 rounded bg-[#d4a574]/20 hover:bg-[#d4a574]/30",onClick:e=>{e.stopPropagation(),_(!1),S(!1),I(!0)},children:"Try Again ✨"})]})}),C&&!D&&(0,s.jsx)("img",{ref:T,src:R,alt:l,className:"w-full h-full object-cover transition-opacity duration-300 ".concat(N?"opacity-100":"opacity-0"),loading:k?"eager":"lazy",onLoad:e=>{let a=e.currentTarget;P(a.naturalHeight*(a.offsetWidth/a.naturalWidth)),S(!0),_(!1),console.log("✅ Gallery图片加载成功:",{id:t,title:l,url:R,dimensions:"".concat(a.naturalWidth,"x").concat(a.naturalHeight)})},onError:e=>{console.error("❌ Gallery图片加载失败:",{id:t,title:l,url:R,error:e}),_(!0),S(!0)},fetchPriority:k?"high":"auto",decoding:"async"}),(0,s.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-2 md:p-3 z-10",children:[(0,s.jsx)("h3",{className:"text-white font-bold text-xs md:text-sm mb-1 line-clamp-2",children:l}),(0,s.jsxs)("p",{className:"text-gray-300 text-xs line-clamp-1",children:["by ",n]})]}),(0,s.jsxs)("div",{className:"absolute top-2 left-2 flex gap-1 z-20",children:[u&&(0,s.jsx)(c.C,{variant:"secondary",className:"text-xs bg-yellow-500/80 text-white",children:(0,s.jsx)(M.Z,{className:"h-3 w-3"})}),m&&(0,s.jsx)(c.C,{variant:"secondary",className:"text-xs bg-purple-500/80 text-white",children:(0,s.jsx)(x.Z,{className:"h-3 w-3"})})]}),(0,s.jsxs)("div",{className:"absolute bottom-1 md:bottom-2 right-1 md:right-2 flex items-center gap-1 md:gap-2 text-white text-xs z-20",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 bg-black/50 rounded px-1.5 md:px-2 py-0.5 md:py-1 backdrop-blur-sm",children:[(0,s.jsx)(f.Z,{className:"h-2.5 w-2.5 md:h-3 md:w-3"}),(0,s.jsx)("span",{className:"text-xs md:text-xs",children:i>1e3?"".concat((i/1e3).toFixed(1),"k"):i})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 bg-black/50 rounded px-1.5 md:px-2 py-0.5 md:py-1 backdrop-blur-sm",children:[(0,s.jsx)(b.Z,{className:"h-2.5 w-2.5 md:h-3 md:w-3"}),(0,s.jsx)("span",{className:"text-xs md:text-xs",children:d>1e3?"".concat((d/1e3).toFixed(1),"k"):d})]})]}),h&&(0,s.jsx)("div",{className:"absolute bottom-2 left-2 z-20",children:(0,s.jsx)(f.Z,{className:"w-4 h-4 text-red-500 fill-red-500"})})]})})})}),(0,s.jsx)("div",{className:"mt-2 flex justify-center",children:(0,s.jsx)("span",{className:"text-xs text-gray-500 font-medium",children:p})})]})}let F="https://aimagica-api.403153162.workers.dev",T=null,R=0;async function Z(){let e=Date.now();if(null!==T&&e-R<3e4)return T;try{let t=new AbortController,a=setTimeout(()=>t.abort(),1e3),s=await fetch("".concat(F,"/api/test"),{method:"GET",signal:t.signal,cache:"no-store"});return clearTimeout(a),T=s.ok,R=e,console.log("\uD83C\uDF10 网络检查结果: ".concat(T?"可用":"不可用")),T}catch(t){return T=!1,R=e,console.log("\uD83C\uDF10 网络检查失败，判定为不可用:",t),!1}}async function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{console.log("\uD83D\uDD04 API请求: ".concat(e));let a=new AbortController,s=setTimeout(()=>a.abort(),2e3),r=await fetch(e,{...t,signal:a.signal,headers:{"Content-Type":"application/json",...t.headers}});if(clearTimeout(s),!r.ok)throw Error("HTTP_".concat(r.status));return console.log("✅ API请求成功: ".concat(e)),r}catch(t){throw console.warn("⚠️ API请求失败: ".concat(t.message)),console.error("❌ API不可用，启用离线模式: ".concat(e)),Error("API_UNAVAILABLE")}}var V={toggleImageLike:async function(e){try{var t,a;console.log("❤️ 尝试切换点赞状态: ".concat(e));let s=await O("".concat(F,"/api/gallery/like/").concat(e),{method:"POST"}),r=await s.json();return console.log("✅ 点赞操作成功:",r),localStorage.setItem("gallery_likes_".concat(e),(null===(t=r.newCount)||void 0===t?void 0:t.toString())||"0"),localStorage.setItem("gallery_liked_".concat(e),(null===(a=r.liked)||void 0===a?void 0:a.toString())||"false"),{success:!0,liked:r.liked,newCount:r.newCount||0}}catch(o){console.warn("⚠️ API不可用，使用离线模式点赞: ".concat(e),o);let t="true"===localStorage.getItem("gallery_liked_".concat(e)),a=parseInt(localStorage.getItem("gallery_likes_".concat(e))||"0"),s=!t,r=s?a+1:Math.max(0,a-1);return localStorage.setItem("gallery_liked_".concat(e),s.toString()),localStorage.setItem("gallery_likes_".concat(e),r.toString()),console.log("\uD83D\uDCF1 离线点赞成功: ".concat(s,", 新数量: ").concat(r)),{success:!0,liked:s,newCount:r}}},incrementImageView:async function(e){try{console.log("\uD83D\uDC41️ 增加浏览量: ".concat(e));let t=(await O("".concat(F,"/api/gallery/view/").concat(e),{method:"POST"})).ok;return console.log("".concat(t?"✅":"⚠️"," 浏览量").concat(t?"增加成功":"增加失败",": ").concat(e)),t}catch(t){return console.warn("⚠️ 浏览量增加失败: ".concat(e),t),!1}},getImageComments:async function(e){try{console.log("\uD83D\uDCAC 尝试获取图片评论: ".concat(e));let t=await O("".concat(F,"/api/gallery/comments/").concat(e)),a=await t.json();if(console.log("✅ 评论获取成功:",a),a.success&&Array.isArray(a.comments)){let t=a.comments.map(t=>{let a="true"===localStorage.getItem("comment_liked_".concat(t.id)),s=parseInt(localStorage.getItem("comment_likes_".concat(t.id))||"0");return{id:t.id,imageId:t.imageId||e,content:t.content,author:t.author||"AIMAGICA User",authorAvatar:t.authorAvatar||"/images/aimagica-logo.png",createdAt:t.createdAt||new Date().toISOString(),likes:Math.max(t.likes||0,s),isLiked:t.isLiked||a}});return localStorage.setItem("gallery_comments_data_".concat(e),JSON.stringify(t)),localStorage.setItem("gallery_comments_".concat(e),t.length.toString()),t}return[]}catch(t){console.warn("⚠️ API不可用，使用离线模式评论: ".concat(e),t);try{let t=localStorage.getItem("gallery_comments_data_".concat(e));if(t){let e=JSON.parse(t).map(e=>{var t;let a="true"===localStorage.getItem("comment_liked_".concat(e.id)),s=parseInt(localStorage.getItem("comment_likes_".concat(e.id))||(null===(t=e.likes)||void 0===t?void 0:t.toString())||"0");return{...e,likes:s,isLiked:a}});return console.log("\uD83D\uDCF1 使用缓存评论: ".concat(e.length,"条")),e}}catch(e){console.warn("缓存评论解析失败:",e)}return[]}},addImageComment:async function(e,t){try{if(console.log("\uD83D\uDCAC 开始添加评论: ".concat(e,", 内容长度: ").concat(t.length)),!t||0===t.trim().length)return console.warn("⚠️ 评论内容为空"),null;if(t.length>500)throw console.warn("⚠️ 评论内容过长"),Error("评论内容不能超过500字符");let a=await O("".concat(F,"/api/gallery/comments/").concat(e),{method:"POST",body:JSON.stringify({content:t.trim(),author:"AIMAGICA User"})});if(!a.ok){let e=await a.text();throw console.error("❌ API响应错误: ".concat(a.status," ").concat(a.statusText),e),Error("服务器错误: ".concat(a.status))}let s=await a.json();if(console.log("✅ 评论添加成功:",s),s.success&&s.comment){let t={id:s.comment.id,imageId:e,content:s.comment.content,author:s.comment.author||"AIMAGICA User",authorAvatar:s.comment.authorAvatar||"/images/aimagica-logo.png",createdAt:s.comment.createdAt||new Date().toISOString(),likes:s.comment.likes||0,isLiked:!1},a=parseInt(localStorage.getItem("gallery_comments_".concat(e))||"0");localStorage.setItem("gallery_comments_".concat(e),(a+1).toString());try{let a=localStorage.getItem("gallery_comments_data_".concat(e)),s=a?JSON.parse(a):[];s.unshift(t),localStorage.setItem("gallery_comments_data_".concat(e),JSON.stringify(s))}catch(e){console.warn("缓存评论数据失败:",e)}return t}return null}catch(s){console.warn("⚠️ API不可用，使用离线模式添加评论: ".concat(e),s);let a={id:"offline_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),imageId:e,content:t.trim(),author:"AIMAGICA User",authorAvatar:"/images/aimagica-logo.png",createdAt:new Date().toISOString(),likes:0,isLiked:!1};try{let t=parseInt(localStorage.getItem("gallery_comments_".concat(e))||"0");localStorage.setItem("gallery_comments_".concat(e),(t+1).toString());let s=localStorage.getItem("gallery_comments_data_".concat(e)),r=s?JSON.parse(s):[];return r.unshift(a),localStorage.setItem("gallery_comments_data_".concat(e),JSON.stringify(r)),console.log("\uD83D\uDCF1 离线评论添加成功: ".concat(a.id)),a}catch(e){return console.error("离线评论存储失败:",e),null}}},toggleCommentLike:async function(e){try{console.log("\uD83D\uDC4D 切换评论点赞: ".concat(e));let s=await O("".concat(F,"/api/gallery/comment-like/").concat(e),{method:"POST"});if(s.ok){var t,a;let r=await s.json();return console.log("✅ 评论点赞成功: ".concat(e)),localStorage.setItem("comment_liked_".concat(e),(null===(t=r.liked)||void 0===t?void 0:t.toString())||"false"),localStorage.setItem("comment_likes_".concat(e),(null===(a=r.newCount)||void 0===a?void 0:a.toString())||"0"),{success:!0,liked:r.liked||!1,newCount:r.newCount||0}}throw Error("HTTP ".concat(s.status))}catch(o){console.warn("⚠️ API不可用，使用离线模式评论点赞: ".concat(e),o);let t="true"===localStorage.getItem("comment_liked_".concat(e)),a=parseInt(localStorage.getItem("comment_likes_".concat(e))||"0"),s=!t,r=s?a+1:Math.max(0,a-1);return localStorage.setItem("comment_liked_".concat(e),s.toString()),localStorage.setItem("comment_likes_".concat(e),r.toString()),console.log("\uD83D\uDCF1 离线评论点赞成功: ".concat(s,", 新数量: ").concat(r)),{success:!0,liked:s,newCount:r}}},getBatchImageStats:async function(e){if(!await Z()){console.log("\uD83D\uDCF1 网络不可用，直接使用离线模式统计: ".concat(e.length,"张图片"));let t={};return e.forEach(e=>{let a=parseInt(localStorage.getItem("gallery_likes_".concat(e))||"0"),s=parseInt(localStorage.getItem("gallery_views_".concat(e))||"0"),r=parseInt(localStorage.getItem("gallery_comments_".concat(e))||"0"),o="true"===localStorage.getItem("gallery_liked_".concat(e));t[e]={id:e,likes:a,comments:r,views:s,isLiked:o}}),t}try{console.log("\uD83D\uDCCA 网络可用，尝试批量获取图片统计: ".concat(e.length,"张图片"));let t=await O("".concat(F,"/api/gallery/batch-stats"),{method:"POST",body:JSON.stringify({imageIds:e})}),a=await t.json();return console.log("✅ 批量统计获取成功:",Object.keys(a.stats||{}).length),a.stats||{}}catch(a){console.warn("⚠️ API请求失败，使用离线模式统计: ".concat(e.length,"张图片"),a);let t={};return e.forEach(e=>{let a=parseInt(localStorage.getItem("gallery_likes_".concat(e))||"0"),s=parseInt(localStorage.getItem("gallery_views_".concat(e))||"0"),r=parseInt(localStorage.getItem("gallery_comments_".concat(e))||"0"),o="true"===localStorage.getItem("gallery_liked_".concat(e));t[e]={id:e,likes:a,comments:r,views:s,isLiked:o}}),console.log("\uD83D\uDCF1 使用本地缓存数据作为回退"),t}},quickNetworkCheck:Z};function G(){let{data:e}=(0,C.V)(),t=(0,A.ZP)("/images/aimagica-logo.png"),[a,D]=(0,r.useState)(()=>{try{var e;console.log("\uD83D\uDE80 Gallery初始化: 立即同步加载静态数据");let t=function(){let e=[{id:"fast-cat-wizard",url:"/images/examples/cat-wizard.svg",title:"魔法师小猫",author:"AIMAGICA User",authorAvatar:"/images/aimagica-logo.png",likes:1567,comments:103,views:6789,downloads:543,isPremium:!0,isFeatured:!0,isLiked:!1,createdAt:"5 days ago",prompt:"Cute cat wearing wizard hat and casting colorful magic spells with a wand",style:"Fantasy",tags:["cat","wizard","cute","magic","spells"],size:"medium",rotation:-2},{id:"fast-cyber-city",url:"/images/examples/cyber-city.svg",title:"赛博东京2099",author:"CyberArtist",authorAvatar:"/images/aimagica-logo.png",likes:982,comments:56,views:4321,downloads:321,isPremium:!0,isFeatured:!1,isLiked:!0,createdAt:"1 week ago",prompt:"Futuristic cyberpunk cityscape with neon lights, flying cars, and holographic advertisements",style:"Cyberpunk",tags:["cyberpunk","city","future","neon","scifi"],size:"horizontal",rotation:-1},{id:"fast-magic-forest",url:"/images/examples/magic-forest.svg",title:"魔法森林",author:"AIMAGICA",authorAvatar:"/images/aimagica-logo.png",likes:1243,comments:89,views:5678,downloads:432,isPremium:!1,isFeatured:!0,isLiked:!1,createdAt:"2 days ago",prompt:"A magical forest with glowing mushrooms, fairy lights, and mystical creatures hiding among ancient trees",style:"Fantasy",tags:["forest","magic","fantasy","glow","mystical"],size:"vertical",rotation:2},{id:"fast-space-art",url:"/images/examples/space-art.svg",title:"太空探索者",author:"StarGazer",authorAvatar:"/images/aimagica-logo.png",likes:756,comments:42,views:3210,downloads:198,isPremium:!1,isFeatured:!1,isLiked:!1,createdAt:"3 days ago",prompt:"Astronaut exploring an alien planet with strange flora and multiple moons in the sky",style:"Sci-Fi",tags:["space","astronaut","alien","planet","exploration"],size:"small",rotation:1.5},{id:"fast-cat-wizard-2",url:"/images/examples/cat-wizard.svg",title:"魔法师小猫 - 午夜版",author:"AIMAGICA Pro",authorAvatar:"/images/aimagica-logo.png",likes:892,comments:67,views:4123,downloads:234,isPremium:!1,isFeatured:!1,isLiked:!1,createdAt:"1 day ago",prompt:"Magical cat wizard casting spells under moonlight with glowing orbs",style:"Fantasy",tags:["cat","wizard","moonlight","magic","night"],size:"large",rotation:1.2},{id:"fast-cyber-city-2",url:"/images/examples/cyber-city.svg",title:"霓虹街区",author:"NeonArtist",authorAvatar:"/images/aimagica-logo.png",likes:1456,comments:78,views:5643,downloads:445,isPremium:!0,isFeatured:!0,isLiked:!0,createdAt:"4 days ago",prompt:"Vibrant neon-lit streets with holographic displays and futuristic architecture",style:"Cyberpunk",tags:["neon","street","hologram","future","city"],size:"vertical",rotation:-1.8},{id:"fast-magic-forest-2",url:"/images/examples/magic-forest.svg",title:"精灵之森",author:"ForestKeeper",authorAvatar:"/images/aimagica-logo.png",likes:723,comments:34,views:2897,downloads:156,isPremium:!1,isFeatured:!1,isLiked:!1,createdAt:"6 days ago",prompt:"Enchanted forest realm with fairy creatures and glowing magical plants",style:"Fantasy",tags:["forest","fairy","enchanted","magic","nature"],size:"horizontal",rotation:.8},{id:"fast-space-art-2",url:"/images/examples/space-art.svg",title:"星际旅行",author:"CosmicDreamer",authorAvatar:"/images/aimagica-logo.png",likes:1034,comments:91,views:4576,downloads:378,isPremium:!0,isFeatured:!1,isLiked:!1,createdAt:"1 week ago",prompt:"Interstellar journey through colorful nebulae with spaceship and cosmic wonders",style:"Sci-Fi",tags:["space","nebula","journey","cosmic","stars"],size:"medium",rotation:-.5},{id:"fast-cat-wizard-3",url:"/images/examples/cat-wizard.svg",title:"魔法工坊",author:"MagicCrafter",authorAvatar:"/images/aimagica-logo.png",likes:634,comments:28,views:2145,downloads:89,isPremium:!1,isFeatured:!1,isLiked:!0,createdAt:"2 weeks ago",prompt:"Cat wizard in magical workshop surrounded by potions and spell books",style:"Fantasy",tags:["workshop","potion","magic","books","craft"],size:"small",rotation:.3},{id:"fast-cyber-city-3",url:"/images/examples/cyber-city.svg",title:"数字化都市",author:"DigitalVision",authorAvatar:"/images/aimagica-logo.png",likes:789,comments:45,views:3456,downloads:267,isPremium:!1,isFeatured:!0,isLiked:!1,createdAt:"3 weeks ago",prompt:"Digital metropolis with data streams and virtual reality interfaces",style:"Cyberpunk",tags:["digital","data","virtual","interface","tech"],size:"horizontal",rotation:1.1},{id:"fast-magic-forest-3",url:"/images/examples/magic-forest.svg",title:"古老圣地",author:"AncientWisdom",authorAvatar:"/images/aimagica-logo.png",likes:445,comments:19,views:1876,downloads:78,isPremium:!0,isFeatured:!1,isLiked:!1,createdAt:"1 month ago",prompt:"Ancient sacred grove with mystical runes and ethereal lighting",style:"Fantasy",tags:["ancient","sacred","runes","ethereal","grove"],size:"vertical",rotation:-1.3},{id:"fast-space-art-3",url:"/images/examples/space-art.svg",title:"银河边缘",author:"GalacticExplorer",authorAvatar:"/images/aimagica-logo.png",likes:1123,comments:67,views:4987,downloads:389,isPremium:!0,isFeatured:!0,isLiked:!0,createdAt:"2 weeks ago",prompt:"Edge of the galaxy with swirling cosmic dust and distant star clusters",style:"Sci-Fi",tags:["galaxy","cosmic","dust","stars","edge"],size:"large",rotation:.7}];return console.log("\uD83D\uDCCB 静态Gallery数据生成: ".concat(e.length,"张轻量级图片")),e}();if(console.log("\uD83D\uDCCA 静态数据加载结果:",{数据长度:(null==t?void 0:t.length)||0,数据类型:typeof t,前3项:null==t?void 0:null===(e=t.slice(0,3))||void 0===e?void 0:e.map(e=>({id:e.id,title:e.title}))}),t&&Array.isArray(t)&&t.length>0){let e=t.map(e=>({...e,dbLoaded:!0,localLikes:0,localViews:0,localComments:0,localIsLiked:!1}));return console.log("✅ Gallery初始化成功:",e.length,"张图片"),e}console.error("❌ Gallery初始化失败: 静态数据为空或无效")}catch(e){console.error("❌ Gallery初始化异常:",e)}return console.warn("⚠️ 使用紧急备用数据"),[{id:"emergency-cat",url:"/images/examples/cat-wizard.svg",title:"紧急备用 - 魔法师小猫",author:"AIMAGICA",authorAvatar:"/images/aimagica-logo.png",likes:0,comments:0,views:0,downloads:0,isPremium:!1,isFeatured:!1,isLiked:!1,createdAt:"now",prompt:"Emergency fallback image",style:"Fantasy",tags:["emergency"],size:"medium",rotation:0,dbLoaded:!0,localLikes:0,localViews:0,localComments:0,localIsLiked:!1}]}),[L,z]=(0,r.useState)([]),[E,M]=(0,r.useState)(1),[F,T]=(0,r.useState)(!1),[R,Z]=(0,r.useState)(!1),[O,G]=(0,r.useState)(null),[U,H]=(0,r.useState)([]),[W,B]=(0,r.useState)(!1),[J,Y]=(0,r.useState)("all"),[K,q]=(0,r.useState)(""),[$,Q]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),[et,ea]=(0,r.useState)(!1),[es,er]=(0,r.useState)(!1),[eo,el]=(0,r.useState)("idle"),[en,ei]=(0,r.useState)(""),[ec,ed]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=setTimeout(async()=>{if(console.log("\uD83D\uDD04 后台静默同步（10秒后）..."),"undefined"!=typeof navigator&&!1===navigator.onLine){console.log("⚠️ 离线环境，跳过数据库同步"),ee(!0);return}try{D(e=>e.map(e=>{try{let t=parseInt(localStorage.getItem("gallery_likes_".concat(e.id))||"0"),a=parseInt(localStorage.getItem("gallery_views_".concat(e.id))||"0"),s=parseInt(localStorage.getItem("gallery_comments_".concat(e.id))||"0"),r="true"===localStorage.getItem("gallery_liked_".concat(e.id));return{...e,localLikes:t,localViews:a,localComments:s,localIsLiked:r}}catch(t){return e}}));let e=new Promise((e,t)=>setTimeout(()=>t(Error("网络检查超时")),2e3)),t=V.quickNetworkCheck(),s=await Promise.race([t,e]);if(ee(!s),s&&a.length>0){let e=new Promise((e,t)=>setTimeout(()=>t(Error("数据库操作超时")),3e3)),t=em(a);await Promise.race([t,e])}}catch(e){console.warn("⚠️ 后台同步失败（预期行为）:",e.message),ee(!0)}},1e4);return()=>clearTimeout(e)},[]);let em=(0,r.useCallback)(async e=>{try{console.log("\uD83D\uDD04 加载数据库统计信息...");let t=e.map(e=>e.id.toString()),a=await V.getBatchImageStats(t);console.log("✅ 数据库统计加载成功: ".concat(Object.keys(a).length,"张图片")),D(e=>e.map(e=>{let t=a[e.id.toString()];return{...e,dbStats:t||{id:e.id.toString(),likes:0,comments:0,views:0,isLiked:!1},dbLoaded:!0,localLikes:(null==t?void 0:t.likes)||0,localIsLiked:(null==t?void 0:t.isLiked)||!1,localViews:(null==t?void 0:t.views)||0,localComments:(null==t?void 0:t.comments)||0}}))}catch(e){console.warn("⚠️ 数据库统计加载失败，显示默认数值:",e),D(e=>e.map(e=>({...e,dbLoaded:!0,localLikes:0,localIsLiked:!1,localViews:0,localComments:0})))}},[]);(0,r.useEffect)(()=>{let e=()=>Q(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let eu=(0,r.useMemo)(()=>{let e=a;if("all"!==J&&(e=e.filter(e=>e.style.toLowerCase()===J.toLowerCase())),K){let t=K.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.author.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t)))}return e},[a,J,K]);(0,r.useEffect)(()=>{z(eu.slice(0,12)),M(1)},[eu]),(0,r.useEffect)(()=>{let e=()=>{let e=window.location.hash;if(e.startsWith("#image-")){let t=e.replace("#image-",""),s=a.find(e=>e.id.toString()===t);s&&(G(s),setTimeout(()=>{window.history.replaceState(null,"",window.location.pathname+window.location.search)},1e3))}};return e(),window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)},[a]);let eg=(0,r.useCallback)(()=>{if(F)return;let e=E+1,t=12*E,a=eu.slice(t,t+12);0!==a.length&&(T(!0),setTimeout(()=>{z(e=>[...e,...a]),M(e),T(!1)},500))},[F,E,eu]),eh=L.length<eu.length,ex=(0,r.useMemo)(()=>L.map((e,t)=>({id:e.id,url:e.url,title:e.title,height:$?"vertical"===e.size?350:"horizontal"===e.size?200:"large"===e.size?380:"small"===e.size?250:300:Math.max(280,({vertical:550,horizontal:300,large:600,small:350,medium:450}[e.size]||450)+(t%5*25-50)),...e})),[L,$]),ef=(0,r.useCallback)(async e=>{let t=e.toString();console.log("❤️ 点赞图片: ".concat(t));let a=e=>{if(e.id.toString()===t){let t=!e.localIsLiked,a=t?e.localLikes+1:Math.max(0,e.localLikes-1);return{...e,localIsLiked:t,localLikes:a}}return e};z(e=>e.map(a)),D(e=>e.map(a)),O&&O.id.toString()===t&&G(e=>e?a(e):null);try{let e=await V.toggleImageLike(t);if(e.success){console.log("✅ 点赞同步成功: ".concat(e.liked));let a=a=>a.id.toString()===t?{...a,localIsLiked:e.liked,localLikes:e.newCount,dbLoaded:!0}:a;z(e=>e.map(a)),D(e=>e.map(a)),O&&O.id.toString()===t&&G(e=>e?a(e):null)}else console.warn("⚠️ 点赞同步失败，但UI已更新")}catch(e){console.warn("⚠️ 点赞同步异常，但UI已更新:",e)}},[O]),ep=(0,r.useCallback)(async e=>{G(e),console.log("\uD83D\uDDBC️ 打开图片详情: ".concat(e.title));let t=e.id.toString(),a=e=>e.id.toString()===t?{...e,localViews:e.localViews+1}:e;z(e=>e.map(a)),D(e=>e.map(a));try{await V.incrementImageView(t),console.log("✅ 浏览量同步成功")}catch(e){console.warn("⚠️ 浏览量同步失败:",e)}eb(t)},[]),eb=(0,r.useCallback)(async e=>{B(!0);try{console.log("\uD83D\uDCAC 加载图片评论: ".concat(e));let t=await V.getImageComments(e);H(t),console.log("✅ 评论加载成功: ".concat(t.length,"条"))}catch(e){console.warn("⚠️ 评论加载失败:",e),H([])}finally{B(!1)}},[]),ew=(0,r.useCallback)(async()=>{if(!O||!en.trim()||ec)return;let e=en.trim(),t=O.id.toString();if(e.length>500){alert("评论内容不能超过500字符");return}ed(!0);try{console.log("\uD83D\uDCAC 提交评论: ".concat(t,', 内容: "').concat(e.substring(0,50),'..."'));let a=await V.addImageComment(t,e);if(a){H(e=>[a,...e]),ei("");let e=e=>e.id.toString()===t?{...e,localComments:e.localComments+1}:e;z(t=>t.map(e)),D(t=>t.map(e)),console.log("✅ 评论提交成功")}else console.warn("⚠️ 评论提交失败：服务器返回空结果"),alert("评论提交失败，请稍后重试")}catch(t){console.error("❌ 评论提交异常:",t);let e=(null==t?void 0:t.message)||"网络错误";alert("评论提交失败: ".concat(e))}finally{ed(!1)}},[O,en,ec]),ey=(0,r.useCallback)(async e=>{try{let t=t=>{if(t.id===e){let e=!t.isLiked,a=e?t.likes+1:Math.max(0,t.likes-1);return{...t,isLiked:e,likes:a}}return t};H(e=>e.map(t));let a=await V.toggleCommentLike(e);a.success?(console.log("✅ 评论点赞成功"),H(t=>t.map(t=>t.id===e?{...t,isLiked:a.liked,likes:a.newCount}:t))):console.warn("⚠️ 评论点赞同步失败，但UI已更新")}catch(e){console.warn("⚠️ 评论点赞异常，但UI已更新:",e)}},[]),ev=(0,r.useCallback)(async()=>{if(!O)return;ea(!0);let e="".concat(window.location.origin,"/gallery#image-").concat(O.id),t={title:"".concat(O.title," - AIMAGICA Gallery"),text:'\uD83C\uDFA8 Amazing AI artwork: "'.concat(O.title,'" by ').concat(O.author,"\\n✨ Created with AI magic - check it out in our gallery!"),url:e};try{navigator.share&&$?(await navigator.share(t),el("shared")):(await navigator.clipboard.writeText(e),el("copied")),setTimeout(()=>el("idle"),2e3)}catch(e){console.warn("分享失败:",e)}ea(!1)},[O,$]),ek=(0,r.useCallback)(async()=>{if(O){er(!0);try{let e=await fetch(O.url),t=await e.blob(),a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="aimagica-".concat(O.title.replace(/[^a-zA-Z0-9]/g,"-"),"-").concat(O.id,".png"),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a)}catch(e){window.open(O.url,"_blank")}er(!1)}},[O]),ej=(0,r.useCallback)((e,t)=>(0,s.jsx)(P,{id:e.id,url:e.url,title:e.title,author:e.author,likes:e.localLikes,views:e.localViews,isPremium:e.isPremium,isFeatured:e.isFeatured,isLiked:e.localIsLiked,createdAt:e.createdAt,size:e.size,rotation:e.rotation,onClick:()=>ep(e),priority:t<8,waterfallHeight:e.height},e.id),[ep]);return(0,s.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,s.jsx)("header",{className:"p-4 md:p-6 bg-[#0a0a0a] border-b border-[#333] sticky top-0 z-50",children:(0,s.jsx)("div",{className:"container mx-auto",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer transform hover:scale-105 transition-all",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:t,alt:"AIMAGICA",className:"w-8 h-8 md:w-10 md:h-10 rounded-lg shadow-lg transform rotate-3 hover:rotate-0 transition-all"}),(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-[#d4a574] rounded-full animate-pulse"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg md:text-xl font-black text-white transform -rotate-1",style:{textShadow:"2px 2px 0px #333"},children:"AIMAGICA"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 transform rotate-1",children:"Magic Gallery ✨"})]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(n.I,{placeholder:"Search magical creations...",value:K,onChange:e=>q(e.target.value),className:"pl-10 w-64 bg-[#1a1a1a] border-2 border-[#444] text-white placeholder:text-gray-400 rounded-xl font-bold"})]})})]})})}),(0,s.jsxs)("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-8",children:[(0,s.jsx)("div",{className:"mb-8 flex flex-wrap gap-4 items-start",children:(0,s.jsx)(d.mQ,{value:J,onValueChange:Y,className:"flex-1 min-w-[200px]",children:(0,s.jsxs)(d.dr,{className:"bg-[#1a1a1a] border-2 border-[#444] rounded-xl p-1 flex flex-wrap gap-1",children:[(0,s.jsx)(d.SP,{value:"all",className:"rounded-lg font-bold data-[state=active]:bg-[#d4a574] data-[state=active]:text-black text-gray-300 text-xs md:text-sm transform rotate-1 hover:scale-105 transition-all",children:"All Magic"}),(0,s.jsx)(d.SP,{value:"fantasy",className:"rounded-lg font-bold data-[state=active]:bg-[#d4a574] data-[state=active]:text-black text-gray-300 text-xs md:text-sm transform rotate-0.5 hover:scale-105 transition-all",children:"Fantasy \uD83E\uDDD9‍♂️"}),(0,s.jsx)(d.SP,{value:"cyberpunk",className:"rounded-lg font-bold data-[state=active]:bg-[#d4a574] data-[state=active]:text-black text-gray-300 text-xs md:text-sm transform -rotate-0.5 hover:scale-105 transition-all",children:"Cyberpunk \uD83E\uDD16"}),(0,s.jsx)(d.SP,{value:"sci-fi",className:"rounded-lg font-bold data-[state=active]:bg-[#d4a574] data-[state=active]:text-black text-gray-300 text-xs md:text-sm transform -rotate-1 hover:scale-105 transition-all",children:"Sci-Fi \uD83D\uDE80"})]})})}),(0,s.jsxs)(o.E.div,{className:"mb-6 flex items-center justify-between bg-[#1a1a1a] rounded-xl p-4 border-2 border-[#444]",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.Z,{className:"w-5 h-5 text-[#d4a574]"}),(0,s.jsxs)("span",{className:"text-white font-bold",children:[L.length," of ",eu.length," artworks"]})]}),X?(0,s.jsx)(c.C,{variant:"outline",className:"bg-orange-500/20 text-orange-300 border-orange-500",children:"Offline Mode"}):(0,s.jsx)(c.C,{variant:"outline",className:"bg-green-500/20 text-green-300 border-green-500",children:"Database Connected"}),K&&(0,s.jsxs)(c.C,{variant:"outline",className:"bg-[#2a2a2a] text-gray-300",children:['Search: "',K,'"']})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-gray-400 text-sm",children:[(0,s.jsx)(h.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Enhanced gallery"})]})]}),(0,s.jsx)(_,{items:ex,columns:$?2:4,gap:$?12:16,itemMinWidth:$?150:250,renderItem:ej,onLoadMore:eg,hasMore:eh,loading:F,initialRenderCount:12,className:"mb-8"}),0===eu.length&&(0,s.jsxs)(o.E.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFA8"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"No artworks found"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Try adjusting your search or filter criteria"})]})]}),(0,s.jsx)(i.Vq,{open:!!O,onOpenChange:e=>{e||G(null)},children:(0,s.jsxs)(i.cZ,{className:"max-w-4xl w-[95vw] max-h-[90vh] bg-black p-0 rounded-2xl border-4 border-[#333] shadow-2xl overflow-hidden flex flex-col",children:[(0,s.jsx)(i.$N,{style:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:0},children:(null==O?void 0:O.title)||"Image Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 flex-1 min-h-0",children:[(0,s.jsx)("div",{className:"relative bg-black rounded-l-xl md:rounded-r-none overflow-hidden flex-shrink-0 h-64 md:h-auto",children:O&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:O.url,alt:O.title,className:"w-full h-full object-contain",loading:"eager"}),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-4",children:[(0,s.jsx)("h2",{className:"text-lg md:text-xl font-black text-white mb-1 transform -rotate-1",style:{textShadow:"2px 2px 0px #333"},children:O.title}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("img",{src:(0,I.H)(O.authorAvatar),alt:O.author,className:"w-6 h-6 rounded-full border-2 border-[#444]",onError:e=>{e.currentTarget.src=(0,I.lS)(O.author)}}),(0,s.jsxs)("p",{className:"text-[#d4a574] font-bold text-sm",children:["by ",O.author]}),O.isPremium&&(0,s.jsx)(x.Z,{className:"w-4 h-4 text-[#d4a574]"})]})]})]})}),(0,s.jsx)("div",{className:"p-4 md:p-6 overflow-y-auto bg-[#0a0a0a] flex-1 min-h-0",children:O&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.fK,{className:"border-b border-[#333] pb-4 mb-4",children:(0,s.jsx)(i.$N,{className:"text-xl font-black text-white",children:O.title})}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,s.jsxs)(l.z,{size:"sm",onClick:()=>ef(O.id),className:"flex items-center space-x-1 transform rotate-1 ".concat(O.localIsLiked?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-[#1a1a1a] text-white hover:bg-[#2a2a2a]"," font-bold rounded-lg border-2 border-[#444]"),style:{boxShadow:"2px 2px 0 #333"},children:[(0,s.jsx)(f.Z,{className:"w-4 h-4",fill:O.localIsLiked?"currentColor":"none"}),(0,s.jsx)("span",{children:O.localLikes})]}),(0,s.jsxs)("span",{className:"flex items-center text-gray-300 font-bold transform -rotate-1 bg-[#1a1a1a] px-2 py-1 rounded-lg border-2 border-[#444]",style:{boxShadow:"1px 1px 0 #333"},children:[(0,s.jsx)(p.Z,{className:"w-4 h-4 mr-1"}),O.localComments]}),(0,s.jsxs)("span",{className:"flex items-center text-gray-300 font-bold transform rotate-0.5 bg-[#1a1a1a] px-2 py-1 rounded-lg border-2 border-[#444]",style:{boxShadow:"1px 1px 0 #333"},children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 mr-1"}),O.localViews]}),(0,s.jsx)("span",{className:"ml-auto text-gray-400 font-bold text-sm transform -rotate-1",children:O.createdAt})]}),(0,s.jsxs)("div",{className:"mb-6 transform rotate-0.5",children:[(0,s.jsx)("h3",{className:"text-white font-black mb-3 transform -rotate-1",style:{textShadow:"1px 1px 0px #333"},children:"Magic Prompt ✨"}),(0,s.jsx)("div",{className:"p-4 bg-[#1a1a1a] border-2 border-[#444] shadow-md",style:{borderRadius:"16px",clipPath:"polygon(0% 0%, 100% 2%, 99% 98%, 1% 100%)"},children:(0,s.jsxs)("p",{className:"text-gray-200 font-bold text-sm leading-relaxed",children:['"',O.prompt,'"']})})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-white font-black mb-3 transform rotate-0.5",style:{textShadow:"1px 1px 0px #333"},children:"Magic Tags \uD83C\uDFF7️"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(c.C,{className:"bg-[#d4a574] text-black font-black transform rotate-1",style:{boxShadow:"1px 1px 0 #333"},children:O.style}),O.tags.map((e,t)=>(0,s.jsxs)(c.C,{variant:"outline",className:"bg-[#1a1a1a] border-2 border-[#444] text-gray-300 font-bold hover:bg-[#2a2a2a]",style:{transform:"rotate(".concat(t%3-1,"deg)")},children:["#",e]},t))]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,s.jsxs)(l.z,{onClick:ev,disabled:et,className:"bg-[#4a5a4a] hover:bg-[#5a6a5a] text-white font-black rounded-xl flex-1 border-2 border-[#666] transform -rotate-0.5 hover:scale-105 transition-all disabled:opacity-50",style:{boxShadow:"2px 2px 0 #333"},children:["copying"===eo?(0,s.jsx)(w.Z,{className:"w-4 h-4 mr-2 animate-pulse"}):"copied"===eo?(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-2 text-green-400"}):"shared"===eo?(0,s.jsx)(y.Z,{className:"w-4 h-4 mr-2 text-blue-400"}):(0,s.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"copied"===eo?"Copied!":"shared"===eo?"Shared!":et?"Sharing...":"Share"]}),(0,s.jsxs)(l.z,{onClick:ek,disabled:es,className:"bg-[#d4a574] hover:bg-[#c19660] text-black font-black rounded-xl flex-1 transform rotate-0.5 hover:scale-105 transition-all disabled:opacity-50",style:{boxShadow:"2px 2px 0 #333"},children:[(0,s.jsx)(k.Z,{className:"w-4 h-4 mr-2 ".concat(es?"animate-bounce":"")}),es?"Downloading...":"Download"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-white font-black mb-4 transform -rotate-0.5",style:{textShadow:"1px 1px 0px #333"},children:["Magic Comments \uD83D\uDCAC",W&&(0,s.jsx)("span",{className:"text-sm text-gray-400 ml-2",children:"Loading..."})]}),(0,s.jsxs)("div",{className:"mb-6 p-4 bg-[#1a1a1a] border-2 border-[#444] rounded-xl",children:[(0,s.jsx)(m.g,{placeholder:"Share your thoughts about this magical artwork...",value:en,onChange:e=>ei(e.target.value),className:"bg-[#2a2a2a] border border-[#555] text-white placeholder:text-gray-400 resize-none mb-3",rows:3,maxLength:500}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:[en.length,"/500"]}),(0,s.jsxs)(l.z,{onClick:ew,disabled:!en.trim()||ec,size:"sm",className:"bg-[#d4a574] hover:bg-[#c19660] text-black font-bold",children:[ec?(0,s.jsx)(j.Z,{className:"w-4 h-4 mr-2 animate-spin"}):(0,s.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),ec?"Adding...":"Add Comment"]})]})]}),(0,s.jsx)("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:W?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCAC"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Loading comments..."})]}):U.length>0?U.map((e,t)=>(0,s.jsx)("div",{className:"bg-[#1a1a1a] rounded-xl p-4 border-2 border-[#444] shadow-md",style:{transform:"rotate(".concat(t%3-1,"deg)"),boxShadow:"".concat(t%3-1,"px ").concat(t%2+1,"px 0 #333")},children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("img",{src:(0,I.H)(e.authorAvatar),alt:e.author,className:"w-8 h-8 rounded-full border-2 border-[#444]",onError:t=>{t.currentTarget.src=(0,I.lS)(e.author)}}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"flex justify-between items-start",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-white font-black text-sm",children:e.author}),(0,s.jsx)("span",{className:"text-gray-400 font-bold text-xs ml-2",children:new Date(e.createdAt).toLocaleDateString()})]})}),(0,s.jsx)("p",{className:"text-gray-200 font-bold text-sm mt-1",children:e.content}),(0,s.jsx)("div",{className:"flex items-center justify-between mt-2",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(l.z,{size:"sm",variant:"ghost",onClick:()=>ey(e.id),className:"flex items-center space-x-1 p-1 hover:bg-[#2a2a2a] rounded transition-all ".concat(e.isLiked?"text-red-400 hover:text-red-300":"text-gray-400 hover:text-white"),children:[(0,s.jsx)(S.Z,{className:"w-3 h-3 transition-transform hover:scale-110 ".concat(e.isLiked?"fill-current":"")}),(0,s.jsx)("span",{className:"text-xs font-bold",children:e.likes})]}),(0,s.jsx)("span",{className:"text-gray-500 text-xs",children:"•"}),(0,s.jsx)("span",{className:"text-gray-400 font-bold text-xs",children:"Reply"})]})})]})]})},e.id)):(0,s.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No comments yet. Be the first to share your thoughts!"})})]})]})})]})]})})]})}},7053:function(e,t,a){"use strict";a.d(t,{default:function(){return m},d:function(){return d},V:function(){return c}});var s=a(18376),r=a(57894),o=a(98130);function l(e){let{children:t,...a}=e;return(0,s.jsx)(o.f,{...a,children:t})}let n=(0,r.createContext)({data:null,status:"unauthenticated",update:async()=>null});function i(e){let{children:t}=e;return(0,s.jsx)(n.Provider,{value:{data:null,status:"unauthenticated",update:async()=>null},children:t})}function c(){let[e]=r.useState({data:null,status:"unauthenticated",update:async()=>null});try{let e=(0,r.useContext)(n);if(e)return e}catch(e){console.debug("MockSessionContext not available:",e)}return e}async function d(e){window.location.href=(null==e?void 0:e.callbackUrl)||"/"}function m(e){let{children:t}=e;return(0,s.jsx)(i,{children:(0,s.jsx)(l,{attribute:"class",defaultTheme:"dark",enableSystem:!1,disableTransitionOnChange:!0,storageKey:void 0,children:t})})}},46859:function(e,t,a){"use strict";a.d(t,{C:function(){return n}});var s=a(18376);a(57894);var r=a(30330),o=a(58755);let l=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,o.cn)(l({variant:a}),t),...r})}},65354:function(e,t,a){"use strict";a.d(t,{z:function(){return c}});var s=a(18376),r=a(57894),o=a(7116),l=a(30330),n=a(58755);let i=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,asChild:c=!1,...d}=e,m=c?o.g7:"button";return(0,s.jsx)(m,{className:(0,n.cn)(i({variant:r,size:l,className:a})),ref:t,...d})});c.displayName="Button"},95801:function(e,t,a){"use strict";a.d(t,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return l},aY:function(){return d},ll:function(){return i}});var s=a(18376),r=a(57894),o=a(58755);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});l.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",a),...r})});n.displayName="CardHeader";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});i.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},67756:function(e,t,a){"use strict";a.d(t,{$N:function(){return h},Vq:function(){return i},cZ:function(){return u},fK:function(){return g},hg:function(){return c}});var s=a(18376),r=a(57894),o=a(24516),l=a(79914),n=a(58755);let i=o.fC,c=o.xz,d=o.h_;o.x8;let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.aV,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});m.displayName=o.aV.displayName;let u=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(o.VY,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...i,children:[r,(0,s.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground bg-gray-800 hover:bg-gray-700 text-white border border-gray-600 hover:border-gray-500 p-1",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=o.VY.displayName;let g=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};g.displayName="DialogHeader";let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.Dx,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});h.displayName=o.Dx.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.dk,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})}).displayName=o.dk.displayName},31554:function(e,t,a){"use strict";a.d(t,{I:function(){return l}});var s=a(18376),r=a(57894),o=a(58755);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},92392:function(e,t,a){"use strict";a.d(t,{SP:function(){return c},dr:function(){return i},mQ:function(){return n},nU:function(){return d}});var s=a(18376),r=a(57894),o=a(28048),l=a(58755);let n=o.fC,i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});i.displayName=o.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});c.displayName=o.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});d.displayName=o.VY.displayName},53922:function(e,t,a){"use strict";a.d(t,{g:function(){return l}});var s=a(18376),r=a(57894),o=a(58755);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});l.displayName="Textarea"},95046:function(e,t,a){"use strict";var s=a(57894);t.ZP=function(e){return(0,s.useMemo)(()=>{let t=e.startsWith("/")?e:"/".concat(e);return window.location.hostname.includes(".pages.dev")||window.location.hostname,t},[e])}},58755:function(e,t,a){"use strict";a.d(t,{cn:function(){return o}});var s=a(4941),r=a(48244);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}},39352:function(e,t,a){"use strict";function s(e){if(!e)return"/images/aimagica-logo.png";if(e.includes("googleusercontent.com")){let t=encodeURIComponent(e);return"/api/proxy/avatar?url=".concat(t)}return e}function r(e){var t;let a=(null==e?void 0:null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())||"U";return"/placeholder.svg?height=40&width=40&text=".concat(a)}a.d(t,{H:function(){return s},lS:function(){return r}})}},function(e){e.O(0,[7198,2593,8048,6860,71,8922,5996,1744],function(){return e(e.s=96127)}),_N_E=e.O()}]);